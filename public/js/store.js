!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FilePondPluginImagePreview=e()}(this,(function(){"use strict";function t(t){this.wrapped=t}function e(e){var n,r;function i(n,r){try{var a=e[n](r),s=a.value,u=s instanceof t;Promise.resolve(u?s.wrapped:s).then((function(t){u?i("next",t):o(a.done?"return":"normal",t)}),(function(t){i("throw",t)}))}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":n.resolve({value:e,done:!0});break;case"throw":n.reject(e);break;default:n.resolve({value:e,done:!1})}(n=n.next)?i(n.key,n.arg):r=null}this._invoke=function(t,e){return new Promise((function(o,a){var s={key:t,arg:e,resolve:o,reject:a,next:null};r?r=r.next=s:(n=r=s,i(t,e))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)};function n(t,e){return r(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||i()}function r(t){if(Array.isArray(t))return t}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var o=function(t,e){return u(t.x*e,t.y*e)},a=function(t,e){return u(t.x+e.x,t.y+e.y)},s=function(t,e,n){var r=Math.cos(e),i=Math.sin(e),o=u(t.x-n.x,t.y-n.y);return u(n.x+r*o.x-i*o.y,n.y+i*o.x+r*o.y)},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:t,y:e}},l=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0;return"string"==typeof t?parseFloat(t)*n:"number"==typeof t?t*(r?e[r]:Math.min(e.width,e.height)):void 0},c=function(t){return null!=t},f=function(t,e){return Object.keys(e).forEach((function(n){return t.setAttribute(n,e[n])}))},d=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&f(n,e),n},p={contain:"xMidYMid meet",cover:"xMidYMid slice"},h={left:"start",center:"middle",right:"end"},g=function(t){return function(e){return d(t,{id:e.id})}},v={image:function(t){var e=d("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=function(){e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},rect:g("rect"),ellipse:g("ellipse"),text:g("text"),path:g("path"),line:function(t){var e=d("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=d("line");e.appendChild(n);var r=d("path");e.appendChild(r);var i=d("path");return e.appendChild(i),e}},m={rect:function(t){return f(t,Object.assign({},t.rect,t.styles))},ellipse:function(t){var e=t.rect.x+.5*t.rect.width,n=t.rect.y+.5*t.rect.height,r=.5*t.rect.width,i=.5*t.rect.height;return f(t,Object.assign({cx:e,cy:n,rx:r,ry:i},t.styles))},image:function(t,e){f(t,Object.assign({},t.rect,t.styles,{preserveAspectRatio:p[e.fit]||"none"}))},text:function(t,e,n,r){var i=l(e.fontSize,n,r),o=e.fontFamily||"sans-serif",a=e.fontWeight||"normal",s=h[e.textAlign]||"start";f(t,Object.assign({},t.rect,t.styles,{"stroke-width":0,"font-weight":a,"font-size":i,"font-family":o,"text-anchor":s})),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},path:function(t,e,n,r){var i;f(t,Object.assign({},t.styles,{fill:"none",d:(i=e.points.map((function(t){return{x:l(t.x,n,r,"width"),y:l(t.y,n,r,"height")}})),i.map((function(t,e){return"".concat(0===e?"M":"L"," ").concat(t.x," ").concat(t.y)})).join(" "))}))},line:function(t,e,n,r){f(t,Object.assign({},t.rect,t.styles,{fill:"none"}));var i=t.childNodes[0],c=t.childNodes[1],d=t.childNodes[2],p=t.rect,h={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(f(i,{x1:p.x,y1:p.y,x2:h.x,y2:h.y}),e.lineDecoration){c.style.display="none",d.style.display="none";var g=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return 0===e?{x:0,y:0}:u(t.x/e,t.y/e)}({x:h.x-p.x,y:h.y-p.y}),v=l(.05,n,r);if(-1!==e.lineDecoration.indexOf("arrow-begin")){var m=o(g,v),E=a(p,m),_=s(p,2,E),b=s(p,-2,E);f(c,{style:"display:block;",d:"M".concat(_.x,",").concat(_.y," L").concat(p.x,",").concat(p.y," L").concat(b.x,",").concat(b.y)})}if(-1!==e.lineDecoration.indexOf("arrow-end")){var y=o(g,-v),T=a(h,y),I=s(h,2,T),S=s(h,-2,T);f(d,{style:"display:block;",d:"M".concat(I.x,",").concat(I.y," L").concat(h.x,",").concat(h.y," L").concat(S.x,",").concat(S.y)})}}}},E=function(t,e,n,r,i){"path"!==e&&(t.rect=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=l(t.x,e,n,"width")||l(t.left,e,n,"width"),i=l(t.y,e,n,"height")||l(t.top,e,n,"height"),o=l(t.width,e,n,"width"),a=l(t.height,e,n,"height"),s=l(t.right,e,n,"width"),u=l(t.bottom,e,n,"height");return c(i)||(i=c(a)&&c(u)?e.height-a-u:u),c(r)||(r=c(o)&&c(s)?e.width-o-s:s),c(o)||(o=c(r)&&c(s)?e.width-r-s:0),c(a)||(a=c(i)&&c(u)?e.height-i-u:0),{x:r||0,y:i||0,width:o||0,height:a||0}}(n,r,i)),t.styles=function(t,e,n){var r=t.borderStyle||t.lineStyle||"solid",i=t.backgroundColor||t.fontColor||"transparent",o=t.borderColor||t.lineColor||"transparent",a=l(t.borderWidth||t.lineWidth,e,n);return{"stroke-linecap":t.lineCap||"round","stroke-linejoin":t.lineJoin||"round","stroke-width":a||0,"stroke-dasharray":"string"==typeof r?"":r.map((function(t){return l(t,e,n)})).join(","),stroke:o,fill:i,opacity:t.opacity||1}}(n,r,i),m[e](t,n,r,i)},_=["x","y","left","top","right","bottom","width","height"],b=function(t){var e=n(t,2),r=e[0],i=e[1],o=i.points?{}:_.reduce((function(t,e){var n;return t[e]="string"==typeof(n=i[e])&&/%/.test(n)?parseFloat(n)/100:n,t}),{});return[r,Object.assign({zIndex:0},i,o)]},y=function(t,e){return t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0},T=function(t){return t.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:function(t){var e=t.root,r=t.props;if(r.dirty){var i=r.crop,o=r.resize,a=r.markup,s=r.width,u=r.height,l=i.width,c=i.height;if(o){var f=o.size,d=f&&f.width,p=f&&f.height,h=o.mode,g=o.upscale;d&&!p&&(p=d),p&&!d&&(d=p);var m=l<d&&c<p;if(!m||m&&g){var _,T=d/l,I=p/c;if("force"===h)l=d,c=p;else"cover"===h?_=Math.max(T,I):"contain"===h&&(_=Math.min(T,I)),l*=_,c*=_}}var S={width:s,height:u};e.element.setAttribute("width",S.width),e.element.setAttribute("height",S.height);var R=Math.min(s/l,u/c);e.element.innerHTML="";var w=e.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");a.filter(w).map(b).sort(y).forEach((function(t){var r=n(t,2),i=r[0],o=r[1],a=function(t,e){return v[t](e)}(i,o);E(a,i,o,S,R),e.element.appendChild(a)}))}}})},I=function(t,e){return{x:t,y:e}},S=function(t,e){return I(t.x-e.x,t.y-e.y)},R=function(t,e){return Math.sqrt(function(t,e){return function(t,e){return t.x*e.x+t.y*e.y}(S(t,e),S(t,e))}(t,e))},w=function(t,e){var n=t,r=e,i=1.5707963267948966-e,o=Math.sin(1.5707963267948966),a=Math.sin(r),s=Math.sin(i),u=Math.cos(i),l=n/o;return I(u*(l*a),u*(l*s))},O=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t.height/t.width,i=1,o=e,a=1,s=r;s>o&&(a=(s=o)/r);var u=Math.max(i/a,o/s),l=t.width/(n*u*a),c=l*e;return{width:l,height:c}},C=function(t,e,n,r){var i=r.x>.5?1-r.x:r.x,o=r.y>.5?1-r.y:r.y,a=2*i*t.width,s=2*o*t.height,u=function(t,e){var n=t.width,r=t.height,i=w(n,e),o=w(r,e),a=I(t.x+Math.abs(i.x),t.y-Math.abs(i.y)),s=I(t.x+t.width+Math.abs(o.y),t.y+Math.abs(o.x)),u=I(t.x-Math.abs(o.y),t.y+t.height-Math.abs(o.x));return{width:R(a,s),height:R(a,u)}}(e,n);return Math.max(u.width/a,u.height/s)},M=function(t,e){var n=t.width,r=n*e;return r>t.height&&(n=(r=t.height)/e),{x:.5*(t.width-n),y:.5*(t.height-r),width:n,height:r}},D={type:"spring",stiffness:.5,damping:.45,mass:10},x=function(t){return t.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function(t){var e=t.root,n=t.props;n.background&&(e.element.style.backgroundColor=n.background)},create:function(e){var n=e.root,r=e.props;n.ref.image=n.appendChildView(n.createChildView(function(t){return t.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:D,originY:D,scaleX:D,scaleY:D,translateX:D,translateY:D,rotateZ:D}},create:function(e){var n=e.root,r=e.props;r.width=r.image.width,r.height=r.image.height,n.ref.bitmap=n.appendChildView(n.createChildView(function(t){return t.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:function(t){var e=t.root,n=t.props;e.appendChild(n.image)}})}(t),{image:r.image}))},write:function(t){var e=t.root,n=t.props.crop.flip,r=e.ref.bitmap;r.scaleX=n.horizontal?-1:1,r.scaleY=n.vertical?-1:1}})}(t),Object.assign({},r))),n.ref.createMarkup=function(){n.ref.markup||(n.ref.markup=n.appendChildView(n.createChildView(T(t),Object.assign({},r))))},n.ref.destroyMarkup=function(){n.ref.markup&&(n.removeChildView(n.ref.markup),n.ref.markup=null)};var i=n.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");null!==i&&(n.element.dataset.transparencyIndicator="grid"===i?i:"color")},write:function(t){var e=t.root,n=t.props,r=t.shouldOptimize,i=n.crop,o=n.markup,a=n.resize,s=n.dirty,u=n.width,l=n.height;e.ref.image.crop=i;var c={x:0,y:0,width:u,height:l,center:{x:.5*u,y:.5*l}},f={width:e.ref.image.width,height:e.ref.image.height},d={x:i.center.x*f.width,y:i.center.y*f.height},p={x:c.center.x-f.width*i.center.x,y:c.center.y-f.height*i.center.y},h=2*Math.PI+i.rotation%(2*Math.PI),g=i.aspectRatio||f.height/f.width,v=void 0===i.scaleToFit||i.scaleToFit,m=C(f,M(c,g),h,v?i.center:{x:.5,y:.5}),E=i.zoom*m;o&&o.length?(e.ref.createMarkup(),e.ref.markup.width=u,e.ref.markup.height=l,e.ref.markup.resize=a,e.ref.markup.dirty=s,e.ref.markup.markup=o,e.ref.markup.crop=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.zoom,r=e.rotation,i=e.center,o=e.aspectRatio;o||(o=t.height/t.width);var a=O(t,o,n),s={x:.5*a.width,y:.5*a.height},u={x:0,y:0,width:a.width,height:a.height,center:s},l=void 0===e.scaleToFit||e.scaleToFit,c=C(t,M(u,o),r,l?i:{x:.5,y:.5}),f=n*c;return{widthFloat:a.width/f,heightFloat:a.height/f,width:Math.round(a.width/f),height:Math.round(a.height/f)}}(f,i)):e.ref.markup&&e.ref.destroyMarkup();var _=e.ref.image;if(r)return _.originX=null,_.originY=null,_.translateX=null,_.translateY=null,_.rotateZ=null,_.scaleX=null,void(_.scaleY=null);_.originX=d.x,_.originY=d.y,_.translateX=p.x,_.translateY=p.y,_.rotateZ=h,_.scaleX=E,_.scaleY=E}})},A=0,P=function(){self.onmessage=function(t){createImageBitmap(t.data.message.file).then((function(e){self.postMessage({id:t.data.id,message:e},[e])}))}},L=function(){self.onmessage=function(t){for(var e=t.data.message.imageData,n=t.data.message.colorMatrix,r=e.data,i=r.length,o=n[0],a=n[1],s=n[2],u=n[3],l=n[4],c=n[5],f=n[6],d=n[7],p=n[8],h=n[9],g=n[10],v=n[11],m=n[12],E=n[13],_=n[14],b=n[15],y=n[16],T=n[17],I=n[18],S=n[19],R=0,w=0,O=0,C=0,M=0;R<i;R+=4)w=r[R]/255,O=r[R+1]/255,C=r[R+2]/255,M=r[R+3]/255,r[R]=Math.max(0,Math.min(255*(w*o+O*a+C*s+M*u+l),255)),r[R+1]=Math.max(0,Math.min(255*(w*c+O*f+C*d+M*p+h),255)),r[R+2]=Math.max(0,Math.min(255*(w*g+O*v+C*m+M*E+_),255)),r[R+3]=Math.max(0,Math.min(255*(w*b+O*y+C*T+M*I+S),255));self.postMessage({id:t.data.id,message:e},[e.data.buffer])}},N={1:function(){return[1,0,0,1,0,0]},2:function(t){return[-1,0,0,1,t,0]},3:function(t,e){return[-1,0,0,-1,t,e]},4:function(t,e){return[1,0,0,-1,0,e]},5:function(){return[0,1,1,0,0,0]},6:function(t,e){return[0,1,-1,0,e,0]},7:function(t,e){return[0,-1,-1,0,e,t]},8:function(t){return[0,-1,1,0,0,t]}},G=function(t,e,n,r){e=Math.round(e),n=Math.round(n);var i=document.createElement("canvas");i.width=e,i.height=n;var o=i.getContext("2d");if(r>=5&&r<=8){var a=[n,e];e=a[0],n=a[1]}return function(t,e,n,r){-1!==r&&t.transform.apply(t,N[r](e,n))}(o,e,n,r),o.drawImage(t,0,0,e,n),i},k=function(t){return/^image/.test(t.type)&&!/svg/.test(t.type)},B=function(t){var e=Math.min(10/t.width,10/t.height),n=document.createElement("canvas"),r=n.getContext("2d"),i=n.width=Math.ceil(t.width*e),o=n.height=Math.ceil(t.height*e);r.drawImage(t,0,0,i,o);var a=null;try{a=r.getImageData(0,0,i,o).data}catch(t){return null}for(var s=a.length,u=0,l=0,c=0,f=0;f<s;f+=4)u+=a[f]*a[f],l+=a[f+1]*a[f+1],c+=a[f+2]*a[f+2];return{r:u=z(u,s),g:l=z(l,s),b:c=z(c,s)}},z=function(t,e){return Math.floor(Math.sqrt(t/(e/4)))},F=function(t){var e=t.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:function(t){var e=t.root,n=t.props,r='<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">\n    <defs>\n        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">\n            <stop offset=\'50%\' stop-color=\'#000000\'/>\n            <stop offset=\'56%\' stop-color=\'#0a0a0a\'/>\n            <stop offset=\'63%\' stop-color=\'#262626\'/>\n            <stop offset=\'69%\' stop-color=\'#4f4f4f\'/>\n            <stop offset=\'75%\' stop-color=\'#808080\'/>\n            <stop offset=\'81%\' stop-color=\'#b1b1b1\'/>\n            <stop offset=\'88%\' stop-color=\'#dadada\'/>\n            <stop offset=\'94%\' stop-color=\'#f6f6f6\'/>\n            <stop offset=\'100%\' stop-color=\'#ffffff\'/>\n        </radialGradient>\n        <mask id="mask-__UID__">\n            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>\n        </mask>\n    </defs>\n    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>\n</svg>';if(document.querySelector("base")){var i=window.location.href.replace(window.location.hash,"");r=r.replace(/url\(\#/g,"url("+i+"#")}A++,e.element.classList.add("filepond--image-preview-overlay-".concat(n.status)),e.element.innerHTML=r.replace(/__UID__/g,A)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),n=function(t){return t.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:D,scaleY:D,translateY:D,opacity:{type:"tween",duration:400}}},create:function(e){var n=e.root,r=e.props;n.ref.clip=n.appendChildView(n.createChildView(x(t),{id:r.id,image:r.image,crop:r.crop,markup:r.markup,resize:r.resize,dirty:r.dirty,background:r.background}))},write:function(t){var e=t.root,n=t.props,r=t.shouldOptimize,i=e.ref.clip,o=n.image,a=n.crop,s=n.markup,u=n.resize,l=n.dirty;if(i.crop=a,i.markup=s,i.resize=u,i.dirty=l,i.opacity=r?0:1,!r&&!e.rect.element.hidden){var c=o.height/o.width,f=a.aspectRatio||c,d=e.rect.inner.width,p=e.rect.inner.height,h=e.query("GET_IMAGE_PREVIEW_HEIGHT"),g=e.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),v=e.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),m=e.query("GET_PANEL_ASPECT_RATIO"),E=e.query("GET_ALLOW_MULTIPLE");m&&!E&&(h=d*m,f=m);var _=null!==h?h:Math.max(g,Math.min(d*f,v)),b=_/f;b>d&&(_=(b=d)*f),_>p&&(_=p,b=p/f),i.width=b,i.height=_}}})}(t),r=t.utils.createWorker,i=function(t,e,n){return new Promise((function(i){t.ref.imageData||(t.ref.imageData=n.getContext("2d").getImageData(0,0,n.width,n.height));var o=function(t){var e;try{e=new ImageData(t.width,t.height)}catch(n){e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(new Uint8ClampedArray(t.data)),e}(t.ref.imageData);if(!e||20!==e.length)return n.getContext("2d").putImageData(o,0,0),i();var a=r(L);a.post({imageData:o,colorMatrix:e},(function(t){n.getContext("2d").putImageData(t,0,0),a.terminate(),i()}),[o.data.buffer])}))},o=function(t){var e=t.root,r=t.props,i=t.image,o=r.id,a=e.query("GET_ITEM",{id:o});if(a){var s,u,l=a.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},c=e.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),f=!1;e.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(s=a.getMetadata("markup")||[],u=a.getMetadata("resize"),f=!0);var d=e.appendChildView(e.createChildView(n,{id:o,image:i,crop:l,resize:u,markup:s,dirty:f,background:c,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),e.childViews.length);e.ref.images.push(d),d.opacity=1,d.scaleX=1,d.scaleY=1,d.translateY=0,setTimeout((function(){e.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:o})}),250)}},a=function(t){var e=t.root;e.ref.overlayShadow.opacity=1,e.ref.overlayError.opacity=0,e.ref.overlaySuccess.opacity=0},s=function(t){var e=t.root;e.ref.overlayShadow.opacity=.25,e.ref.overlayError.opacity=1};return t.utils.createView({name:"image-preview-wrapper",create:function(t){var n=t.root;n.ref.images=[],n.ref.imageData=null,n.ref.imageViewBin=[],n.ref.overlayShadow=n.appendChildView(n.createChildView(e,{opacity:0,status:"idle"})),n.ref.overlaySuccess=n.appendChildView(n.createChildView(e,{opacity:0,status:"success"})),n.ref.overlayError=n.appendChildView(n.createChildView(e,{opacity:0,status:"failure"}))},styles:["height"],apis:["height"],destroy:function(t){t.root.ref.images.forEach((function(t){t.image.width=1,t.image.height=1}))},didWriteView:function(t){t.root.ref.images.forEach((function(t){t.dirty=!1}))},write:t.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:function(t){var e=t.root,n=e.ref.images[e.ref.images.length-1];n.translateY=0,n.scaleX=1,n.scaleY=1,n.opacity=1},DID_IMAGE_PREVIEW_CONTAINER_CREATE:function(t){var e=t.root,n=t.props.id,r=e.query("GET_ITEM",n);if(r){var i,o,a,s=URL.createObjectURL(r.file);i=s,o=function(t,r){e.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:n,width:t,height:r})},(a=new Image).onload=function(){var t=a.naturalWidth,e=a.naturalHeight;a=null,o(t,e)},a.src=i}},DID_FINISH_CALCULATE_PREVIEWSIZE:function(t){var e=t.root,n=t.props,a=n.id,s=e.query("GET_ITEM",a);if(s){var u,l,c=URL.createObjectURL(s.file),f=function(){var t;(t=c,new Promise((function(e,n){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){e(r)},r.onerror=function(t){n(t)},r.src=t}))).then(d)},d=function(t){URL.revokeObjectURL(c);var r=(s.getMetadata("exif")||{}).orientation||-1,a=t.width,u=t.height;if(a&&u){if(r>=5&&r<=8){var l=[u,a];a=l[0],u=l[1]}var f=Math.max(1,.75*window.devicePixelRatio),d=e.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*f,p=u/a,h=e.rect.element.width,g=e.rect.element.height,v=h,m=v*p;p>1?m=(v=Math.min(a,h*d))*p:v=(m=Math.min(u,g*d))/p;var E=G(t,v,m,r),_=function(){var r=e.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?B(data):null;s.setMetadata("color",r,!0),"close"in t&&t.close(),e.ref.overlayShadow.opacity=1,o({root:e,props:n,image:E})},b=s.getMetadata("filter");b?i(e,b,E).then(_):_()}};if(u=s.file,((l=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./))?parseInt(l[1]):null)<=58||!("createImageBitmap"in window)||!k(u))f();else{var p=r(P);p.post({file:s.file},(function(t){p.terminate(),t?d(t):f()}))}}},DID_UPDATE_ITEM_METADATA:function(t){var e=t.root,n=t.props,r=t.action;if(/crop|filter|markup|resize/.test(r.change.key)&&e.ref.images.length){var a=e.query("GET_ITEM",{id:n.id});if(a)if(/filter/.test(r.change.key)){var s=e.ref.images[e.ref.images.length-1];i(e,r.change.value,s.image)}else{if(/crop|markup|resize/.test(r.change.key)){var u=a.getMetadata("crop"),l=e.ref.images[e.ref.images.length-1];if(u&&u.aspectRatio&&l.crop&&l.crop.aspectRatio&&Math.abs(u.aspectRatio-l.crop.aspectRatio)>1e-5){var c=function(t){var e=t.root,n=e.ref.images.shift();return n.opacity=0,n.translateY=-15,e.ref.imageViewBin.push(n),n}({root:e});o({root:e,props:n,image:(f=c.image,(d=d||document.createElement("canvas")).width=f.width,d.height=f.height,d.getContext("2d").drawImage(f,0,0),d)})}else!function(t){var e=t.root,n=t.props,r=e.query("GET_ITEM",{id:n.id});if(r){var i=e.ref.images[e.ref.images.length-1];i.crop=r.getMetadata("crop"),i.background=e.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),e.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(i.dirty=!0,i.resize=r.getMetadata("resize"),i.markup=r.getMetadata("markup"))}}({root:e,props:n})}var f,d}}},DID_THROW_ITEM_LOAD_ERROR:s,DID_THROW_ITEM_PROCESSING_ERROR:s,DID_THROW_ITEM_INVALID:s,DID_COMPLETE_ITEM_PROCESSING:function(t){var e=t.root;e.ref.overlayShadow.opacity=.25,e.ref.overlaySuccess.opacity=1},DID_START_ITEM_PROCESSING:a,DID_REVERT_ITEM_PROCESSING:a},(function(t){var e=t.root,n=e.ref.imageViewBin.filter((function(t){return 0===t.opacity}));e.ref.imageViewBin=e.ref.imageViewBin.filter((function(t){return t.opacity>0})),n.forEach((function(t){return function(t,e){t.removeChildView(e),e.image.width=1,e.image.height=1,e._destroy()}(e,t)})),n.length=0}))})},U=function(t){var e=t.addFilter,n=t.utils,r=n.Type,i=n.createRoute,o=n.isFile,a=F(t);return e("CREATE_VIEW",(function(t){var e=t.is,n=t.view,r=t.query;if(e("file")&&r("GET_ALLOW_IMAGE_PREVIEW")){var s=function(t){t.root.ref.shouldRescale=!0};n.registerWriter(i({DID_RESIZE_ROOT:s,DID_STOP_RESIZE:s,DID_LOAD_ITEM:function(t){var e=t.root,i=t.props.id,s=r("GET_ITEM",i);if(s&&o(s.file)&&!s.archived){var u=s.file;if(function(t){return/^image/.test(t.type)}(u)&&r("GET_IMAGE_PREVIEW_FILTER_ITEM")(s)){var l="createImageBitmap"in(window||{}),c=r("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!(!l&&c&&u.size>c)){e.ref.imagePreview=n.appendChildView(n.createChildView(a,{id:i}));var f=e.query("GET_IMAGE_PREVIEW_HEIGHT");f&&e.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:s.id,height:f});var d=!l&&u.size>r("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");e.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:i},d)}}}},DID_IMAGE_PREVIEW_CALCULATE_SIZE:function(t){var e=t.root,n=t.action;e.ref.imageWidth=n.width,e.ref.imageHeight=n.height,e.ref.shouldRescale=!0,e.ref.shouldDrawPreview=!0,e.dispatch("KICK")},DID_UPDATE_ITEM_METADATA:function(t){var e=t.root;"crop"===t.action.change.key&&(e.ref.shouldRescale=!0)}},(function(t){var e=t.root,n=t.props;e.ref.imagePreview&&(e.rect.element.hidden||(e.ref.shouldRescale&&(!function(t,e){if(t.ref.imagePreview){var n=e.id,r=t.query("GET_ITEM",{id:n});if(r){var i=t.query("GET_PANEL_ASPECT_RATIO"),o=t.query("GET_ITEM_PANEL_ASPECT_RATIO"),a=t.query("GET_IMAGE_PREVIEW_HEIGHT");if(!(i||o||a)){var s=t.ref,u=s.imageWidth,l=s.imageHeight;if(u&&l){var c=t.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),f=t.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),d=(r.getMetadata("exif")||{}).orientation||-1;if(d>=5&&d<=8){var p=[l,u];u=p[0],l=p[1]}if(!k(r.file)||t.query("GET_IMAGE_PREVIEW_UPSCALE")){var h=2048/u;u*=h,l*=h}var g=l/u,v=(r.getMetadata("crop")||{}).aspectRatio||g,m=Math.max(c,Math.min(l,f)),E=t.rect.element.width,_=Math.min(E*v,m);t.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:r.id,height:_})}}}}}(e,n),e.ref.shouldRescale=!1),e.ref.shouldDrawPreview&&(requestAnimationFrame((function(){requestAnimationFrame((function(){e.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:n.id})}))})),e.ref.shouldDrawPreview=!1)))})))}})),{options:{allowImagePreview:[!0,r.BOOLEAN],imagePreviewFilterItem:[function(){return!0},r.FUNCTION],imagePreviewHeight:[null,r.INT],imagePreviewMinHeight:[44,r.INT],imagePreviewMaxHeight:[256,r.INT],imagePreviewMaxFileSize:[null,r.INT],imagePreviewZoomFactor:[2,r.INT],imagePreviewUpscale:[!1,r.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,r.INT],imagePreviewTransparencyIndicator:[null,r.STRING],imagePreviewCalculateAverageImageColor:[!1,r.BOOLEAN],imagePreviewMarkupShow:[!0,r.BOOLEAN],imagePreviewMarkupFilter:[function(){return!0},r.FUNCTION]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:U})),U})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FilePondPluginImageResize=e()}(this,(function(){"use strict";var t=function(t){var e=t.addFilter,n=t.utils.Type;return e("DID_LOAD_ITEM",(function(t,e){var n=e.query;return new Promise((function(e,r){var i=t.file;if(!function(t){return/^image/.test(t.type)}(i)||!n("GET_ALLOW_IMAGE_RESIZE"))return e(t);var o=n("GET_IMAGE_RESIZE_MODE"),a=n("GET_IMAGE_RESIZE_TARGET_WIDTH"),s=n("GET_IMAGE_RESIZE_TARGET_HEIGHT"),u=n("GET_IMAGE_RESIZE_UPSCALE");if(null===a&&null===s)return e(t);var l,c,f,d=null===a?s:a,p=null===s?d:s,h=URL.createObjectURL(i);l=h,c=function(n){if(URL.revokeObjectURL(h),!n)return e(t);var r=n.width,i=n.height,a=(t.getMetadata("exif")||{}).orientation||-1;if(a>=5&&a<=8){var s=[i,r];r=s[0],i=s[1]}if(r===d&&i===p)return e(t);if(!u)if("cover"===o){if(r<=d||i<=p)return e(t)}else if(r<=d&&i<=d)return e(t);t.setMetadata("resize",{mode:o,upscale:u,size:{width:d,height:p}}),e(t)},(f=new Image).onload=function(){var t=f.naturalWidth,e=f.naturalHeight;f=null,c({width:t,height:e})},f.onerror=function(){return c(null)},f.src=l}))})),{options:{allowImageResize:[!0,n.BOOLEAN],imageResizeMode:["cover",n.STRING],imageResizeUpscale:[!0,n.BOOLEAN],imageResizeTargetWidth:[null,n.INT],imageResizeTargetHeight:[null,n.INT]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FilePondPluginImageTransform=e()}(this,(function(){"use strict";var t={jpeg:"jpg","svg+xml":"svg"},e=function(t){return/^image/.test(t.type)},n={1:function(){return[1,0,0,1,0,0]},2:function(t){return[-1,0,0,1,t,0]},3:function(t,e){return[-1,0,0,-1,t,e]},4:function(t,e){return[1,0,0,-1,0,e]},5:function(){return[0,1,1,0,0,0]},6:function(t,e){return[0,1,-1,0,e,0]},7:function(t,e){return[0,-1,-1,0,e,t]},8:function(t){return[0,-1,1,0,0,t]}},r=function(t,e){return{x:t,y:e}},i=function(t,e){return r(t.x-e.x,t.y-e.y)},o=function(t,e){return Math.sqrt(function(t,e){return function(t,e){return t.x*e.x+t.y*e.y}(i(t,e),i(t,e))}(t,e))},a=function(t,e){var n=t,i=e,o=1.5707963267948966-e,a=Math.sin(1.5707963267948966),s=Math.sin(i),u=Math.sin(o),l=Math.cos(o),c=n/a;return r(l*(c*s),l*(c*u))},s=function(t,e){var n=t.width,i=t.height,s=a(n,e),u=a(i,e),l=r(t.x+Math.abs(s.x),t.y-Math.abs(s.y)),c=r(t.x+t.width+Math.abs(u.y),t.y+Math.abs(u.x)),f=r(t.x-Math.abs(u.y),t.y+t.height-Math.abs(u.x));return{width:o(l,c),height:o(l,f)}},u=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:.5,y:.5},i=r.x>.5?1-r.x:r.x,o=r.y>.5?1-r.y:r.y,a=2*i*t.width,u=2*o*t.height,l=s(e,n);return Math.max(l.width/a,l.height/u)},l=function(t,e){var n=t.width,r=n*e;return r>t.height&&(n=(r=t.height)/e),{x:.5*(t.width-n),y:.5*(t.height-r),width:n,height:r}},c=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t.height/t.width,i=1,o=e,a=1,s=r;s>o&&(a=(s=o)/r);var u=Math.max(i/a,o/s),l=t.width/(n*u*a),c=l*e;return{width:l,height:c}},f=function(t){t.width=1,t.height=1,t.getContext("2d").clearRect(0,0,1,1)},d=function(t){return t&&(t.horizontal||t.vertical)},p=function(t,e,r){if(e<=1&&!d(r))return t.width=t.naturalWidth,t.height=t.naturalHeight,t;var i=document.createElement("canvas"),o=t.naturalWidth,a=t.naturalHeight,s=e>=5&&e<=8;s?(i.width=a,i.height=o):(i.width=o,i.height=a);var u=i.getContext("2d");if(e&&u.transform.apply(u,function(t,e,r){return-1===r&&(r=1),n[r](t,e)}(o,a,e)),d(r)){var l=[1,0,0,1,0,0];(!s&&r.horizontal||s&r.vertical)&&(l[0]=-1,l[4]=o),(!s&&r.vertical||s&&r.horizontal)&&(l[3]=-1,l[5]=a),u.transform.apply(u,l)}return u.drawImage(t,0,0,o,a),i},h=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.canvasMemoryLimit,o=r.background,a=void 0===o?null:o,s=n.zoom||1,d=p(t,e,n.flip),h={width:d.width,height:d.height},g=n.aspectRatio||h.height/h.width,v=c(h,g,s);if(i){var m=v.width*v.height;if(m>i){var E=Math.sqrt(i)/Math.sqrt(m);h.width=Math.floor(h.width*E),h.height=Math.floor(h.height*E),v=c(h,g,s)}}var _=document.createElement("canvas"),b={x:.5*v.width,y:.5*v.height},y={x:0,y:0,width:v.width,height:v.height,center:b},T=void 0===n.scaleToFit||n.scaleToFit,I=s*u(h,l(y,g),n.rotation,T?n.center:{x:.5,y:.5});_.width=Math.round(v.width/I),_.height=Math.round(v.height/I),b.x/=I,b.y/=I;var S={x:b.x-h.width*(n.center?n.center.x:.5),y:b.y-h.height*(n.center?n.center.y:.5)},R=_.getContext("2d");a&&(R.fillStyle=a,R.fillRect(0,0,_.width,_.height)),R.translate(b.x,b.y),R.rotate(n.rotation||0),R.drawImage(d,S.x-b.x,S.y-b.y,h.width,h.height);var w=R.getImageData(0,0,_.width,_.height);return f(_),w};"undefined"!=typeof window&&void 0!==window.document&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){var r=this.toDataURL(e,n).split(",")[1];setTimeout((function(){for(var n=atob(r),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);t(new Blob([o],{type:e||"image/png"}))}))}}));var g=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(r){var i=n?n(t):t;Promise.resolve(i).then((function(t){t.toBlob(r,e.type,e.quality)}))}))},v=function(t,e){return b(t.x*e,t.y*e)},m=function(t,e){return b(t.x+e.x,t.y+e.y)},E=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return 0===e?{x:0,y:0}:b(t.x/e,t.y/e)},_=function(t,e,n){var r=Math.cos(e),i=Math.sin(e),o=b(t.x-n.x,t.y-n.y);return b(n.x+r*o.x-i*o.y,n.y+i*o.x+r*o.y)},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:t,y:e}},y=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0;return"string"==typeof t?parseFloat(t)*n:"number"==typeof t?t*(r?e[r]:Math.min(e.width,e.height)):void 0},T=function(t,e,n){var r=t.borderStyle||t.lineStyle||"solid",i=t.backgroundColor||t.fontColor||"transparent",o=t.borderColor||t.lineColor||"transparent",a=y(t.borderWidth||t.lineWidth,e,n);return{"stroke-linecap":t.lineCap||"round","stroke-linejoin":t.lineJoin||"round","stroke-width":a||0,"stroke-dasharray":"string"==typeof r?"":r.map((function(t){return y(t,e,n)})).join(","),stroke:o,fill:i,opacity:t.opacity||1}},I=function(t){return null!=t},S=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=y(t.x,e,n,"width")||y(t.left,e,n,"width"),i=y(t.y,e,n,"height")||y(t.top,e,n,"height"),o=y(t.width,e,n,"width"),a=y(t.height,e,n,"height"),s=y(t.right,e,n,"width"),u=y(t.bottom,e,n,"height");return I(i)||(i=I(a)&&I(u)?e.height-a-u:u),I(r)||(r=I(o)&&I(s)?e.width-o-s:s),I(o)||(o=I(r)&&I(s)?e.width-r-s:0),I(a)||(a=I(i)&&I(u)?e.height-i-u:0),{x:r||0,y:i||0,width:o||0,height:a||0}},R=function(t,e){return Object.keys(e).forEach((function(n){return t.setAttribute(n,e[n])}))},w=function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&R(n,e),n},O={contain:"xMidYMid meet",cover:"xMidYMid slice"},C={left:"start",center:"middle",right:"end"},M=function(t){return function(e){return w(t,{id:e.id})}},D={image:function(t){var e=w("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=function(){e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},rect:M("rect"),ellipse:M("ellipse"),text:M("text"),path:M("path"),line:function(t){var e=w("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=w("line");e.appendChild(n);var r=w("path");e.appendChild(r);var i=w("path");return e.appendChild(i),e}},x={rect:function(t){return R(t,Object.assign({},t.rect,t.styles))},ellipse:function(t){var e=t.rect.x+.5*t.rect.width,n=t.rect.y+.5*t.rect.height,r=.5*t.rect.width,i=.5*t.rect.height;return R(t,Object.assign({cx:e,cy:n,rx:r,ry:i},t.styles))},image:function(t,e){R(t,Object.assign({},t.rect,t.styles,{preserveAspectRatio:O[e.fit]||"none"}))},text:function(t,e,n,r){var i=y(e.fontSize,n,r),o=e.fontFamily||"sans-serif",a=e.fontWeight||"normal",s=C[e.textAlign]||"start";R(t,Object.assign({},t.rect,t.styles,{"stroke-width":0,"font-weight":a,"font-size":i,"font-family":o,"text-anchor":s})),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},path:function(t,e,n,r){var i;R(t,Object.assign({},t.styles,{fill:"none",d:(i=e.points.map((function(t){return{x:y(t.x,n,r,"width"),y:y(t.y,n,r,"height")}})),i.map((function(t,e){return"".concat(0===e?"M":"L"," ").concat(t.x," ").concat(t.y)})).join(" "))}))},line:function(t,e,n,r){R(t,Object.assign({},t.rect,t.styles,{fill:"none"}));var i=t.childNodes[0],o=t.childNodes[1],a=t.childNodes[2],s=t.rect,u={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(R(i,{x1:s.x,y1:s.y,x2:u.x,y2:u.y}),e.lineDecoration){o.style.display="none",a.style.display="none";var l=E({x:u.x-s.x,y:u.y-s.y}),c=y(.05,n,r);if(-1!==e.lineDecoration.indexOf("arrow-begin")){var f=v(l,c),d=m(s,f),p=_(s,2,d),h=_(s,-2,d);R(o,{style:"display:block;",d:"M".concat(p.x,",").concat(p.y," L").concat(s.x,",").concat(s.y," L").concat(h.x,",").concat(h.y)})}if(-1!==e.lineDecoration.indexOf("arrow-end")){var g=v(l,-c),b=m(u,g),T=_(u,2,b),I=_(u,-2,b);R(a,{style:"display:block;",d:"M".concat(T.x,",").concat(T.y," L").concat(u.x,",").concat(u.y," L").concat(I.x,",").concat(I.y)})}}}},A=function(t,e){return D[t](e)},P=function(t,e,n,r,i){"path"!==e&&(t.rect=S(n,r,i)),t.styles=T(n,r,i),x[e](t,n,r,i)},L=function(t,e){return t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0},N=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(i){var o=r.background,a=void 0===o?null:o,s=new FileReader;s.onloadend=function(){var t=s.result,r=document.createElement("div");r.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;",r.innerHTML=t;var o=r.querySelector("svg");document.body.appendChild(r);var c=o.getBBox();r.parentNode.removeChild(r);var f=r.querySelector("title"),d=o.getAttribute("viewBox")||"",p=o.getAttribute("width")||"",h=o.getAttribute("height")||"",g=parseFloat(p)||null,v=parseFloat(h)||null,m=(p.match(/[a-z]+/)||[])[0]||"",E=(h.match(/[a-z]+/)||[])[0]||"",_=d.split(" ").map(parseFloat),b=_.length?{x:_[0],y:_[1],width:_[2],height:_[3]}:c,y=null!=g?g:b.width,T=null!=v?v:b.height;o.style.overflow="visible",o.setAttribute("width",y),o.setAttribute("height",T);var I="";if(n&&n.length){var S={width:y,height:T};I=n.sort(L).reduce((function(t,e){var n=A(e[0],e[1]);return P(n,e[0],e[1],S),n.removeAttribute("id"),1===n.getAttribute("opacity")&&n.removeAttribute("opacity"),t+"\n"+n.outerHTML+"\n"}),""),I="\n\n<g>".concat(I.replace(/&nbsp;/g," "),"</g>\n\n")}var R=e.aspectRatio||T/y,w=y,O=w*R,C=void 0===e.scaleToFit||e.scaleToFit,M=e.center?e.center.x:.5,D=e.center?e.center.y:.5,x=u({width:y,height:T},l({width:w,height:O},R),e.rotation,C?{x:M,y:D}:{x:.5,y:.5}),N=e.zoom*x,G=e.rotation*(180/Math.PI),k={x:.5*w,y:.5*O},B={x:k.x-y*M,y:k.y-T*D},z=["rotate(".concat(G," ").concat(k.x," ").concat(k.y,")"),"translate(".concat(k.x," ").concat(k.y,")"),"scale(".concat(N,")"),"translate(".concat(-k.x," ").concat(-k.y,")"),"translate(".concat(B.x," ").concat(B.y,")")],F=e.flip&&e.flip.horizontal,U=e.flip&&e.flip.vertical,q=["scale(".concat(F?-1:1," ").concat(U?-1:1,")"),"translate(".concat(F?-y:0," ").concat(U?-T:0,")")],V='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'.concat(w).concat(m,'" height="').concat(O).concat(E,'" \nviewBox="0 0 ').concat(w," ").concat(O,'" ').concat(a?'style="background:'+a+'" ':"",'\npreserveAspectRatio="xMinYMin"\nxmlns:xlink="http://www.w3.org/1999/xlink"\nxmlns="http://www.w3.org/2000/svg">\n\x3c!-- Generated by PQINA - https://pqina.nl/ --\x3e\n<title>').concat(f?f.textContent:"",'</title>\n<g transform="').concat(z.join(" "),'">\n<g transform="').concat(q.join(" "),'">\n').concat(o.outerHTML).concat(I,"\n</g>\n</g>\n</svg>");i(V)},s.readAsText(t)}))},G=function(t){var e;try{e=new ImageData(t.width,t.height)}catch(n){e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},k=function(){var t={resize:function(t,e){var r=e.mode,a=void 0===r?"contain":r,s=e.upscale,u=void 0!==s&&s,l=e.width,c=e.height,f=e.matrix;if(f=!f||i(f)?null:f,!l&&!c)return o(t,f);null===l?l=c:null===c&&(c=l);if("force"!==a){var d=l/t.width,p=c/t.height,h=1;if("cover"===a?h=Math.max(d,p):"contain"===a&&(h=Math.min(d,p)),h>1&&!1===u)return o(t,f);l=t.width*h,c=t.height*h}for(var g=t.width,v=t.height,m=Math.round(l),E=Math.round(c),_=t.data,b=new Uint8ClampedArray(m*E*4),y=g/m,T=v/E,I=Math.ceil(.5*y),S=Math.ceil(.5*T),R=0;R<E;R++)for(var w=0;w<m;w++){for(var O=4*(w+R*m),C=0,M=0,D=0,x=0,A=0,P=0,L=0,N=(R+.5)*T,G=Math.floor(R*T);G<(R+1)*T;G++)for(var k=Math.abs(N-(G+.5))/S,B=(w+.5)*y,z=k*k,F=Math.floor(w*y);F<(w+1)*y;F++){var U=Math.abs(B-(F+.5))/I,q=Math.sqrt(z+U*U);if(q>=-1&&q<=1&&(C=2*q*q*q-3*q*q+1)>0){var V=_[(U=4*(F+G*g))+3];L+=C*V,D+=C,V<255&&(C=C*V/250),x+=C*_[U],A+=C*_[U+1],P+=C*_[U+2],M+=C}}b[O]=x/M,b[O+1]=A/M,b[O+2]=P/M,b[O+3]=L/D,f&&n(O,b,f)}return{data:b,width:m,height:E}},filter:o},e=function(e,n){var r=e.transforms,i=null;if(r.forEach((function(t){"filter"===t.type&&(i=t)})),i){var o=null;r.forEach((function(t){"resize"===t.type&&(o=t)})),o&&(o.data.matrix=i.data,r=r.filter((function(t){return"filter"!==t.type})))}n(function(e,n){return e.forEach((function(e){n=t[e.type](n,e.data)})),n}(r,e.imageData))};self.onmessage=function(t){e(t.data.message,(function(e){self.postMessage({id:t.data.id,message:e},[e.data.buffer])}))};function n(t,e,n){var r=e[t]/255,i=e[t+1]/255,o=e[t+2]/255,a=e[t+3]/255,s=r*n[0]+i*n[1]+o*n[2]+a*n[3]+n[4],u=r*n[5]+i*n[6]+o*n[7]+a*n[8]+n[9],l=r*n[10]+i*n[11]+o*n[12]+a*n[13]+n[14],c=r*n[15]+i*n[16]+o*n[17]+a*n[18]+n[19],f=Math.max(0,s*c)+1*(1-c),d=Math.max(0,u*c)+1*(1-c),p=Math.max(0,l*c)+1*(1-c);e[t]=255*Math.max(0,Math.min(1,f)),e[t+1]=255*Math.max(0,Math.min(1,d)),e[t+2]=255*Math.max(0,Math.min(1,p))}var r=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function i(t){return self.JSON.stringify(t||[])===r}function o(t,e){if(!e||i(e))return t;for(var n=t.data,r=n.length,o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],f=e[6],d=e[7],p=e[8],h=e[9],g=e[10],v=e[11],m=e[12],E=e[13],_=e[14],b=e[15],y=e[16],T=e[17],I=e[18],S=e[19],R=0,w=0,O=0,C=0,M=0,D=0,x=0,A=0,P=0,L=0,N=0,G=0;R<r;R+=4)D=(w=n[R]/255)*o+(O=n[R+1]/255)*a+(C=n[R+2]/255)*s+(M=n[R+3]/255)*u+l,x=w*c+O*f+C*d+M*p+h,A=w*g+O*v+C*m+M*E+_,P=w*b+O*y+C*T+M*I+S,L=Math.max(0,D*P)+1*(1-P),N=Math.max(0,x*P)+1*(1-P),G=Math.max(0,A*P)+1*(1-P),n[R]=255*Math.max(0,Math.min(1,L)),n[R+1]=255*Math.max(0,Math.min(1,N)),n[R+2]=255*Math.max(0,Math.min(1,G));return t}},B=function(t,e){if(1165519206===t.getUint32(e+4,!1)){e+=4;var n=18761===t.getUint16(e+=6,!1);e+=t.getUint32(e+4,n);var r=t.getUint16(e,n);e+=2;for(var i=0;i<r;i++)if(274===t.getUint16(e+12*i,n))return t.setUint16(e+12*i+8,1,n),!0;return!1}},z=function(t){return new Promise((function(e){var n=new FileReader;n.onload=function(){return e(function(t){var e=new DataView(t);if(65496!==e.getUint16(0))return null;for(var n,r,i=2,o=!1;i<e.byteLength&&(n=e.getUint16(i,!1),r=e.getUint16(i+2,!1)+2,n>=65504&&n<=65519||65534===n)&&(o||(o=B(e,i)),!(i+r>e.byteLength));)i+=r;return t.slice(0,i)}(n.result)||null)},n.readAsArrayBuffer(t.slice(0,262144))}))},F=function(t,e){var n=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(n){var r=new n;return r.append(t),r.getBlob(e)}return new Blob([t],{type:e})},U=function(t){var e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(e),r=new Worker(n),i=[];return{transfer:function(){},post:function(t,e,n){var o=Math.random().toString(36).substr(2,9);i[o]=e,r.onmessage=function(t){var e=i[t.data.id];e&&(e(t.data.message),delete i[t.data.id])},r.postMessage({id:o,message:t},n)},terminate:function(){r.terminate(),URL.revokeObjectURL(n)}}},q=function(t){return new Promise((function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=function(t){n(t)},r.src=t}))},V=function(t,e){return new Promise((function(n){var r,i={width:t.width,height:t.height},o=t.getContext("2d"),a=e.sort(L).map((function(t){return function(){return new Promise((function(e){W[t[0]](o,i,t[1],e)&&e()}))}}));(r=a,r.reduce((function(t,e){return t.then((function(t){return e().then(Array.prototype.concat.bind(t))}))}),Promise.resolve([]))).then((function(){return n(t)}))}))},Y=function(t,e){t.beginPath(),t.lineCap=e["stroke-linecap"],t.lineJoin=e["stroke-linejoin"],t.lineWidth=e["stroke-width"],e["stroke-dasharray"].length&&t.setLineDash(e["stroke-dasharray"].split(",")),t.fillStyle=e.fill,t.strokeStyle=e.stroke,t.globalAlpha=e.opacity||1},j=function(t){t.fill(),t.stroke(),t.globalAlpha=1},W={rect:function(t,e,n){var r=S(n,e),i=T(n,e);return Y(t,i),t.rect(r.x,r.y,r.width,r.height),j(t),!0},ellipse:function(t,e,n){var r=S(n,e),i=T(n,e);Y(t,i);var o=r.x,a=r.y,s=r.width,u=r.height,l=.5522848,c=s/2*l,f=u/2*l,d=o+s,p=a+u,h=o+s/2,g=a+u/2;return t.moveTo(o,g),t.bezierCurveTo(o,g-f,h-c,a,h,a),t.bezierCurveTo(h+c,a,d,g-f,d,g),t.bezierCurveTo(d,g+f,h+c,p,h,p),t.bezierCurveTo(h-c,p,o,g+f,o,g),j(t),!0},image:function(t,e,n,r){var i=S(n,e),o=T(n,e);Y(t,o);var a=new Image;new URL(n.src,window.location.href).origin!==window.location.origin&&(a.crossOrigin=""),a.onload=function(){if("cover"===n.fit){var e=i.width/i.height,o=e>1?a.width:a.height*e,s=e>1?a.width/e:a.height,u=.5*a.width-.5*o,l=.5*a.height-.5*s;t.drawImage(a,u,l,o,s,i.x,i.y,i.width,i.height)}else if("contain"===n.fit){var c=Math.min(i.width/a.width,i.height/a.height),f=c*a.width,d=c*a.height,p=i.x+.5*i.width-.5*f,h=i.y+.5*i.height-.5*d;t.drawImage(a,0,0,a.width,a.height,p,h,f,d)}else t.drawImage(a,0,0,a.width,a.height,i.x,i.y,i.width,i.height);j(t),r()},a.src=n.src},text:function(t,e,n){var r=S(n,e),i=T(n,e);Y(t,i);var o=y(n.fontSize,e),a=n.fontFamily||"sans-serif",s=n.fontWeight||"normal",u=n.textAlign||"left";return t.font="".concat(s," ").concat(o,"px ").concat(a),t.textAlign=u,t.fillText(n.text,r.x,r.y),j(t),!0},line:function(t,e,n){var r=S(n,e),i=T(n,e);Y(t,i),t.beginPath();var o={x:r.x,y:r.y},a={x:r.x+r.width,y:r.y+r.height};t.moveTo(o.x,o.y),t.lineTo(a.x,a.y);var s=E({x:a.x-o.x,y:a.y-o.y}),u=.04*Math.min(e.width,e.height);if(-1!==n.lineDecoration.indexOf("arrow-begin")){var l=v(s,u),c=m(o,l),f=_(o,2,c),d=_(o,-2,c);t.moveTo(f.x,f.y),t.lineTo(o.x,o.y),t.lineTo(d.x,d.y)}if(-1!==n.lineDecoration.indexOf("arrow-end")){var p=v(s,-u),h=m(a,p),g=_(a,2,h),b=_(a,-2,h);t.moveTo(g.x,g.y),t.lineTo(a.x,a.y),t.lineTo(b.x,b.y)}return j(t),!0},path:function(t,e,n){var r=T(n,e);Y(t,r),t.beginPath();var i=n.points.map((function(t){return{x:y(t.x,e,1,"width"),y:y(t.y,e,1,"height")}}));t.moveTo(i[0].x,i[0].y);for(var o=i.length,a=1;a<o;a++)t.lineTo(i[a].x,i[a].y);return j(t),!0}},X=function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e};function H(t){this.wrapped=t}function $(t){var e,n;function r(e,n){try{var o=t[e](n),a=o.value,s=a instanceof H;Promise.resolve(s?a.wrapped:a).then((function(t){s?r("next",t):i(o.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,i){return new Promise((function(o,a){var s={key:t,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(e=n=s,r(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&($.prototype[Symbol.asyncIterator]=function(){return this}),$.prototype.next=function(t){return this._invoke("next",t)},$.prototype.throw=function(t){return this._invoke("throw",t)},$.prototype.return=function(t){return this._invoke("return",t)};function Z(t,e){return Q(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||K()}function Q(t){if(Array.isArray(t))return t}function K(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var J=["x","y","left","top","right","bottom","width","height"],tt=function(t){var e=Z(t,2),n=e[0],r=e[1],i=r.points?{}:J.reduce((function(t,e){var n;return t[e]="string"==typeof(n=r[e])&&/%/.test(n)?parseFloat(n)/100:n,t}),{});return[n,Object.assign({zIndex:0},r,i)]};"undefined"!=typeof window&&void 0!==window.document&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){var r=this;setTimeout((function(){for(var i=r.toDataURL(e,n).split(",")[1],o=atob(i),a=o.length,s=new Uint8Array(a);a--;)s[a]=o.charCodeAt(a);t(new Blob([s],{type:e||"image/png"}))}))}}));var et="undefined"!=typeof window&&void 0!==window.document,nt=et&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,rt=function(n){var r=n.addFilter,i=n.utils,o=i.Type,a=i.forin,s=i.getFileFromBlob,u=i.isFile,l=["crop","resize","filter","markup","output"],c=function(t){return null===t.aspectRatio&&0===t.rotation&&1===t.zoom&&t.center&&.5===t.center.x&&.5===t.center.y&&t.flip&&!1===t.flip.horizontal&&!1===t.flip.vertical};r("SHOULD_PREPARE_OUTPUT",(function(t,e){var n=e.query;return new Promise((function(t){t(!n("IS_ASYNC"))}))}));var d=function(t,e,n){return new Promise((function(r){if(!t("GET_ALLOW_IMAGE_TRANSFORM")||n.archived||!u(e)||!function(t){return/^image/.test(t.type)}(e))return r(!1);(function(t){return new Promise((function(e,n){var r=new Image;r.src=URL.createObjectURL(t);var i=function(){var t=r.naturalWidth,n=r.naturalHeight;t&&n&&(URL.revokeObjectURL(r.src),clearInterval(o),e({width:t,height:n}))};r.onerror=function(t){URL.revokeObjectURL(r.src),clearInterval(o),n(t)};var o=setInterval(i,1);i()}))})(e).then((function(){var n=t("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(n){var i=n(e);if(null==i)return handleRevert(!0);if("boolean"==typeof i)return r(i);if("function"==typeof i.then)return i.then(r)}r(!0)})).catch((function(t){r(!1)}))}))};return r("DID_CREATE_ITEM",(function(t,e){var n=e.query,r=e.dispatch;n("GET_ALLOW_IMAGE_TRANSFORM")&&t.extend("requestPrepare",(function(){return new Promise((function(e,n){r("REQUEST_PREPARE_OUTPUT",{query:t.id,item:t,success:e,failure:n},!0)}))}))})),r("PREPARE_OUTPUT",(function(n,r){var i=r.query,o=r.item;return new Promise((function(r){d(i,n,o).then((function(u){if(!u)return r(n);var d=[];i("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")&&d.push((function(){return new Promise((function(t){t({name:i("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:n})}))})),i("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")&&d.push((function(t,e,n){return new Promise((function(r){t(e,n).then((function(t){return r({name:i("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:t})}))}))}));var p=i("GET_IMAGE_TRANSFORM_VARIANTS")||{};a(p,(function(t,e){var n,r=(n=e,function(t,e,r){return t(e,n?n(r):r)});d.push((function(e,n,i){return new Promise((function(o){r(e,n,i).then((function(e){return o({name:t,file:e})}))}))}))}));var v=i("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY"),m=i("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE"),E=null===v?null:v/100,_=i("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE"),b=i("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||l;o.setMetadata("output",{type:_,quality:E,client:b},!0);var y=function(n,r){return new Promise((function(o,a){var u=Object.assign({},r);Object.keys(u).filter((function(t){return"exif"!==t})).forEach((function(t){-1===b.indexOf(t)&&delete u[t]}));var l=u.resize,d=u.exif,p=u.output,v=u.crop,E=u.filter,_=u.markup,y={image:{orientation:d?d.orientation:null},output:p&&(p.type||"number"==typeof p.quality||p.background)?{type:p.type,quality:"number"==typeof p.quality?100*p.quality:null,background:p.background||i("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||null}:void 0,size:l&&(l.size.width||l.size.height)?Object.assign({mode:l.mode,upscale:l.upscale},l.size):void 0,crop:v&&!c(v)?Object.assign({},v):void 0,markup:_&&_.length?_.map(tt):[],filter:E};if(y.output){var T=!!p.type&&p.type!==n.type,I=/\/jpe?g$/.test(n.type),S=null!==p.quality&&(I&&"always"===m);if(!!!(y.size||y.crop||y.filter||T||S))return o(n)}var R={beforeCreateBlob:i("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),afterCreateBlob:i("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),canvasMemoryLimit:i("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),stripImageHead:i("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")};(function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,o){if(!t||!e(t))return o({status:"not an image file",file:t});var a=r.stripImageHead,s=r.beforeCreateBlob,u=r.afterCreateBlob,l=r.canvasMemoryLimit,c=n.crop,d=n.size,p=n.filter,v=n.markup,m=n.output,E=n.image&&n.image.orientation?Math.max(1,Math.min(8,n.image.orientation)):null,_=m&&m.quality,b=null===_?null:_/100,y=m&&m.type||null,T=m&&m.background||null,I=[];!d||"number"!=typeof d.width&&"number"!=typeof d.height||I.push({type:"resize",data:d}),p&&20===p.length&&I.push({type:"filter",data:p});var S=function(t){var e=u?u(t):t;Promise.resolve(e).then(i)},R=function(e,n){var r=X(e),i=v.length?V(r,v):r;Promise.resolve(i).then((function(e){g(e,n,s).then((function(n){if(f(e),a)return S(n);z(t).then((function(t){null!==t&&(n=new Blob([t,n.slice(20)],{type:n.type})),S(n)}))})).catch(o)}))};if(/svg/.test(t.type)&&null===y)return N(t,c,v,{background:T}).then((function(t){i(F(t,"image/svg+xml"))}));var w=URL.createObjectURL(t);q(w).then((function(e){URL.revokeObjectURL(w);var n=h(e,E,c,{canvasMemoryLimit:l,background:T}),r={quality:b,type:y||t.type};if(!I.length)return R(n,r);var i=U(k);i.post({transforms:I,imageData:n},(function(t){R(G(t),r),i.terminate()}),[n.data.buffer])})).catch(o)}))})(n,y,R).then((function(e){var r=s(e,function(e,n){var r=function(t){return t.substr(0,t.lastIndexOf("."))||t}(e),i=n.split("/")[1],o=t[i]||i;return"".concat(r,".").concat(o)}(n.name,function(t){return/jpeg|png|svg\+xml/.test(t)?t:"image/jpeg"}(e.type)));o(r)})).catch(a)}))},T=d.map((function(t){return t(y,n,o.getMetadata())}));Promise.all(T).then((function(t){r(1===t.length&&null===t[0].name?t[0].file:t)}))}))}))})),{options:{allowImageTransform:[!0,o.BOOLEAN],imageTransformImageFilter:[null,o.FUNCTION],imageTransformOutputMimeType:[null,o.STRING],imageTransformOutputQuality:[null,o.INT],imageTransformOutputStripImageHead:[!0,o.BOOLEAN],imageTransformClientTransforms:[null,o.ARRAY],imageTransformOutputQualityMode:["always",o.STRING],imageTransformVariants:[null,o.OBJECT],imageTransformVariantsIncludeDefault:[!0,o.BOOLEAN],imageTransformVariantsDefaultName:[null,o.STRING],imageTransformVariantsIncludeOriginal:[!1,o.BOOLEAN],imageTransformVariantsOriginalName:["original_",o.STRING],imageTransformBeforeCreateBlob:[null,o.FUNCTION],imageTransformAfterCreateBlob:[null,o.FUNCTION],imageTransformCanvasMemoryLimit:[et&&nt?16777216:null,o.INT],imageTransformCanvasBackgroundColor:[null,o.STRING]}}};return et&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:rt})),rt})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FilePondPluginImageCrop=e()}(this,(function(){"use strict";var t=function(t){return/^image/.test(t.type)},e=function(e){var n=e.addFilter,r=e.utils,i=r.Type,o=r.isFile,a=r.getNumericAspectRatioFromString,s=function(e,n){return!(!t(e.file)||!n("GET_ALLOW_IMAGE_CROP"))},u=function(t){return"object"==typeof t},l=function(t){return"number"==typeof t},c=function(t,e){return t.setMetadata("crop",Object.assign({},t.getMetadata("crop"),e))};return n("DID_CREATE_ITEM",(function(t,e){var n=e.query;t.extend("setImageCrop",(function(e){if(s(t,n)&&u(center))return t.setMetadata("crop",e),e})),t.extend("setImageCropCenter",(function(e){if(s(t,n)&&u(e))return c(t,{center:e})})),t.extend("setImageCropZoom",(function(e){if(s(t,n)&&l(e))return c(t,{zoom:Math.max(1,e)})})),t.extend("setImageCropRotation",(function(e){if(s(t,n)&&l(e))return c(t,{rotation:e})})),t.extend("setImageCropFlip",(function(e){if(s(t,n)&&u(e))return c(t,{flip:e})})),t.extend("setImageCropAspectRatio",(function(e){if(s(t,n)&&void 0!==e){var r=t.getMetadata("crop"),i=a(e),o={center:{x:.5,y:.5},flip:r?Object.assign({},r.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:i};return t.setMetadata("crop",o),o}}))})),n("DID_LOAD_ITEM",(function(e,n){var r=n.query;return new Promise((function(n,i){var s=e.file;if(!o(s)||!t(s)||!r("GET_ALLOW_IMAGE_CROP"))return n(e);if(e.getMetadata("crop"))return n(e);var u=r("GET_IMAGE_CROP_ASPECT_RATIO");e.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:u?a(u):null}),n(e)}))})),{options:{allowImageCrop:[!0,i.BOOLEAN],imageCropAspectRatio:[null,i.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FilePondPluginImageEdit=e()}(this,(function(){"use strict";var t=function(t){return/^image/.test(t.type)},e=function(e){var n=e.addFilter,r=e.utils,i=e.views,o=r.Type,a=r.createRoute,s=r.createItemAPI,u=void 0===s?function(t){return t}:s,l=i.fileActionButton;n("SHOULD_REMOVE_ON_REVERT",(function(e,n){var r=n.item,i=n.query;return new Promise((function(e){var n=r.file;e(!(i("GET_ALLOW_IMAGE_EDIT")&&i("GET_IMAGE_EDIT_ALLOW_EDIT")&&t(n)))}))})),n("DID_LOAD_ITEM",(function(e,n){var r=n.query,i=n.dispatch;return new Promise((function(n,o){if(e.origin>1)n(e);else{var a=e.file;if(r("GET_ALLOW_IMAGE_EDIT")&&r("GET_IMAGE_EDIT_INSTANT_EDIT"))if(t(a)){var s=function(t,e,n){return function(r){c.shift(),r?e(t):n(t),i("KICK"),u()}},u=function(){if(c.length){var t=c[0],e=t.item,n=t.resolve,r=t.reject;i("EDIT_ITEM",{id:e.id,handleEditorResponse:s(e,n,r)})}};f({item:e,resolve:n,reject:o}),1===c.length&&u()}else n(e);else n(e)}}))})),n("DID_CREATE_ITEM",(function(t,e){e.query;var n=e.dispatch;t.extend("edit",(function(){n("EDIT_ITEM",{id:t.id})}))}));var c=[],f=function(t){return c.push(t),t};return n("CREATE_VIEW",(function(e){var n=e.is,r=e.view,i=e.query;if(i("GET_ALLOW_IMAGE_EDIT")){var o=i("GET_ALLOW_IMAGE_PREVIEW");if(n("file-info")&&!o||n("file")&&o){var s=i("GET_IMAGE_EDIT_EDITOR");if(s){s.filepondCallbackBridge||(s.outputData=!0,s.outputFile=!1,s.filepondCallbackBridge={onconfirm:s.onconfirm||function(){},oncancel:s.oncancel||function(){}});r.registerDestroyer((function(t){var e=t.root;e.ref.buttonEditItem&&e.ref.buttonEditItem.off("click",e.ref.handleEdit),e.ref.editButton&&e.ref.editButton.removeEventListener("click",e.ref.handleEdit)}));var c={EDIT_ITEM:function(t){var e=t.root,n=t.props,r=t.action,i=n.id,o=r.handleEditorResponse;s.cropAspectRatio=e.query("GET_IMAGE_CROP_ASPECT_RATIO")||s.cropAspectRatio,s.outputCanvasBackgroundColor=e.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||s.outputCanvasBackgroundColor;var a=e.query("GET_ITEM",i);if(a){var l=a.file,c=a.getMetadata("crop"),f=a.getMetadata("resize"),d=a.getMetadata("filter")||null,p=a.getMetadata("filters")||null,h=a.getMetadata("colors")||null,g=a.getMetadata("markup")||null,v={crop:c||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},size:f?{upscale:f.upscale,mode:f.mode,width:f.size.width,height:f.size.height}:null,filter:p?p.id||p.matrix:e.query("GET_ALLOW_IMAGE_FILTER")&&e.query("GET_IMAGE_FILTER_COLOR_MATRIX")&&!h?d:null,color:h,markup:g};s.onconfirm=function(t){var e=t.data,n=e.crop,r=e.size,i=e.filter,l=e.color,c=e.colorMatrix,f=e.markup,d={};if(n&&(d.crop=n),r){var p=(a.getMetadata("resize")||{}).size,h={width:r.width,height:r.height};h.width&&h.height||!p||(h.width=p.width,h.height=p.height),(h.width||h.height)&&(d.resize={upscale:r.upscale,mode:r.mode,size:h})}f&&(d.markup=f),d.colors=l,d.filters=i,d.filter=c,a.setMetadata(d),s.filepondCallbackBridge.onconfirm(e,u(a)),o&&(s.onclose=function(){o(!0),s.onclose=null})},s.oncancel=function(){s.filepondCallbackBridge.oncancel(u(a)),o&&(s.onclose=function(){o(!1),s.onclose=null})},s.open(l,v)}},DID_LOAD_ITEM:function(e){var n=e.root,a=e.props;if(i("GET_IMAGE_EDIT_ALLOW_EDIT")){var s=a.id,u=i("GET_ITEM",s);if(u){var c=u.file;if(t(c))if(n.ref.handleEdit=function(t){t.stopPropagation(),n.dispatch("EDIT_ITEM",{id:s})},o){var f=r.createChildView(l,{label:"edit",icon:i("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});f.element.classList.add("filepond--action-edit-item"),f.element.dataset.align=i("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),f.on("click",n.ref.handleEdit),n.ref.buttonEditItem=r.appendChildView(f)}else{var d=r.element.querySelector(".filepond--file-info-main"),p=document.createElement("button");p.className="filepond--action-edit-item-alt",p.innerHTML=i("GET_IMAGE_EDIT_ICON_EDIT")+"<span>edit</span>",p.addEventListener("click",n.ref.handleEdit),d.appendChild(p),n.ref.editButton=p}}}}};if(o){c.DID_IMAGE_PREVIEW_SHOW=function(t){var e=t.root;e.ref.buttonEditItem&&(e.ref.buttonEditItem.opacity=1)}}r.registerWriter(a(c))}}}})),{options:{allowImageEdit:[!0,o.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",o.STRING],imageEditInstantEdit:[!1,o.BOOLEAN],imageEditAllowEdit:[!0,o.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',o.STRING],imageEditEditor:[null,o.OBJECT]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).FilePond={})}(this,(function(t){"use strict";var e=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])},n=function(t){var n={};return e(t,(function(e){!function(t,e,n){"function"!=typeof n?Object.defineProperty(t,e,Object.assign({},n)):t[e]=n}(n,e,t[e])})),n},r=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===n)return t.getAttribute(e)||t.hasAttribute(e);t.setAttribute(e,n)},i=["svg","path"],o=function(t){return i.includes(t)},a=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"object"==typeof n&&(i=n,n=null);var a=o(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n&&(o(t)?r(a,"class",n):a.className=n),e(i,(function(t,e){r(a,t,e)})),a},s=function(t,e){return function(t,n){return void 0!==n?e.splice(n,0,t):e.push(t),t}},u=function(t,e){return function(n){return e.splice(e.indexOf(n),1),n.element.parentNode&&t.removeChild(n.element),n}},l="undefined"!=typeof window&&void 0!==window.document,c=function(){return l},f="children"in(c()?a("svg"):{})?function(t){return t.children.length}:function(t){return t.childNodes.length},d=function(t,e,n,r){var i=n[0]||t.left,o=n[1]||t.top,a=i+t.width,s=o+t.height*(r[1]||1),u={element:Object.assign({},t),inner:{left:t.left,top:t.top,right:t.right,bottom:t.bottom},outer:{left:i,top:o,right:a,bottom:s}};return e.filter((function(t){return!t.isRectIgnored()})).map((function(t){return t.rect})).forEach((function(t){p(u.inner,Object.assign({},t.inner)),p(u.outer,Object.assign({},t.outer))})),h(u.inner),u.outer.bottom+=u.element.marginBottom,u.outer.right+=u.element.marginRight,h(u.outer),u},p=function(t,e){e.top+=t.top,e.right+=t.left,e.bottom+=t.top,e.left+=t.left,e.bottom>t.bottom&&(t.bottom=e.bottom),e.right>t.right&&(t.right=e.right)},h=function(t){t.width=t.right-t.left,t.height=t.bottom-t.top},g=function(t){return"number"==typeof t},v=function(t){return t<.5?2*t*t:(4-2*t)*t-1},m={spring:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.stiffness,r=void 0===e?.5:e,i=t.damping,o=void 0===i?.75:i,a=t.mass,s=void 0===a?10:a,u=null,l=null,c=0,f=!1,d=n({interpolate:function(t,e){if(!f){if(!g(u)||!g(l))return f=!0,void(c=0);(function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001;return Math.abs(t-e)<r&&Math.abs(n)<r})(l+=c+=-(l-u)*r/s,u,c*=o)||e?(l=u,c=0,f=!0,d.onupdate(l),d.oncomplete(l)):d.onupdate(l)}},target:{set:function(t){if(g(t)&&!g(l)&&(l=t),null===u&&(u=t,l=t),l===(u=t)||void 0===u)return f=!0,c=0,d.onupdate(l),void d.oncomplete(l);f=!1},get:function(){return u}},resting:{get:function(){return f}},onupdate:function(t){},oncomplete:function(t){}});return d},tween:function(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.duration,o=void 0===i?500:i,a=r.easing,s=void 0===a?v:a,u=r.delay,l=void 0===u?0:u,c=null,f=!0,d=!1,p=null,h=n({interpolate:function(n,r){f||null===p||(null===c&&(c=n),n-c<l||((t=n-c-l)>=o||r?(t=1,e=d?0:1,h.onupdate(e*p),h.oncomplete(e*p),f=!0):(e=t/o,h.onupdate((t>=0?s(d?1-e:e):0)*p))))},target:{get:function(){return d?0:p},set:function(t){if(null===p)return p=t,h.onupdate(t),void h.oncomplete(t);t<p?(p=1,d=!0):(d=!1,p=t),f=!1,c=null}},resting:{get:function(){return f}},onupdate:function(t){},oncomplete:function(t){}});return h}},E=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(e=Array.isArray(e)?e:[e]).forEach((function(e){t.forEach((function(t){var i=t,o=function(){return n[t]},a=function(e){return n[t]=e};"object"==typeof t&&(i=t.key,o=t.getter||o,a=t.setter||a),e[i]&&!r||(e[i]={get:o,set:a})}))}))},_=function(t){return null!=t},b={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},y={styles:function(t){var e=t.mixinConfig,n=t.viewProps,r=t.viewInternalAPI,i=t.viewExternalAPI,o=t.view,a=Object.assign({},n),s={};E(e,[r,i],n);var u=function(){return o.rect?d(o.rect,o.childViews,[n.translateX||0,n.translateY||0],[n.scaleX||0,n.scaleY||0]):null};return r.rect={get:u},i.rect={get:u},e.forEach((function(t){n[t]=void 0===a[t]?b[t]:a[t]})),{write:function(){if(function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!0;for(var n in e)if(e[n]!==t[n])return!0;return!1}(s,n))return function(t,e){var n=e.opacity,r=e.perspective,i=e.translateX,o=e.translateY,a=e.scaleX,s=e.scaleY,u=e.rotateX,l=e.rotateY,c=e.rotateZ,f=e.originX,d=e.originY,p=e.width,h=e.height,g="",v="";(_(f)||_(d))&&(v+="transform-origin: "+(f||0)+"px "+(d||0)+"px;"),_(r)&&(g+="perspective("+r+"px) "),(_(i)||_(o))&&(g+="translate3d("+(i||0)+"px, "+(o||0)+"px, 0) "),(_(a)||_(s))&&(g+="scale3d("+(_(a)?a:1)+", "+(_(s)?s:1)+", 1) "),_(c)&&(g+="rotateZ("+c+"rad) "),_(u)&&(g+="rotateX("+u+"rad) "),_(l)&&(g+="rotateY("+l+"rad) "),g.length&&(v+="transform:"+g+";"),_(n)&&(v+="opacity:"+n+";",0===n&&(v+="visibility:hidden;"),n<1&&(v+="pointer-events:none;")),_(h)&&(v+="height:"+h+"px;"),_(p)&&(v+="width:"+p+"px;");var m=t.elementCurrentStyle||"";v.length===m.length&&v===m||(t.style.cssText=v,t.elementCurrentStyle=v)}(o.element,n),Object.assign(s,Object.assign({},n)),!0},destroy:function(){}}},listeners:function(t){t.mixinConfig,t.viewProps,t.viewInternalAPI;var e,n=t.viewExternalAPI,r=(t.viewState,t.view),i=[],o=(e=r.element,function(t,n){e.addEventListener(t,n)}),a=function(t){return function(e,n){t.removeEventListener(e,n)}}(r.element);return n.on=function(t,e){i.push({type:t,fn:e}),o(t,e)},n.off=function(t,e){i.splice(i.findIndex((function(n){return n.type===t&&n.fn===e})),1),a(t,e)},{write:function(){return!0},destroy:function(){i.forEach((function(t){a(t.type,t.fn)}))}}},animations:function(t){var n=t.mixinConfig,r=t.viewProps,i=t.viewInternalAPI,o=t.viewExternalAPI,a=Object.assign({},r),s=[];return e(n,(function(t,e){var n=function(t,e,n){var r=t[e]&&"object"==typeof t[e][n]?t[e][n]:t[e]||t,i="string"==typeof r?r:r.type,o="object"==typeof r?Object.assign({},r):{};return m[i]?m[i](o):null}(e);n&&(n.onupdate=function(e){r[t]=e},n.target=a[t],E([{key:t,setter:function(t){n.target!==t&&(n.target=t)},getter:function(){return r[t]}}],[i,o],r,!0),s.push(n))})),{write:function(t){var e=document.hidden,n=!0;return s.forEach((function(r){r.resting||(n=!1),r.interpolate(t,e)})),n},destroy:function(){}}},apis:function(t){var e=t.mixinConfig,n=t.viewProps,r=t.viewExternalAPI;E(e,r,n)}},T=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.layoutCalculated||(t.paddingTop=parseInt(n.paddingTop,10)||0,t.marginTop=parseInt(n.marginTop,10)||0,t.marginRight=parseInt(n.marginRight,10)||0,t.marginBottom=parseInt(n.marginBottom,10)||0,t.marginLeft=parseInt(n.marginLeft,10)||0,e.layoutCalculated=!0),t.left=e.offsetLeft||0,t.top=e.offsetTop||0,t.width=e.offsetWidth||0,t.height=e.offsetHeight||0,t.right=t.left+t.width,t.bottom=t.top+t.height,t.scrollTop=e.scrollTop,t.hidden=null===e.offsetParent,t},I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tag,r=void 0===e?"div":e,i=t.name,o=void 0===i?null:i,l=t.attributes,c=void 0===l?{}:l,p=t.read,h=void 0===p?function(){}:p,g=t.write,v=void 0===g?function(){}:g,m=t.create,E=void 0===m?function(){}:m,_=t.destroy,b=void 0===_?function(){}:_,I=t.filterFrameActionsForChild,S=void 0===I?function(t,e){return e}:I,R=t.didCreateView,w=void 0===R?function(){}:R,O=t.didWriteView,C=void 0===O?function(){}:O,M=t.ignoreRect,D=void 0!==M&&M,x=t.ignoreRectUpdate,A=void 0!==x&&x,P=t.mixins,L=void 0===P?[]:P;return function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=a(r,"filepond--"+o,c),p=window.getComputedStyle(l,null),g=T(),m=null,_=!1,I=[],R=[],O={},M={},x=[v],P=[h],N=[b],G=function(){return l},k=function(){return I.concat()},B=function(){return m||(m=d(g,I,[0,0],[1,1]))},z={element:{get:G},style:{get:function(){return p}},childViews:{get:k}},F=Object.assign({},z,{rect:{get:B},ref:{get:function(){return O}},is:function(t){return o===t},appendChild:(e=l,function(t,n){void 0!==n&&e.children[n]?e.insertBefore(t,e.children[n]):e.appendChild(t)}),createChildView:function(t){return function(e,n){return e(t,n)}}(t),linkView:function(t){return I.push(t),t},unlinkView:function(t){I.splice(I.indexOf(t),1)},appendChildView:s(0,I),removeChildView:u(l,I),registerWriter:function(t){return x.push(t)},registerReader:function(t){return P.push(t)},registerDestroyer:function(t){return N.push(t)},invalidateLayout:function(){return l.layoutCalculated=!1},dispatch:t.dispatch,query:t.query}),U={element:{get:G},childViews:{get:k},rect:{get:B},resting:{get:function(){return _}},isRectIgnored:function(){return D},_read:function(){m=null,I.forEach((function(t){return t._read()})),!(A&&g.width&&g.height)&&T(g,l,p);var t={root:V,props:i,rect:g};P.forEach((function(e){return e(t)}))},_write:function(t,e,n){var r=0===e.length;return x.forEach((function(o){!1===o({props:i,root:V,actions:e,timestamp:t,shouldOptimize:n})&&(r=!1)})),R.forEach((function(e){!1===e.write(t)&&(r=!1)})),I.filter((function(t){return!!t.element.parentNode})).forEach((function(i){i._write(t,S(i,e),n)||(r=!1)})),I.forEach((function(i,o){i.element.parentNode||(V.appendChild(i.element,o),i._read(),i._write(t,S(i,e),n),r=!1)})),_=r,C({props:i,root:V,actions:e,timestamp:t}),r},_destroy:function(){R.forEach((function(t){return t.destroy()})),N.forEach((function(t){t({root:V,props:i})})),I.forEach((function(t){return t._destroy()}))}},q=Object.assign({},z,{rect:{get:function(){return g}}});Object.keys(L).sort((function(t,e){return"styles"===t?1:"styles"===e?-1:0})).forEach((function(t){var e=y[t]({mixinConfig:L[t],viewProps:i,viewState:M,viewInternalAPI:F,viewExternalAPI:U,view:n(q)});e&&R.push(e)}));var V=n(F);E({root:V,props:i});var Y=f(l);return I.forEach((function(t,e){V.appendChild(t.element,Y+e)})),w(V),n(U)}},S=function(t,e){return function(n){var r=n.root,i=n.props,o=n.actions,a=void 0===o?[]:o,s=n.timestamp,u=n.shouldOptimize;a.filter((function(e){return t[e.type]})).forEach((function(e){return t[e.type]({root:r,props:i,action:e.data,timestamp:s,shouldOptimize:u})})),e&&e({root:r,props:i,actions:a,timestamp:s,shouldOptimize:u})}},R=function(t,e){return e.parentNode.insertBefore(t,e)},w=function(t,e){return e.parentNode.insertBefore(t,e.nextSibling)},O=function(t){return Array.isArray(t)},C=function(t){return null==t},M=function(t){return t.trim()},D=function(t){return""+t},x=function(t){return"boolean"==typeof t},A=function(t){return x(t)?t:"true"===t},P=function(t){return"string"==typeof t},L=function(t){return g(t)?t:P(t)?D(t).replace(/[a-z]+/gi,""):0},N=function(t){return parseInt(L(t),10)},G=function(t){return parseFloat(L(t))},k=function(t){return g(t)&&isFinite(t)&&Math.floor(t)===t},B=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(k(t))return t;var n=D(t).trim();return/MB$/i.test(n)?(n=n.replace(/MB$i/,"").trim(),N(n)*e*e):/KB/i.test(n)?(n=n.replace(/KB$i/,"").trim(),N(n)*e):N(n)},z=function(t){return"function"==typeof t},F={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},U=function(t){return"object"==typeof t&&null!==t},q=function(t){return O(t)?"array":function(t){return null===t}(t)?"null":k(t)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(t)?"bytes":function(t){return U(t)&&P(t.url)&&U(t.process)&&U(t.revert)&&U(t.restore)&&U(t.fetch)}(t)?"api":typeof t},V={array:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return C(t)?[]:O(t)?t:D(t).split(e).map(M).filter((function(t){return t.length}))},boolean:A,int:function(t){return"bytes"===q(t)?B(t):N(t)},number:G,float:G,bytes:B,string:function(t){return z(t)?t:D(t)},function:function(t){return function(t){for(var e=self,n=t.split("."),r=null;r=n.shift();)if(!(e=e[r]))return null;return e}(t)},serverapi:function(t){return(r={}).url=P(n=t)?n:n.url||"",r.timeout=n.timeout?parseInt(n.timeout,10):0,r.headers=n.headers?n.headers:{},e(F,(function(t){r[t]=function(t,e,n,r,i){if(null===e)return null;if("function"==typeof e)return e;var o={url:"GET"===n||"PATCH"===n?"?"+t+"=":"",method:n,headers:i,withCredentials:!1,timeout:r,onload:null,ondata:null,onerror:null};if(P(e))return o.url=e,o;if(Object.assign(o,e),P(o.headers)){var a=o.headers.split(/:(.+)/);o.headers={header:a[0],value:a[1]}}return o.withCredentials=A(o.withCredentials),o}(t,n[t],F[t],r.timeout,r.headers)})),r.process=n.process||P(n)||n.url?r.process:null,r.remove=n.remove||null,delete r.headers,r;var n,r},object:function(t){try{return JSON.parse(t.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'))}catch(t){return null}}},Y=function(t,e,n){if(t===e)return t;var r,i=q(t);if(i!==n){var o=(r=t,V[n](r));if(i=q(o),null===o)throw'Trying to assign value with incorrect type to "'+option+'", allowed type: "'+n+'"';t=o}return t},j=function(t){var r={};return e(t,(function(e){var n,i,o,a=t[e];r[e]=(n=a[0],i=a[1],o=n,{enumerable:!0,get:function(){return o},set:function(t){o=Y(t,n,i)}})})),n(r)},W=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t.split(/(?=[A-Z])/).map((function(t){return t.toLowerCase()})).join(e)},X=function(t){return function(n,r,i){var o={};return e(t,(function(t){var e=W(t,"_").toUpperCase();o["SET_"+e]=function(r){try{i.options[t]=r.value}catch(t){}n("DID_SET_"+e,{value:i.options[t]})}})),o}},H=function(t){return function(n){var r={};return e(t,(function(t){r["GET_"+W(t,"_").toUpperCase()]=function(e){return n.options[t]}})),r}},$=function(){return Math.random().toString(36).substr(2,9)};function Z(t){this.wrapped=t}function Q(t){var e,n;function r(e,n){try{var o=t[e](n),a=o.value,s=a instanceof Z;Promise.resolve(s?a.wrapped:a).then((function(t){s?r("next",t):i(o.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,i){return new Promise((function(o,a){var s={key:t,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(e=n=s,r(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}function K(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function J(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}"function"==typeof Symbol&&Symbol.asyncIterator&&(Q.prototype[Symbol.asyncIterator]=function(){return this}),Q.prototype.next=function(t){return this._invoke("next",t)},Q.prototype.throw=function(t){return this._invoke("throw",t)},Q.prototype.return=function(t){return this._invoke("return",t)};var tt,et,nt=function(t,e){return t.splice(e,1)},rt=function(){var t=[],e=function(e,n){nt(t,t.findIndex((function(t){return t.event===e&&(t.cb===n||!n)})))},n=function(e,n,r){t.filter((function(t){return t.event===e})).map((function(t){return t.cb})).forEach((function(t){return function(t,e){e?t():document.hidden?Promise.resolve(1).then(t):setTimeout(t,0)}((function(){return t.apply(void 0,J(n))}),r)}))};return{fireSync:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];n(t,r,!0)},fire:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];n(t,r,!1)},on:function(e,n){t.push({event:e,cb:n})},onOnce:function(n,r){t.push({event:n,cb:function(){e(n,r),r.apply(void 0,arguments)}})},off:e}},it=function(t,e,n){Object.getOwnPropertyNames(t).filter((function(t){return!n.includes(t)})).forEach((function(n){return Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))},ot=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],at=function(t){var e={};return it(t,e,ot),e},st={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},ut={INPUT:1,LIMBO:2,LOCAL:3},lt=function(t){return/[^0-9]+/.exec(t)},ct=function(){return lt(1.1.toLocaleString())[0]},ft={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},dt=[],pt=function(t,e,n){return new Promise((function(r,i){var o=dt.filter((function(e){return e.key===t})).map((function(t){return t.cb}));if(0!==o.length){var a=o.shift();o.reduce((function(t,e){return t.then((function(t){return e(t,n)}))}),a(e,n)).then((function(t){return r(t)})).catch((function(t){return i(t)}))}else r(e)}))},ht=function(t,e,n){return dt.filter((function(e){return e.key===t})).map((function(t){return t.cb(e,n)}))},gt=function(t,e){return dt.push({key:t,cb:e})},vt=function(){return Object.assign({},mt)},mt={id:[null,ft.STRING],name:["filepond",ft.STRING],disabled:[!1,ft.BOOLEAN],className:[null,ft.STRING],required:[!1,ft.BOOLEAN],captureMethod:[null,ft.STRING],allowSyncAcceptAttribute:[!0,ft.BOOLEAN],allowDrop:[!0,ft.BOOLEAN],allowBrowse:[!0,ft.BOOLEAN],allowPaste:[!0,ft.BOOLEAN],allowMultiple:[!1,ft.BOOLEAN],allowReplace:[!0,ft.BOOLEAN],allowRevert:[!0,ft.BOOLEAN],allowRemove:[!0,ft.BOOLEAN],allowProcess:[!0,ft.BOOLEAN],allowReorder:[!1,ft.BOOLEAN],allowDirectoriesOnly:[!1,ft.BOOLEAN],storeAsFile:[!1,ft.BOOLEAN],forceRevert:[!1,ft.BOOLEAN],maxFiles:[null,ft.INT],checkValidity:[!1,ft.BOOLEAN],itemInsertLocationFreedom:[!0,ft.BOOLEAN],itemInsertLocation:["before",ft.STRING],itemInsertInterval:[75,ft.INT],dropOnPage:[!1,ft.BOOLEAN],dropOnElement:[!0,ft.BOOLEAN],dropValidation:[!1,ft.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],ft.ARRAY],instantUpload:[!0,ft.BOOLEAN],maxParallelUploads:[2,ft.INT],allowMinimumUploadDuration:[!0,ft.BOOLEAN],chunkUploads:[!1,ft.BOOLEAN],chunkForce:[!1,ft.BOOLEAN],chunkSize:[5e6,ft.INT],chunkRetryDelays:[[500,1e3,3e3],ft.ARRAY],server:[null,ft.SERVER_API],fileSizeBase:[1e3,ft.INT],labelDecimalSeparator:[ct(),ft.STRING],labelThousandsSeparator:[(tt=ct(),et=1e3.toLocaleString(),et!==1e3.toString()?lt(et)[0]:"."===tt?",":"."),ft.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',ft.STRING],labelInvalidField:["Field contains invalid files",ft.STRING],labelFileWaitingForSize:["Waiting for size",ft.STRING],labelFileSizeNotAvailable:["Size not available",ft.STRING],labelFileCountSingular:["file in list",ft.STRING],labelFileCountPlural:["files in list",ft.STRING],labelFileLoading:["Loading",ft.STRING],labelFileAdded:["Added",ft.STRING],labelFileLoadError:["Error during load",ft.STRING],labelFileRemoved:["Removed",ft.STRING],labelFileRemoveError:["Error during remove",ft.STRING],labelFileProcessing:["Uploading",ft.STRING],labelFileProcessingComplete:["Upload complete",ft.STRING],labelFileProcessingAborted:["Upload cancelled",ft.STRING],labelFileProcessingError:["Error during upload",ft.STRING],labelFileProcessingRevertError:["Error during revert",ft.STRING],labelTapToCancel:["tap to cancel",ft.STRING],labelTapToRetry:["tap to retry",ft.STRING],labelTapToUndo:["tap to undo",ft.STRING],labelButtonRemoveItem:["Remove",ft.STRING],labelButtonAbortItemLoad:["Abort",ft.STRING],labelButtonRetryItemLoad:["Retry",ft.STRING],labelButtonAbortItemProcessing:["Cancel",ft.STRING],labelButtonUndoItemProcessing:["Undo",ft.STRING],labelButtonRetryItemProcessing:["Retry",ft.STRING],labelButtonProcessItem:["Upload",ft.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',ft.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',ft.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',ft.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',ft.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',ft.STRING],oninit:[null,ft.FUNCTION],onwarning:[null,ft.FUNCTION],onerror:[null,ft.FUNCTION],onactivatefile:[null,ft.FUNCTION],oninitfile:[null,ft.FUNCTION],onaddfilestart:[null,ft.FUNCTION],onaddfileprogress:[null,ft.FUNCTION],onaddfile:[null,ft.FUNCTION],onprocessfilestart:[null,ft.FUNCTION],onprocessfileprogress:[null,ft.FUNCTION],onprocessfileabort:[null,ft.FUNCTION],onprocessfilerevert:[null,ft.FUNCTION],onprocessfile:[null,ft.FUNCTION],onprocessfiles:[null,ft.FUNCTION],onremovefile:[null,ft.FUNCTION],onpreparefile:[null,ft.FUNCTION],onupdatefiles:[null,ft.FUNCTION],onreorderfiles:[null,ft.FUNCTION],beforeDropFile:[null,ft.FUNCTION],beforeAddFile:[null,ft.FUNCTION],beforeRemoveFile:[null,ft.FUNCTION],beforePrepareFile:[null,ft.FUNCTION],stylePanelLayout:[null,ft.STRING],stylePanelAspectRatio:[null,ft.STRING],styleItemPanelAspectRatio:[null,ft.STRING],styleButtonRemoveItemPosition:["left",ft.STRING],styleButtonProcessItemPosition:["right",ft.STRING],styleLoadIndicatorPosition:["right",ft.STRING],styleProgressIndicatorPosition:["right",ft.STRING],styleButtonRemoveItemAlign:[!1,ft.BOOLEAN],files:[[],ft.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],ft.ARRAY]},Et=function(t,e){return C(e)?t[0]||null:k(e)?t[e]||null:("object"==typeof e&&(e=e.id),t.find((function(t){return t.id===e}))||null)},_t=function(t){if(C(t))return t;if(/:/.test(t)){var e=t.split(":");return e[1]/e[0]}return parseFloat(t)},bt=function(t){return t.filter((function(t){return!t.archived}))},yt={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4},Tt=null,It=[st.LOAD_ERROR,st.PROCESSING_ERROR,st.PROCESSING_REVERT_ERROR],St=[st.LOADING,st.PROCESSING,st.PROCESSING_QUEUED,st.INIT],Rt=[st.PROCESSING_COMPLETE],wt=function(t){return It.includes(t.status)},Ot=function(t){return St.includes(t.status)},Ct=function(t){return Rt.includes(t.status)},Mt=function(t){return U(t.options.server)&&(U(t.options.server.process)||z(t.options.server.process))},Dt=function(t){return{GET_STATUS:function(){var e=bt(t.items),n=yt.EMPTY,r=yt.ERROR,i=yt.BUSY,o=yt.IDLE,a=yt.READY;return 0===e.length?n:e.some(wt)?r:e.some(Ot)?i:e.some(Ct)?a:o},GET_ITEM:function(e){return Et(t.items,e)},GET_ACTIVE_ITEM:function(e){return Et(bt(t.items),e)},GET_ACTIVE_ITEMS:function(){return bt(t.items)},GET_ITEMS:function(){return t.items},GET_ITEM_NAME:function(e){var n=Et(t.items,e);return n?n.filename:null},GET_ITEM_SIZE:function(e){var n=Et(t.items,e);return n?n.fileSize:null},GET_STYLES:function(){return Object.keys(t.options).filter((function(t){return/^style/.test(t)})).map((function(e){return{name:e,value:t.options[e]}}))},GET_PANEL_ASPECT_RATIO:function(){return/circle/.test(t.options.stylePanelLayout)?1:_t(t.options.stylePanelAspectRatio)},GET_ITEM_PANEL_ASPECT_RATIO:function(){return t.options.styleItemPanelAspectRatio},GET_ITEMS_BY_STATUS:function(e){return bt(t.items).filter((function(t){return t.status===e}))},GET_TOTAL_ITEMS:function(){return bt(t.items).length},SHOULD_UPDATE_FILE_INPUT:function(){return t.options.storeAsFile&&function(){if(null===Tt)try{var t=new DataTransfer;t.items.add(new File(["hello world"],"This_Works.txt"));var e=document.createElement("input");e.setAttribute("type","file"),e.files=t.files,Tt=1===e.files.length}catch(t){Tt=!1}return Tt}()&&!Mt(t)},IS_ASYNC:function(){return Mt(t)}}},xt=function(t,e,n){return Math.max(Math.min(n,t),e)},At=function(t){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(t)},Pt=function(t){return t.split("/").pop().split("?").shift()},Lt=function(t){return t.split(".").pop()},Nt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(e+t).slice(-e.length)},Gt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return t.getFullYear()+"-"+Nt(t.getMonth()+1,"00")+"-"+Nt(t.getDate(),"00")+"_"+Nt(t.getHours(),"00")+"-"+Nt(t.getMinutes(),"00")+"-"+Nt(t.getSeconds(),"00")},kt=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i="string"==typeof n?t.slice(0,t.size,n):t.slice(0,t.size,t.type);return i.lastModifiedDate=new Date,t._relativePath&&(i._relativePath=t._relativePath),P(e)||(e=Gt()),e&&null===r&&Lt(e)?i.name=e:(r=r||function(t){if("string"!=typeof t)return"";var e=t.split("/").pop();return/svg/.test(e)?"svg":/zip|compressed/.test(e)?"zip":/plain/.test(e)?"txt":/msword/.test(e)?"doc":/[a-z]+/.test(e)?"jpeg"===e?"jpg":e:""}(i.type),i.name=e+(r?"."+r:"")),i},Bt=function(t,e){var n=window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(n){var r=new n;return r.append(t),r.getBlob(e)}return new Blob([t],{type:e})},zt=function(t){return(/^data:(.+);/.exec(t)||[])[1]||null},Ft=function(t){if(!/^content-disposition:/i.test(t))return null;var e=t.split(/filename=|filename\*=.+''/).splice(1).map((function(t){return t.trim().replace(/^["']|[;"']{0,2}$/g,"")})).filter((function(t){return t.length}));return e.length?decodeURI(e[e.length-1]):null},Ut=function(t){if(/content-length:/i.test(t)){var e=t.match(/[0-9]+/)[0];return e?parseInt(e,10):null}return null},qt=function(t){return/x-content-transfer-id:/i.test(t)&&(t.split(":")[1]||"").trim()||null},Vt=function(t){var e={source:null,name:null,size:null},n=t.split("\n"),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,l=Ft(u);if(l)e.name=l;else{var c=Ut(u);if(c)e.size=c;else{var f=qt(u);f&&(e.source=f)}}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e},Yt=function(t){var e={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},n=function(n){t?(e.timestamp=Date.now(),e.request=t(n,(function(t){e.duration=Date.now()-e.timestamp,e.complete=!0,t instanceof Blob&&(t=kt(t,t.name||Pt(n))),r.fire("load",t instanceof Blob?t:t?t.body:null)}),(function(t){r.fire("error","string"==typeof t?{type:"error",code:0,body:t}:t)}),(function(t,n,i){i&&(e.size=i),e.duration=Date.now()-e.timestamp,t?(e.progress=n/i,r.fire("progress",e.progress)):e.progress=null}),(function(){r.fire("abort")}),(function(t){var n=Vt("string"==typeof t?t:t.headers);r.fire("meta",{size:e.size||n.size,filename:n.name,source:n.source})}))):r.fire("error",{type:"error",body:"Can't load URL",code:400})},r=Object.assign({},rt(),{setSource:function(t){return e.source=t},getProgress:function(){return e.progress},abort:function(){e.request&&e.request.abort&&e.request.abort()},load:function(){var t=e.source;r.fire("init",t),t instanceof File?r.fire("load",t):t instanceof Blob?r.fire("load",kt(t,t.name)):At(t)?r.fire("load",kt(function(t){var e=zt(t);return function(t,e){for(var n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return Bt(n,e)}(function(t){return atob(function(t){return t.split(",")[1].replace(/\s/g,"")}(t))}(t),e)}(t),undefined,null,undefined)):n(t)}});return r},jt=function(t){return/GET|HEAD/.test(t)},Wt=function(t,e,n){var r={onheaders:function(){},onprogress:function(){},onload:function(){},ontimeout:function(){},onerror:function(){},onabort:function(){},abort:function(){i=!0,a.abort()}},i=!1,o=!1;n=Object.assign({method:"POST",headers:{},withCredentials:!1},n),e=encodeURI(e),jt(n.method)&&t&&(e=""+e+encodeURIComponent("string"==typeof t?t:JSON.stringify(t)));var a=new XMLHttpRequest;return(jt(n.method)?a:a.upload).onprogress=function(t){i||r.onprogress(t.lengthComputable,t.loaded,t.total)},a.onreadystatechange=function(){a.readyState<2||4===a.readyState&&0===a.status||o||(o=!0,r.onheaders(a))},a.onload=function(){a.status>=200&&a.status<300?r.onload(a):r.onerror(a)},a.onerror=function(){return r.onerror(a)},a.onabort=function(){i=!0,r.onabort()},a.ontimeout=function(){return r.ontimeout(a)},a.open(n.method,e,!0),k(n.timeout)&&(a.timeout=n.timeout),Object.keys(n.headers).forEach((function(t){var e=unescape(encodeURIComponent(n.headers[t]));a.setRequestHeader(t,e)})),n.responseType&&(a.responseType=n.responseType),n.withCredentials&&(a.withCredentials=!0),a.send(t),r},Xt=function(t,e,n,r){return{type:t,code:e,body:n,headers:r}},Ht=function(t){return function(e){t(Xt("error",0,"Timeout",e.getAllResponseHeaders()))}},$t=function(t){return/\?/.test(t)},Zt=function(){for(var t="",e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){t+=$t(t)&&$t(e)?e.replace(/\?/,"&"):e})),t},Qt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if("function"==typeof e)return e;if(!e||!P(e.url))return null;var n=e.onload||function(t){return t},r=e.onerror||function(t){return null};return function(i,o,a,s,u,l){var c=Wt(i,Zt(t,e.url),Object.assign({},e,{responseType:"blob"}));return c.onload=function(t){var r=t.getAllResponseHeaders(),a=Vt(r).name||Pt(i);o(Xt("load",t.status,"HEAD"===e.method?null:kt(n(t.response),a),r))},c.onerror=function(t){a(Xt("error",t.status,r(t.response)||t.statusText,t.getAllResponseHeaders()))},c.onheaders=function(t){l(Xt("headers",t.status,null,t.getAllResponseHeaders()))},c.ontimeout=Ht(a),c.onprogress=s,c.onabort=u,c}},Kt=function(t,e,n,r,i,o,a,s,u,l,c){for(var f=[],d=c.chunkTransferId,p=c.chunkServer,h=c.chunkSize,g=c.chunkRetryDelays,v={serverId:d,aborted:!1},m=e.ondata||function(t){return t},E=e.onload||function(t,e){return"HEAD"===e?t.getResponseHeader("Upload-Offset"):t.response},_=e.onerror||function(t){return null},b=Math.floor(r.size/h),y=0;y<=b;y++){var T=y*h,I=r.slice(T,T+h,"application/offset+octet-stream");f[y]={index:y,size:I.size,offset:T,data:I,file:r,progress:0,retries:J(g),status:0,error:null,request:null,timeout:null}}var S,R,w,O,C=function(t){return 0===t.status||3===t.status},M=function(e){if(!v.aborted)if(e=e||f.find(C)){e.status=2,e.progress=null;var n=p.ondata||function(t){return t},i=p.onerror||function(t){return null},s=Zt(t,p.url,v.serverId),l="function"==typeof p.headers?p.headers(e):Object.assign({},p.headers,{"Content-Type":"application/offset+octet-stream","Upload-Offset":e.offset,"Upload-Length":r.size,"Upload-Name":r.name}),c=e.request=Wt(n(e.data),s,Object.assign({},p,{headers:l}));c.onload=function(){e.status=1,e.request=null,A()},c.onprogress=function(t,n,r){e.progress=t?n:null,x()},c.onerror=function(t){e.status=3,e.request=null,e.error=i(t.response)||t.statusText,D(e)||a(Xt("error",t.status,i(t.response)||t.statusText,t.getAllResponseHeaders()))},c.ontimeout=function(t){e.status=3,e.request=null,D(e)||Ht(a)(t)},c.onabort=function(){e.status=0,e.request=null,u()}}else f.every((function(t){return 1===t.status}))&&o(v.serverId)},D=function(t){return 0!==t.retries.length&&(t.status=4,clearTimeout(t.timeout),t.timeout=setTimeout((function(){M(t)}),t.retries.shift()),!0)},x=function(){var t=f.reduce((function(t,e){return null===t||null===e.progress?null:t+e.progress}),0);if(null===t)return s(!1,0,0);var e=f.reduce((function(t,e){return t+e.size}),0);s(!0,t,e)},A=function(){f.filter((function(t){return 2===t.status})).length>=1||M()};return v.serverId?(S=function(t){v.aborted||(f.filter((function(e){return e.offset<t})).forEach((function(t){t.status=1,t.progress=t.size})),A())},R=Zt(t,p.url,v.serverId),w={headers:"function"==typeof e.headers?e.headers(v.serverId):Object.assign({},e.headers),method:"HEAD"},(O=Wt(null,R,w)).onload=function(t){return S(E(t,w.method))},O.onerror=function(t){return a(Xt("error",t.status,_(t.response)||t.statusText,t.getAllResponseHeaders()))},O.ontimeout=Ht(a)):function(o){var s=new FormData;U(i)&&s.append(n,JSON.stringify(i));var u="function"==typeof e.headers?e.headers(r,i):Object.assign({},e.headers,{"Upload-Length":r.size}),l=Object.assign({},e,{headers:u}),c=Wt(m(s),Zt(t,e.url),l);c.onload=function(t){return o(E(t,l.method))},c.onerror=function(t){return a(Xt("error",t.status,_(t.response)||t.statusText,t.getAllResponseHeaders()))},c.ontimeout=Ht(a)}((function(t){v.aborted||(l(t),v.serverId=t,A())})),{abort:function(){v.aborted=!0,f.forEach((function(t){clearTimeout(t.timeout),t.request&&t.request.abort()}))}}},Jt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if("function"==typeof e)return e;if(!e||!P(e.url))return function(t,e){return e()};var n=e.onload||function(t){return t},r=e.onerror||function(t){return null};return function(i,o,a){var s=Wt(i,t+e.url,e);return s.onload=function(t){o(Xt("load",t.status,n(t.response),t.getAllResponseHeaders()))},s.onerror=function(t){a(Xt("error",t.status,r(t.response)||t.statusText,t.getAllResponseHeaders()))},s.ontimeout=Ht(a),s}},te=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t+Math.random()*(e-t)},ee=function(t){return t.substr(0,t.lastIndexOf("."))||t},ne=function(t){return!!(t instanceof File||t instanceof Blob&&t.name)},re=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=$(),o={archived:!1,frozen:!1,released:!1,source:null,file:r,serverFileReference:e,transferId:null,processingAborted:!1,status:e?st.PROCESSING_COMPLETE:st.INIT,activeLoader:null,activeProcessor:null},a=null,s={},u=function(t){return o.status=t},l=function(t){if(!o.released&&!o.frozen){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];f.fire.apply(f,[t].concat(n))}},c=function(t,e,n){var r=t.split("."),i=r[0],o=r.pop(),a=s;r.forEach((function(t){return a=a[t]})),JSON.stringify(a[o])!==JSON.stringify(e)&&(a[o]=e,l("metadata-update",{key:i,value:s[i],silent:n}))},f=Object.assign({id:{get:function(){return i}},origin:{get:function(){return t},set:function(e){return t=e}},serverId:{get:function(){return o.serverFileReference}},transferId:{get:function(){return o.transferId}},status:{get:function(){return o.status}},filename:{get:function(){return o.file.name}},filenameWithoutExtension:{get:function(){return ee(o.file.name)}},fileExtension:{get:function(){return Lt(o.file.name)}},fileType:{get:function(){return o.file.type}},fileSize:{get:function(){return o.file.size}},file:{get:function(){return o.file}},relativePath:{get:function(){return o.file._relativePath}},source:{get:function(){return o.source}},getMetadata:function(t){return function t(e){if(!U(e))return e;var n=O(e)?[]:{};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];n[r]=i&&U(i)?t(i):i}return n}(t?s[t]:s)},setMetadata:function(t,e,n){if(U(t)){var r=t;return Object.keys(r).forEach((function(t){c(t,r[t],e)})),t}return c(t,e,n),e},extend:function(t,e){return d[t]=e},abortLoad:function(){o.activeLoader?o.activeLoader.abort():(u(st.INIT),l("load-abort"))},retryLoad:function(){o.activeLoader&&o.activeLoader.load()},requestProcessing:function(){o.processingAborted=!1,u(st.PROCESSING_QUEUED)},abortProcessing:function(){return new Promise((function(t){if(!o.activeProcessor)return o.processingAborted=!0,u(st.IDLE),l("process-abort"),void t();a=function(){t()},o.activeProcessor.abort()}))},load:function(e,n,r){o.source=e,f.fireSync("init"),o.file?f.fireSync("load-skip"):(o.file=function(t){var e=[t.name,t.size,t.type];return t instanceof Blob||At(t)?e[0]=t.name||Gt():At(t)?(e[1]=t.length,e[2]=zt(t)):P(t)&&(e[0]=Pt(t),e[1]=0,e[2]="application/octet-stream"),{name:e[0],size:e[1],type:e[2]}}(e),n.on("init",(function(){l("load-init")})),n.on("meta",(function(e){o.file.size=e.size,o.file.filename=e.filename,e.source&&(t=ut.LIMBO,o.serverFileReference=e.source,o.status=st.PROCESSING_COMPLETE),l("load-meta")})),n.on("progress",(function(t){u(st.LOADING),l("load-progress",t)})),n.on("error",(function(t){u(st.LOAD_ERROR),l("load-request-error",t)})),n.on("abort",(function(){u(st.INIT),l("load-abort")})),n.on("load",(function(e){o.activeLoader=null;var n=function(e){o.file=ne(e)?e:o.file,t===ut.LIMBO&&o.serverFileReference?u(st.PROCESSING_COMPLETE):u(st.IDLE),l("load")};o.serverFileReference?n(e):r(e,n,(function(t){o.file=e,l("load-meta"),u(st.LOAD_ERROR),l("load-file-error",t)}))})),n.setSource(e),o.activeLoader=n,n.load())},process:function t(e,n){if(o.processingAborted)o.processingAborted=!1;else if(u(st.PROCESSING),a=null,o.file instanceof Blob){e.on("load",(function(t){o.transferId=null,o.serverFileReference=t})),e.on("transfer",(function(t){o.transferId=t})),e.on("load-perceived",(function(t){o.activeProcessor=null,o.transferId=null,o.serverFileReference=t,u(st.PROCESSING_COMPLETE),l("process-complete",t)})),e.on("start",(function(){l("process-start")})),e.on("error",(function(t){o.activeProcessor=null,u(st.PROCESSING_ERROR),l("process-error",t)})),e.on("abort",(function(t){o.activeProcessor=null,o.transferId=null,o.serverFileReference=t,u(st.IDLE),l("process-abort"),a&&a()})),e.on("progress",(function(t){l("process-progress",t)}));var r=console.error;n(o.file,(function(t){o.archived||e.process(t,Object.assign({},s))}),r),o.activeProcessor=e}else f.on("load",(function(){t(e,n)}))},revert:function(t,e){return new Promise((function(n,r){null!==o.serverFileReference?(t(o.serverFileReference,(function(){o.serverFileReference=null,n()}),(function(t){e?(u(st.PROCESSING_REVERT_ERROR),l("process-revert-error"),r(t)):n()})),u(st.IDLE),l("process-revert")):n()}))}},rt(),{freeze:function(){return o.frozen=!0},release:function(){return o.released=!0},released:{get:function(){return o.released}},archive:function(){return o.archived=!0},archived:{get:function(){return o.archived}}}),d=n(f);return d},ie=function(t,e){var n=function(t,e){return C(e)?0:P(e)?t.findIndex((function(t){return t.id===e})):-1}(t,e);if(!(n<0))return t[n]||null},oe=function(t,e,n,r,i,o){var a=Wt(null,t,{method:"GET",responseType:"blob"});return a.onload=function(n){var r=n.getAllResponseHeaders(),i=Vt(r).name||Pt(t);e(Xt("load",n.status,kt(n.response,i),r))},a.onerror=function(t){n(Xt("error",t.status,t.statusText,t.getAllResponseHeaders()))},a.onheaders=function(t){o(Xt("headers",t.status,null,t.getAllResponseHeaders()))},a.ontimeout=Ht(n),a.onprogress=r,a.onabort=i,a},ae=function(t){return 0===t.indexOf("//")&&(t=location.protocol+t),t.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]},se=function(t){return function(){return z(t)?t.apply(void 0,arguments):t}},ue=function(t,e){clearTimeout(e.listUpdateTimeout),e.listUpdateTimeout=setTimeout((function(){t("DID_UPDATE_ITEMS",{items:bt(e.items)})}),0)},le=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new Promise((function(e){if(!t)return e(!0);var r=t.apply(void 0,n);return null==r?e(!0):"boolean"==typeof r?e(r):void("function"==typeof r.then&&r.then(e))}))},ce=function(t,e){t.items.sort((function(t,n){return e(at(t),at(n))}))},fe=function(t,e){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.query,i=n.success,o=void 0===i?function(){}:i,a=n.failure,s=void 0===a?function(){}:a,u=K(n,["query","success","failure"]),l=Et(t.items,r);l?e(l,o,s,u||{}):s({error:Xt("error",0,"Item not found"),file:null})}},de=function(t,n,r){return{ABORT_ALL:function(){bt(r.items).forEach((function(t){t.freeze(),t.abortLoad(),t.abortProcessing()}))},DID_SET_FILES:function(e){var n=e.value,i=(void 0===n?[]:n).map((function(t){return{source:t.source?t.source:t,options:t.options}})),o=bt(r.items);o.forEach((function(e){i.find((function(t){return t.source===e.source||t.source===e.file}))||t("REMOVE_ITEM",{query:e,remove:!1})})),o=bt(r.items),i.forEach((function(e,n){o.find((function(t){return t.source===e.source||t.file===e.source}))||t("ADD_ITEM",Object.assign({},e,{interactionMethod:5,index:n}))}))},DID_UPDATE_ITEM_METADATA:function(e){var i=e.id,o=e.action,a=e.change;a.silent||(clearTimeout(r.itemUpdateTimeout),r.itemUpdateTimeout=setTimeout((function(){var e=ie(r.items,i);if(n("IS_ASYNC")){e.origin===ut.LOCAL&&t("DID_LOAD_ITEM",{id:e.id,error:null,serverFileReference:e.source});var s,u=function(){setTimeout((function(){t("REQUEST_ITEM_PROCESSING",{query:i})}),32)};return e.status===st.PROCESSING_COMPLETE?(s=r.options.instantUpload,void e.revert(Jt(r.options.server.url,r.options.server.revert),n("GET_FORCE_REVERT")).then(s?u:function(){}).catch((function(){}))):e.status===st.PROCESSING?function(t){e.abortProcessing().then(t?u:function(){})}(r.options.instantUpload):void(r.options.instantUpload&&u())}pt("SHOULD_PREPARE_OUTPUT",!1,{item:e,query:n,action:o,change:a}).then((function(r){var o=n("GET_BEFORE_PREPARE_FILE");o&&(r=o(e,r)),r&&t("REQUEST_PREPARE_OUTPUT",{query:i,item:e,success:function(e){t("DID_PREPARE_OUTPUT",{id:i,file:e})}},!0)}))}),0))},MOVE_ITEM:function(t){var e=t.query,n=t.index,i=Et(r.items,e);if(i){var o=r.items.indexOf(i);o!==(n=xt(n,0,r.items.length-1))&&r.items.splice(n,0,r.items.splice(o,1)[0])}},SORT:function(e){var i=e.compare;ce(r,i),t("DID_SORT_ITEMS",{items:n("GET_ACTIVE_ITEMS")})},ADD_ITEMS:function(e){var r=e.items,i=e.index,o=e.interactionMethod,a=e.success,s=void 0===a?function(){}:a,u=e.failure,l=void 0===u?function(){}:u,c=i;if(-1===i||void 0===i){var f=n("GET_ITEM_INSERT_LOCATION"),d=n("GET_TOTAL_ITEMS");c="before"===f?0:d}var p=n("GET_IGNORED_FILES"),h=r.filter((function(t){return ne(t)?!p.includes(t.name.toLowerCase()):!C(t)})).map((function(e){return new Promise((function(n,r){t("ADD_ITEM",{interactionMethod:o,source:e.source||e,success:n,failure:r,index:c++,options:e.options||{}})}))}));Promise.all(h).then(s).catch(l)},ADD_ITEM:function(e){var i=e.source,o=e.index,a=void 0===o?-1:o,s=e.interactionMethod,u=e.success,l=void 0===u?function(){}:u,c=e.failure,f=void 0===c?function(){}:c,d=e.options,p=void 0===d?{}:d;if(C(i))f({error:Xt("error",0,"No source"),file:null});else if(!ne(i)||!r.options.ignoredFiles.includes(i.name.toLowerCase())){if(!function(t){var e=bt(t.items).length;if(!t.options.allowMultiple)return 0===e;var n=t.options.maxFiles;return null===n||e<n}(r)){if(r.options.allowMultiple||!r.options.allowMultiple&&!r.options.allowReplace){var h=Xt("warning",0,"Max files");return t("DID_THROW_MAX_FILES",{source:i,error:h}),void f({error:h,file:null})}var g=bt(r.items)[0];if(g.status===st.PROCESSING_COMPLETE||g.status===st.PROCESSING_REVERT_ERROR){var v=n("GET_FORCE_REVERT");if(g.revert(Jt(r.options.server.url,r.options.server.revert),v).then((function(){v&&t("ADD_ITEM",{source:i,index:a,interactionMethod:s,success:l,failure:f,options:p})})).catch((function(){})),v)return}t("REMOVE_ITEM",{query:g.id})}var m="local"===p.type?ut.LOCAL:"limbo"===p.type?ut.LIMBO:ut.INPUT,E=re(m,m===ut.INPUT?null:i,p.file);Object.keys(p.metadata||{}).forEach((function(t){E.setMetadata(t,p.metadata[t])})),ht("DID_CREATE_ITEM",E,{query:n,dispatch:t});var _=n("GET_ITEM_INSERT_LOCATION");r.options.itemInsertLocationFreedom||(a="before"===_?-1:r.items.length),function(t,e,n){C(e)||(void 0===n?t.push(e):function(t,e,n){t.splice(e,0,n)}(t,n=xt(n,0,t.length),e))}(r.items,E,a),z(_)&&i&&ce(r,_);var b=E.id;E.on("init",(function(){t("DID_INIT_ITEM",{id:b})})),E.on("load-init",(function(){t("DID_START_ITEM_LOAD",{id:b})})),E.on("load-meta",(function(){t("DID_UPDATE_ITEM_META",{id:b})})),E.on("load-progress",(function(e){t("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:b,progress:e})})),E.on("load-request-error",(function(e){var n=se(r.options.labelFileLoadError)(e);if(e.code>=400&&e.code<500)return t("DID_THROW_ITEM_INVALID",{id:b,error:e,status:{main:n,sub:e.code+" ("+e.body+")"}}),void f({error:e,file:at(E)});t("DID_THROW_ITEM_LOAD_ERROR",{id:b,error:e,status:{main:n,sub:r.options.labelTapToRetry}})})),E.on("load-file-error",(function(e){t("DID_THROW_ITEM_INVALID",{id:b,error:e.status,status:e.status}),f({error:e.status,file:at(E)})})),E.on("load-abort",(function(){t("REMOVE_ITEM",{query:b})})),E.on("load-skip",(function(){t("COMPLETE_LOAD_ITEM",{query:b,item:E,data:{source:i,success:l}})})),E.on("load",(function(){var e=function(e){e?(E.on("metadata-update",(function(e){t("DID_UPDATE_ITEM_METADATA",{id:b,change:e})})),pt("SHOULD_PREPARE_OUTPUT",!1,{item:E,query:n}).then((function(e){var o=n("GET_BEFORE_PREPARE_FILE");o&&(e=o(E,e));var a=function(){t("COMPLETE_LOAD_ITEM",{query:b,item:E,data:{source:i,success:l}}),ue(t,r)};e?t("REQUEST_PREPARE_OUTPUT",{query:b,item:E,success:function(e){t("DID_PREPARE_OUTPUT",{id:b,file:e}),a()}},!0):a()}))):t("REMOVE_ITEM",{query:b})};pt("DID_LOAD_ITEM",E,{query:n,dispatch:t}).then((function(){le(n("GET_BEFORE_ADD_FILE"),at(E)).then(e)})).catch((function(){e(!1)}))})),E.on("process-start",(function(){t("DID_START_ITEM_PROCESSING",{id:b})})),E.on("process-progress",(function(e){t("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:b,progress:e})})),E.on("process-error",(function(e){t("DID_THROW_ITEM_PROCESSING_ERROR",{id:b,error:e,status:{main:se(r.options.labelFileProcessingError)(e),sub:r.options.labelTapToRetry}})})),E.on("process-revert-error",(function(e){t("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:b,error:e,status:{main:se(r.options.labelFileProcessingRevertError)(e),sub:r.options.labelTapToRetry}})})),E.on("process-complete",(function(e){t("DID_COMPLETE_ITEM_PROCESSING",{id:b,error:null,serverFileReference:e}),t("DID_DEFINE_VALUE",{id:b,value:e})})),E.on("process-abort",(function(){t("DID_ABORT_ITEM_PROCESSING",{id:b})})),E.on("process-revert",(function(){t("DID_REVERT_ITEM_PROCESSING",{id:b}),t("DID_DEFINE_VALUE",{id:b,value:null})})),t("DID_ADD_ITEM",{id:b,index:a,interactionMethod:s}),ue(t,r);var y=r.options.server||{},T=y.url,I=y.load,S=y.restore,R=y.fetch;E.load(i,Yt(m===ut.INPUT?P(i)&&function(t){return(t.indexOf(":")>-1||t.indexOf("//")>-1)&&ae(location.href)!==ae(t)}(i)&&R?Qt(T,R):oe:Qt(T,m===ut.LIMBO?S:I)),(function(t,e,r){pt("LOAD_FILE",t,{query:n}).then(e).catch(r)}))}},REQUEST_PREPARE_OUTPUT:function(t){var e=t.item,r=t.success,i=t.failure,o=void 0===i?function(){}:i,a={error:Xt("error",0,"Item not found"),file:null};if(e.archived)return o(a);pt("PREPARE_OUTPUT",e.file,{query:n,item:e}).then((function(t){pt("COMPLETE_PREPARE_OUTPUT",t,{query:n,item:e}).then((function(t){if(e.archived)return o(a);r(t)}))}))},COMPLETE_LOAD_ITEM:function(e){var i=e.item,o=e.data,a=o.success,s=o.source,u=n("GET_ITEM_INSERT_LOCATION");if(z(u)&&s&&ce(r,u),t("DID_LOAD_ITEM",{id:i.id,error:null,serverFileReference:i.origin===ut.INPUT?null:s}),a(at(i)),i.origin!==ut.LOCAL)return i.origin===ut.LIMBO?(t("DID_COMPLETE_ITEM_PROCESSING",{id:i.id,error:null,serverFileReference:s}),void t("DID_DEFINE_VALUE",{id:i.id,value:i.serverId||s})):void(n("IS_ASYNC")&&r.options.instantUpload&&t("REQUEST_ITEM_PROCESSING",{query:i.id}));t("DID_LOAD_LOCAL_ITEM",{id:i.id})},RETRY_ITEM_LOAD:fe(r,(function(t){t.retryLoad()})),REQUEST_ITEM_PREPARE:fe(r,(function(e,n,r){t("REQUEST_PREPARE_OUTPUT",{query:e.id,item:e,success:function(r){t("DID_PREPARE_OUTPUT",{id:e.id,file:r}),n({file:e,output:r})},failure:r},!0)})),REQUEST_ITEM_PROCESSING:fe(r,(function(e,i,o){if(e.status===st.IDLE||e.status===st.PROCESSING_ERROR)e.status!==st.PROCESSING_QUEUED&&(e.requestProcessing(),t("DID_REQUEST_ITEM_PROCESSING",{id:e.id}),t("PROCESS_ITEM",{query:e,success:i,failure:o},!0));else{var a=function(){return t("REQUEST_ITEM_PROCESSING",{query:e,success:i,failure:o})},s=function(){return document.hidden?a():setTimeout(a,32)};e.status===st.PROCESSING_COMPLETE||e.status===st.PROCESSING_REVERT_ERROR?e.revert(Jt(r.options.server.url,r.options.server.revert),n("GET_FORCE_REVERT")).then(s).catch((function(){})):e.status===st.PROCESSING&&e.abortProcessing().then(s)}})),PROCESS_ITEM:fe(r,(function(e,i,o){var a=n("GET_MAX_PARALLEL_UPLOADS");if(n("GET_ITEMS_BY_STATUS",st.PROCESSING).length!==a){if(e.status!==st.PROCESSING){var s=function e(){var n=r.processingQueue.shift();if(n){var i=n.id,o=n.success,a=n.failure,s=Et(r.items,i);s&&!s.archived?t("PROCESS_ITEM",{query:i,success:o,failure:a},!0):e()}};e.onOnce("process-complete",(function(){i(at(e)),s();var o=r.options.server;if(r.options.instantUpload&&e.origin===ut.LOCAL&&z(o.remove)){var a=function(){};e.origin=ut.LIMBO,r.options.server.remove(e.source,a,a)}n("GET_ITEMS_BY_STATUS",st.PROCESSING_COMPLETE).length===r.items.length&&t("DID_COMPLETE_ITEM_PROCESSING_ALL")})),e.onOnce("process-error",(function(t){o({error:t,file:at(e)}),s()}));var u=r.options;e.process(function(t,e){var n={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},r=e.allowMinimumUploadDuration,i=function(){n.request&&(n.perceivedPerformanceUpdater.clear(),n.request.abort&&n.request.abort(),n.complete=!0)},o=r?function(){return n.progress?Math.min(n.progress,n.perceivedProgress):null}:function(){return n.progress||null},a=r?function(){return Math.min(n.duration,n.perceivedDuration)}:function(){return n.duration},s=Object.assign({},rt(),{process:function(e,i){var o=function(){0!==n.duration&&null!==n.progress&&s.fire("progress",s.getProgress())},a=function(){n.complete=!0,s.fire("load-perceived",n.response.body)};s.fire("start"),n.timestamp=Date.now(),n.perceivedPerformanceUpdater=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:250,i=null,o=Date.now();return e>0&&function a(){var s=Date.now()-o,u=te(n,r);s+u>e&&(u=s+u-e);var l=s/e;l>=1||document.hidden?t(1):(t(l),i=setTimeout(a,u))}(),{clear:function(){clearTimeout(i)}}}((function(t){n.perceivedProgress=t,n.perceivedDuration=Date.now()-n.timestamp,o(),n.response&&1===n.perceivedProgress&&!n.complete&&a()}),r?te(750,1500):0),n.request=t(e,i,(function(t){n.response=U(t)?t:{type:"load",code:200,body:""+t,headers:{}},n.duration=Date.now()-n.timestamp,n.progress=1,s.fire("load",n.response.body),(!r||r&&1===n.perceivedProgress)&&a()}),(function(t){n.perceivedPerformanceUpdater.clear(),s.fire("error",U(t)?t:{type:"error",code:0,body:""+t})}),(function(t,e,r){n.duration=Date.now()-n.timestamp,n.progress=t?e/r:null,o()}),(function(){n.perceivedPerformanceUpdater.clear(),s.fire("abort",n.response?n.response.body:null)}),(function(t){s.fire("transfer",t)}))},abort:i,getProgress:o,getDuration:a,reset:function(){i(),n.complete=!1,n.perceivedProgress=0,n.progress=0,n.timestamp=null,n.perceivedDuration=0,n.duration=0,n.request=null,n.response=null}});return s}(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return"function"==typeof e?function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.apply(void 0,[n].concat(i,[r]))}:e&&P(e.url)?function(t,e,n,r){return function(i,o,a,s,u,l,c){if(i){var f=r.chunkUploads,d=f&&i.size>r.chunkSize,p=f&&(d||r.chunkForce);if(i instanceof Blob&&p)return Kt(t,e,n,i,o,a,s,u,l,c,r);var h=e.ondata||function(t){return t},g=e.onload||function(t){return t},v=e.onerror||function(t){return null},m="function"==typeof e.headers?e.headers(i,o)||{}:Object.assign({},e.headers),E=Object.assign({},e,{headers:m}),_=new FormData;U(o)&&_.append(n,JSON.stringify(o)),(i instanceof Blob?[{name:null,file:i}]:i).forEach((function(t){_.append(n,t.file,null===t.name?t.file.name:""+t.name+t.file.name)}));var b=Wt(h(_),Zt(t,e.url),E);return b.onload=function(t){a(Xt("load",t.status,g(t.response),t.getAllResponseHeaders()))},b.onerror=function(t){s(Xt("error",t.status,v(t.response)||t.statusText,t.getAllResponseHeaders()))},b.ontimeout=Ht(s),b.onprogress=u,b.onabort=l,b}}}(t,e,n,r):null}(u.server.url,u.server.process,u.name,{chunkTransferId:e.transferId,chunkServer:u.server.patch,chunkUploads:u.chunkUploads,chunkForce:u.chunkForce,chunkSize:u.chunkSize,chunkRetryDelays:u.chunkRetryDelays}),{allowMinimumUploadDuration:n("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(function(r,i,o){pt("PREPARE_OUTPUT",r,{query:n,item:e}).then((function(n){t("DID_PREPARE_OUTPUT",{id:e.id,file:n}),i(n)})).catch(o)}))}}else r.processingQueue.push({id:e.id,success:i,failure:o})})),RETRY_ITEM_PROCESSING:fe(r,(function(e){t("REQUEST_ITEM_PROCESSING",{query:e})})),REQUEST_REMOVE_ITEM:fe(r,(function(e){le(n("GET_BEFORE_REMOVE_FILE"),at(e)).then((function(n){n&&t("REMOVE_ITEM",{query:e})}))})),RELEASE_ITEM:fe(r,(function(t){t.release()})),REMOVE_ITEM:fe(r,(function(e,i,o,a){var s=function(){var n=e.id;ie(r.items,n).archive(),t("DID_REMOVE_ITEM",{error:null,id:n,item:e}),ue(t,r),i(at(e))},u=r.options.server;e.origin===ut.LOCAL&&u&&z(u.remove)&&!1!==a.remove?(t("DID_START_ITEM_REMOVE",{id:e.id}),u.remove(e.source,(function(){return s()}),(function(n){t("DID_THROW_ITEM_REMOVE_ERROR",{id:e.id,error:Xt("error",0,n,null),status:{main:se(r.options.labelFileRemoveError)(n),sub:r.options.labelTapToRetry}})}))):(a.revert&&e.origin!==ut.LOCAL&&null!==e.serverId&&e.revert(Jt(r.options.server.url,r.options.server.revert),n("GET_FORCE_REVERT")),s())})),ABORT_ITEM_LOAD:fe(r,(function(t){t.abortLoad()})),ABORT_ITEM_PROCESSING:fe(r,(function(e){e.serverId?t("REVERT_ITEM_PROCESSING",{id:e.id}):e.abortProcessing().then((function(){r.options.instantUpload&&t("REMOVE_ITEM",{query:e.id})}))})),REQUEST_REVERT_ITEM_PROCESSING:fe(r,(function(e){if(r.options.instantUpload){var i=function(n){n&&t("REVERT_ITEM_PROCESSING",{query:e})},o=n("GET_BEFORE_REMOVE_FILE");if(!o)return i(!0);var a=o(at(e));return null==a?i(!0):"boolean"==typeof a?i(a):void("function"==typeof a.then&&a.then(i))}t("REVERT_ITEM_PROCESSING",{query:e})})),REVERT_ITEM_PROCESSING:fe(r,(function(e){e.revert(Jt(r.options.server.url,r.options.server.revert),n("GET_FORCE_REVERT")).then((function(){(r.options.instantUpload||function(t){return!ne(t.file)}(e))&&t("REMOVE_ITEM",{query:e.id})})).catch((function(){}))})),SET_OPTIONS:function(n){var r=n.options;e(r,(function(e,n){t("SET_"+W(e,"_").toUpperCase(),{value:n})}))}}},pe=function(t){return document.createElement(t)},he=function(t,e){var n=t.childNodes[0];n?e!==n.nodeValue&&(n.nodeValue=e):(n=document.createTextNode(e),t.appendChild(n))},ge=function(t,e,n,r){var i=(r%360-90)*Math.PI/180;return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}},ve=I({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:function(t){var e=t.root,n=t.props;n.spin=!1,n.progress=0,n.opacity=0;var r=a("svg");e.ref.path=a("path",{"stroke-width":2,"stroke-linecap":"round"}),r.appendChild(e.ref.path),e.ref.svg=r,e.appendChild(r)},write:function(t){var e=t.root,n=t.props;if(0!==n.opacity){n.align&&(e.element.dataset.align=n.align);var i=parseInt(r(e.ref.path,"stroke-width"),10),o=.5*e.rect.element.width,a=0,s=0;n.spin?(a=0,s=.5):(a=0,s=n.progress);var u=function(t,e,n,r,i){var o=1;return i>r&&i-r<=.5&&(o=0),r>i&&r-i>=.5&&(o=0),function(t,e,n,r,i,o){var a=ge(t,e,n,i),s=ge(t,e,n,r);return["M",a.x,a.y,"A",n,n,0,o,0,s.x,s.y].join(" ")}(t,e,n,360*Math.min(.9999,r),360*Math.min(.9999,i),o)}(o,o,o-i,a,s);r(e.ref.path,"d",u),r(e.ref.path,"stroke-opacity",n.spin||n.progress>0?1:0)}},mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),me=I({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:function(t){var e=t.root,n=t.props;e.element.innerHTML=(n.icon||"")+"<span>"+n.label+"</span>",n.isDisabled=!1},write:function(t){var e=t.root,n=t.props,i=n.isDisabled,o=e.query("GET_DISABLED")||0===n.opacity;o&&!i?(n.isDisabled=!0,r(e.element,"disabled","disabled")):!o&&i&&(n.isDisabled=!1,e.element.removeAttribute("disabled"))}}),Ee=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=n,i=n*n,o=n*n*n;return(t=Math.round(Math.abs(t)))<r?t+" bytes":t<i?Math.floor(t/r)+" KB":t<o?_e(t/i,1,e)+" MB":_e(t/o,2,e)+" GB"},_e=function(t,e,n){return t.toFixed(e).split(".").filter((function(t){return"0"!==t})).join(n)},be=function(t){var e=t.root,n=t.props;he(e.ref.fileSize,Ee(e.query("GET_ITEM_SIZE",n.id),".",e.query("GET_FILE_SIZE_BASE"))),he(e.ref.fileName,e.query("GET_ITEM_NAME",n.id))},ye=function(t){var e=t.root,n=t.props;k(e.query("GET_ITEM_SIZE",n.id))||he(e.ref.fileSize,e.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},Te=I({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:S({DID_LOAD_ITEM:be,DID_UPDATE_ITEM_META:be,DID_THROW_ITEM_LOAD_ERROR:ye,DID_THROW_ITEM_INVALID:ye}),didCreateView:function(t){ht("CREATE_VIEW",Object.assign({},t,{view:t}))},create:function(t){var e=t.root,n=t.props,i=pe("span");i.className="filepond--file-info-main",r(i,"aria-hidden","true"),e.appendChild(i),e.ref.fileName=i;var o=pe("span");o.className="filepond--file-info-sub",e.appendChild(o),e.ref.fileSize=o,he(o,e.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),he(i,e.query("GET_ITEM_NAME",n.id))},mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),Ie=function(t){return Math.round(100*t)},Se=function(t){var e=t.root,n=t.action,r=null===n.progress?e.query("GET_LABEL_FILE_LOADING"):e.query("GET_LABEL_FILE_LOADING")+" "+Ie(n.progress)+"%";he(e.ref.main,r),he(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Re=function(t){var e=t.root;he(e.ref.main,""),he(e.ref.sub,"")},we=function(t){var e=t.root,n=t.action;he(e.ref.main,n.status.main),he(e.ref.sub,n.status.sub)},Oe=I({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:S({DID_LOAD_ITEM:Re,DID_REVERT_ITEM_PROCESSING:Re,DID_REQUEST_ITEM_PROCESSING:function(t){var e=t.root;he(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING")),he(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},DID_ABORT_ITEM_PROCESSING:function(t){var e=t.root;he(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_ABORTED")),he(e.ref.sub,e.query("GET_LABEL_TAP_TO_RETRY"))},DID_COMPLETE_ITEM_PROCESSING:function(t){var e=t.root;he(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),he(e.ref.sub,e.query("GET_LABEL_TAP_TO_UNDO"))},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(t){var e=t.root,n=t.action,r=null===n.progress?e.query("GET_LABEL_FILE_PROCESSING"):e.query("GET_LABEL_FILE_PROCESSING")+" "+Ie(n.progress)+"%";he(e.ref.main,r),he(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},DID_UPDATE_ITEM_LOAD_PROGRESS:Se,DID_THROW_ITEM_LOAD_ERROR:we,DID_THROW_ITEM_INVALID:we,DID_THROW_ITEM_PROCESSING_ERROR:we,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:we,DID_THROW_ITEM_REMOVE_ERROR:we}),didCreateView:function(t){ht("CREATE_VIEW",Object.assign({},t,{view:t}))},create:function(t){var e=t.root,n=pe("span");n.className="filepond--file-status-main",e.appendChild(n),e.ref.main=n;var r=pe("span");r.className="filepond--file-status-sub",e.appendChild(r),e.ref.sub=r,Se({root:e,action:{progress:null}})},mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),Ce={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},Me=[];e(Ce,(function(t){Me.push(t)}));var De,xe=function(t){if("right"===Ne(t))return 0;var e=t.ref.buttonRemoveItem.rect.element;return e.hidden?null:e.width+e.left},Ae=function(t){return t.ref.buttonAbortItemLoad.rect.element.width},Pe=function(t){return Math.floor(t.ref.buttonRemoveItem.rect.element.height/4)},Le=function(t){return Math.floor(t.ref.buttonRemoveItem.rect.element.left/2)},Ne=function(t){return t.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION")},Ge={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:function(t){return t.query("GET_STYLE_LOAD_INDICATOR_POSITION")}},processProgressIndicator:{opacity:0,align:function(t){return t.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},ke={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:xe},status:{translateX:xe}},Be={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},ze={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:xe},status:{translateX:xe,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:xe},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:Ne},info:{translateX:xe},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:Ne},buttonRemoveItem:{opacity:1},info:{translateX:xe},status:{opacity:1,translateX:xe}},DID_LOAD_ITEM:ke,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:xe},status:{translateX:xe}},DID_START_ITEM_PROCESSING:Be,DID_REQUEST_ITEM_PROCESSING:Be,DID_UPDATE_ITEM_PROCESS_PROGRESS:Be,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:xe}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:xe},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:ke},Fe=I({create:function(t){var e=t.root;e.element.innerHTML=e.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),Ue=S({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function(t){var e=t.root,n=t.action;e.ref.buttonAbortItemProcessing.label=n.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function(t){var e=t.root,n=t.action;e.ref.buttonAbortItemLoad.label=n.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function(t){var e=t.root,n=t.action;e.ref.buttonAbortItemRemoval.label=n.value},DID_REQUEST_ITEM_PROCESSING:function(t){var e=t.root;e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:function(t){var e=t.root;e.ref.loadProgressIndicator.spin=!0,e.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:function(t){var e=t.root;e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:function(t){var e=t.root,n=t.action;e.ref.loadProgressIndicator.spin=!1,e.ref.loadProgressIndicator.progress=n.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(t){var e=t.root,n=t.action;e.ref.processProgressIndicator.spin=!1,e.ref.processProgressIndicator.progress=n.progress}}),qe=I({create:function(t){var n,r=t.root,i=t.props,o=Object.keys(Ce).reduce((function(t,e){return t[e]=Object.assign({},Ce[e]),t}),{}),a=i.id,s=r.query("GET_ALLOW_REVERT"),u=r.query("GET_ALLOW_REMOVE"),l=r.query("GET_ALLOW_PROCESS"),c=r.query("GET_INSTANT_UPLOAD"),f=r.query("IS_ASYNC"),d=r.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");f?l&&!s?n=function(t){return!/RevertItemProcessing/.test(t)}:!l&&s?n=function(t){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(t)}:l||s||(n=function(t){return!/Process/.test(t)}):n=function(t){return!/Process/.test(t)};var p=n?Me.filter(n):Me.concat();if(c&&s&&(o.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",o.RevertItemProcessing.icon="GET_ICON_REMOVE"),f&&!s){var h=ze.DID_COMPLETE_ITEM_PROCESSING;h.info.translateX=Le,h.info.translateY=Pe,h.status.translateY=Pe,h.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(f&&!l&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach((function(t){ze[t].status.translateY=Pe})),ze.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=Ae),d&&s){o.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";var g=ze.DID_COMPLETE_ITEM_PROCESSING;g.info.translateX=xe,g.status.translateY=Pe,g.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}u||(o.RemoveItem.disabled=!0),e(o,(function(t,e){var n=r.createChildView(me,{label:r.query(e.label),icon:r.query(e.icon),opacity:0});p.includes(t)&&r.appendChildView(n),e.disabled&&(n.element.setAttribute("disabled","disabled"),n.element.setAttribute("hidden","hidden")),n.element.dataset.align=r.query("GET_STYLE_"+e.align),n.element.classList.add(e.className),n.on("click",(function(t){t.stopPropagation(),e.disabled||r.dispatch(e.action,{query:a})})),r.ref["button"+t]=n})),r.ref.processingCompleteIndicator=r.appendChildView(r.createChildView(Fe)),r.ref.processingCompleteIndicator.element.dataset.align=r.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),r.ref.info=r.appendChildView(r.createChildView(Te,{id:a})),r.ref.status=r.appendChildView(r.createChildView(Oe,{id:a}));var v=r.appendChildView(r.createChildView(ve,{opacity:0,align:r.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));v.element.classList.add("filepond--load-indicator"),r.ref.loadProgressIndicator=v;var m=r.appendChildView(r.createChildView(ve,{opacity:0,align:r.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));m.element.classList.add("filepond--process-indicator"),r.ref.processProgressIndicator=m,r.ref.activeStyles=[]},write:function(t){var n=t.root,r=t.actions,i=t.props;Ue({root:n,actions:r,props:i});var o=r.concat().filter((function(t){return/^DID_/.test(t.type)})).reverse().find((function(t){return ze[t.type]}));if(o){n.ref.activeStyles=[];var a=ze[o.type];e(Ge,(function(t,r){var i=n.ref[t];e(r,(function(e,r){var o=a[t]&&void 0!==a[t][e]?a[t][e]:r;n.ref.activeStyles.push({control:i,key:e,value:o})}))}))}n.ref.activeStyles.forEach((function(t){var e=t.control,r=t.key,i=t.value;e[r]="function"==typeof i?i(n):i}))},didCreateView:function(t){ht("CREATE_VIEW",Object.assign({},t,{view:t}))},name:"file"}),Ve=I({create:function(t){var e=t.root,n=t.props;e.ref.fileName=pe("legend"),e.appendChild(e.ref.fileName),e.ref.file=e.appendChildView(e.createChildView(qe,{id:n.id})),e.ref.data=!1},ignoreRect:!0,write:S({DID_LOAD_ITEM:function(t){var e=t.root,n=t.props;he(e.ref.fileName,e.query("GET_ITEM_NAME",n.id))}}),didCreateView:function(t){ht("CREATE_VIEW",Object.assign({},t,{view:t}))},tag:"fieldset",name:"file-wrapper"}),Ye={type:"spring",damping:.6,mass:7},je=I({name:"panel",read:function(t){var e=t.root;return t.props.heightCurrent=e.ref.bottom.translateY},write:function(t){var e=t.root,n=t.props;if(null!==e.ref.scalable&&n.scalable===e.ref.scalable||(e.ref.scalable=!x(n.scalable)||n.scalable,e.element.dataset.scalable=e.ref.scalable),n.height){var r=e.ref.top.rect.element,i=e.ref.bottom.rect.element,o=Math.max(r.height+i.height,n.height);e.ref.center.translateY=r.height,e.ref.center.scaleY=(o-r.height-i.height)/100,e.ref.bottom.translateY=o-i.height}},create:function(t){var e=t.root,n=t.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:Ye},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:Ye},styles:["translateY"]}}].forEach((function(t){!function(t,e,n){var r=I({name:"panel-"+e.name+" filepond--"+n,mixins:e.mixins,ignoreRectUpdate:!0}),i=t.createChildView(r,e.props);t.ref[e.name]=t.appendChildView(i)}(e,t,n.name)})),e.element.classList.add("filepond--"+n.name),e.ref.scalable=null},ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),We={type:"spring",stiffness:.75,damping:.45,mass:10},Xe={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},He=S({DID_UPDATE_PANEL_HEIGHT:function(t){var e=t.root,n=t.action;e.height=n.height}}),$e=S({DID_GRAB_ITEM:function(t){var e=t.root;t.props.dragOrigin={x:e.translateX,y:e.translateY}},DID_DRAG_ITEM:function(t){t.root.element.dataset.dragState="drag"},DID_DROP_ITEM:function(t){var e=t.root,n=t.props;n.dragOffset=null,n.dragOrigin=null,e.element.dataset.dragState="drop"}},(function(t){var e=t.root,n=t.actions,r=t.props,i=t.shouldOptimize;"drop"===e.element.dataset.dragState&&e.scaleX<=1&&(e.element.dataset.dragState="idle");var o=n.concat().filter((function(t){return/^DID_/.test(t.type)})).reverse().find((function(t){return Xe[t.type]}));o&&o.type!==r.currentState&&(r.currentState=o.type,e.element.dataset.filepondItemState=Xe[r.currentState]||"");var a=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");a?i||(e.height=e.rect.element.width*a):(He({root:e,actions:n,props:r}),!e.height&&e.ref.container.rect.element.height>0&&(e.height=e.ref.container.rect.element.height)),i&&(e.ref.panel.height=null),e.ref.panel.height=e.height})),Ze=I({create:function(t){var e=t.root,n=t.props;e.ref.handleClick=function(t){return e.dispatch("DID_ACTIVATE_ITEM",{id:n.id})},e.element.id="filepond--item-"+n.id,e.element.addEventListener("click",e.ref.handleClick),e.ref.container=e.appendChildView(e.createChildView(Ve,{id:n.id})),e.ref.panel=e.appendChildView(e.createChildView(je,{name:"item-panel"})),e.ref.panel.height=null,n.markedForRemoval=!1,e.query("GET_ALLOW_REORDER")&&(e.element.dataset.dragState="idle",e.element.addEventListener("pointerdown",(function(t){if(t.isPrimary){var r=!1,i=t.pageX,o=t.pageY;n.dragOrigin={x:e.translateX,y:e.translateY},n.dragCenter={x:t.offsetX,y:t.offsetY};var a,s,u,l=(a=e.query("GET_ACTIVE_ITEMS"),s=a.map((function(t){return t.id})),u=void 0,{setIndex:function(t){u=t},getIndex:function(){return u},getItemIndex:function(t){return s.indexOf(t.id)}});e.dispatch("DID_GRAB_ITEM",{id:n.id,dragState:l});var c=function(t){t.isPrimary&&(t.stopPropagation(),t.preventDefault(),n.dragOffset={x:t.pageX-i,y:t.pageY-o},n.dragOffset.x*n.dragOffset.x+n.dragOffset.y*n.dragOffset.y>16&&!r&&(r=!0,e.element.removeEventListener("click",e.ref.handleClick)),e.dispatch("DID_DRAG_ITEM",{id:n.id,dragState:l}))};document.addEventListener("pointermove",c),document.addEventListener("pointerup",(function t(a){a.isPrimary&&(document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",t),n.dragOffset={x:a.pageX-i,y:a.pageY-o},e.dispatch("DID_DROP_ITEM",{id:n.id,dragState:l}),r&&setTimeout((function(){return e.element.addEventListener("click",e.ref.handleClick)}),0))}))}})))},write:$e,destroy:function(t){var e=t.root,n=t.props;e.element.removeEventListener("click",e.ref.handleClick),e.dispatch("RELEASE_ITEM",{query:n.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:"spring",scaleY:"spring",translateX:We,translateY:We,opacity:{type:"tween",duration:150}}}}),Qe=function(t,e){return Math.max(1,Math.floor((t+1)/e))},Ke=function(t,e,n){if(n){var r=t.rect.element.width,i=e.length,o=null;if(0===i||n.top<e[0].rect.element.top)return-1;var a=e[0].rect.element,s=a.marginLeft+a.marginRight,u=a.width+s,l=Qe(r,u);if(1===l){for(var c=0;c<i;c++){var f=e[c],d=f.rect.outer.top+.5*f.rect.element.height;if(n.top<d)return c}return i}for(var p=a.marginTop+a.marginBottom,h=a.height+p,g=0;g<i;g++){var v=g%l*u,m=Math.floor(g/l)*h,E=m-a.marginTop,_=v+u,b=m+h+a.marginBottom;if(n.top<b&&n.top>E){if(n.left<_)return g;o=g!==i-1?g:null}}return null!==o?o:i}},Je={height:0,width:0,get getHeight(){return this.height},set setHeight(t){0!==this.height&&0!==t||(this.height=t)},get getWidth(){return this.width},set setWidth(t){0!==this.width&&0!==t||(this.width=t)},setDimensions:function(t,e){0!==this.height&&0!==t||(this.height=t),0!==this.width&&0!==e||(this.width=e)}},tn=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;t.dragOffset?(t.translateX=null,t.translateY=null,t.translateX=t.dragOrigin.x+t.dragOffset.x,t.translateY=t.dragOrigin.y+t.dragOffset.y,t.scaleX=1.025,t.scaleY=1.025):(t.translateX=e,t.translateY=n,Date.now()>t.spawnDate&&(0===t.opacity&&en(t,e,n,r,i),t.scaleX=1,t.scaleY=1,t.opacity=1))},en=function(t,e,n,r,i){5===t.interactionMethod?(t.translateX=null,t.translateX=e,t.translateY=null,t.translateY=n):2===t.interactionMethod?(t.translateX=null,t.translateX=e-20*r,t.translateY=null,t.translateY=n-10*i,t.scaleX=.8,t.scaleY=.8):3===t.interactionMethod?(t.translateY=null,t.translateY=n-30):1===t.interactionMethod&&(t.translateX=null,t.translateX=e-30,t.translateY=null)},nn=function(t){return t.rect.element.height+.5*t.rect.element.marginBottom+.5*t.rect.element.marginTop},rn=S({DID_ADD_ITEM:function(t){var e=t.root,n=t.action,r=n.id,i=n.index,o=n.interactionMethod;e.ref.addIndex=i;var a=Date.now(),s=a,u=1;if(5!==o){u=0;var l=e.query("GET_ITEM_INSERT_INTERVAL"),c=a-e.ref.lastItemSpanwDate;s=c<l?a+(l-c):a}e.ref.lastItemSpanwDate=s,e.appendChildView(e.createChildView(Ze,{spawnDate:s,id:r,opacity:u,interactionMethod:o}),i)},DID_REMOVE_ITEM:function(t){var e=t.root,n=t.action.id,r=e.childViews.find((function(t){return t.id===n}));r&&(r.scaleX=.9,r.scaleY=.9,r.opacity=0,r.markedForRemoval=!0)},DID_DRAG_ITEM:function(t){var e=t.root,n=t.action,r=n.id,i=n.dragState,o=e.query("GET_ITEM",{id:r}),a=e.childViews.find((function(t){return t.id===r})),s=e.childViews.length,u=i.getItemIndex(o);if(a){var l,c=a.dragOrigin.x+a.dragOffset.x+a.dragCenter.x,f=a.dragOrigin.y+a.dragOffset.y+a.dragCenter.y,d=nn(a),p=(l=a).rect.element.width+.5*l.rect.element.marginLeft+.5*l.rect.element.marginRight,h=Math.floor(e.rect.outer.width/p);h>s&&(h=s);var g=Math.floor(s/h+1);Je.setHeight=d*g,Je.setWidth=p*h;var v={y:Math.floor(f/d),x:Math.floor(c/p),getGridIndex:function(){return f>Je.getHeight||f<0||c>Je.getWidth||c<0?u:this.y*h+this.x},getColIndex:function(){for(var t=e.query("GET_ACTIVE_ITEMS"),n=e.childViews.filter((function(t){return t.rect.element.height})),r=t.map((function(t){return n.find((function(e){return e.id===t.id}))})),i=r.findIndex((function(t){return t===a})),o=nn(a),s=r.length,u=s,l=0,c=0,d=0,p=0;p<s;p++)if(l=nn(r[p]),f<(c=(d=c)+l)){if(i>p){if(f<d+o){u=p;break}continue}u=p;break}return u}},m=h>1?v.getGridIndex():v.getColIndex();e.dispatch("MOVE_ITEM",{query:a,index:m});var E=i.getIndex();if(void 0===E||E!==m){if(i.setIndex(m),void 0===E)return;e.dispatch("DID_REORDER_ITEMS",{items:e.query("GET_ACTIVE_ITEMS"),origin:u,target:m})}}}}),on=I({create:function(t){var e=t.root;r(e.element,"role","list"),e.ref.lastItemSpanwDate=Date.now()},write:function(t){var e=t.root,n=t.props,r=t.actions,i=t.shouldOptimize;rn({root:e,props:n,actions:r});var o=n.dragCoordinates,a=e.rect.element.width,s=e.childViews.filter((function(t){return t.rect.element.height})),u=e.query("GET_ACTIVE_ITEMS").map((function(t){return s.find((function(e){return e.id===t.id}))})).filter((function(t){return t})),l=o?Ke(e,u,o):null,c=e.ref.addIndex||null;e.ref.addIndex=null;var f=0,d=0,p=0;if(0!==u.length){var h=u[0].rect.element,g=h.marginTop+h.marginBottom,v=h.marginLeft+h.marginRight,m=h.width+v,E=h.height+g,_=Qe(a,m);if(1===_){var b=0,y=0;u.forEach((function(t,e){if(l){var n=e-l;y=-2===n?.25*-g:-1===n?.75*-g:0===n?.75*g:1===n?.25*g:0}i&&(t.translateX=null,t.translateY=null),t.markedForRemoval||tn(t,0,b+y);var r=(t.rect.element.height+g)*(t.markedForRemoval?t.opacity:1);b+=r}))}else{var T=0,I=0;u.forEach((function(t,e){e===l&&(f=1),e===c&&(p+=1),t.markedForRemoval&&t.opacity<.5&&(d-=1);var n=e+p+f+d,r=n%_,o=Math.floor(n/_),a=r*m,s=o*E,u=Math.sign(a-T),h=Math.sign(s-I);T=a,I=s,t.markedForRemoval||(i&&(t.translateX=null,t.translateY=null),tn(t,a,s,u,h))}))}}},tag:"ul",name:"list",didWriteView:function(t){var e=t.root;e.childViews.filter((function(t){return t.markedForRemoval&&0===t.opacity&&t.resting})).forEach((function(t){t._destroy(),e.removeChildView(t)}))},filterFrameActionsForChild:function(t,e){return e.filter((function(e){return!e.data||!e.data.id||t.id===e.data.id}))},mixins:{apis:["dragCoordinates"]}}),an=S({DID_DRAG:function(t){var e=t.root,n=t.props,r=t.action;e.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(n.dragCoordinates={left:r.position.scopeLeft-e.ref.list.rect.element.left,top:r.position.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},DID_END_DRAG:function(t){t.props.dragCoordinates=null}}),sn=I({create:function(t){var e=t.root,n=t.props;e.ref.list=e.appendChildView(e.createChildView(on)),n.dragCoordinates=null,n.overflowing=!1},write:function(t){var e=t.root,n=t.props,r=t.actions;if(an({root:e,props:n,actions:r}),e.ref.list.dragCoordinates=n.dragCoordinates,n.overflowing&&!n.overflow&&(n.overflowing=!1,e.element.dataset.state="",e.height=null),n.overflow){var i=Math.round(n.overflow);i!==e.height&&(n.overflowing=!0,e.element.dataset.state="overflow",e.height=i)}},name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),un=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";n?r(t,e,i):t.removeAttribute(e)},ln=function(t){var e=t.root,n=t.action;e.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&un(e.element,"accept",!!n.value,n.value?n.value.join(","):"")},cn=function(t){var e=t.root,n=t.action;un(e.element,"multiple",n.value)},fn=function(t){var e=t.root,n=t.action;un(e.element,"webkitdirectory",n.value)},dn=function(t){var e=t.root,n=e.query("GET_DISABLED"),r=e.query("GET_ALLOW_BROWSE"),i=n||!r;un(e.element,"disabled",i)},pn=function(t){var e=t.root;t.action.value?0===e.query("GET_TOTAL_ITEMS")&&un(e.element,"required",!0):un(e.element,"required",!1)},hn=function(t){var e=t.root,n=t.action;un(e.element,"capture",!!n.value,!0===n.value?"":n.value)},gn=function(t){var e=t.root,n=e.element;e.query("GET_TOTAL_ITEMS")>0?(un(n,"required",!1),un(n,"name",!1)):(un(n,"name",!0,e.query("GET_NAME")),e.query("GET_CHECK_VALIDITY")&&n.setCustomValidity(""),e.query("GET_REQUIRED")&&un(n,"required",!0))},vn=I({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:function(t){var e=t.root,n=t.props;e.element.id="filepond--browser-"+n.id,r(e.element,"name",e.query("GET_NAME")),r(e.element,"aria-controls","filepond--assistant-"+n.id),r(e.element,"aria-labelledby","filepond--drop-label-"+n.id),ln({root:e,action:{value:e.query("GET_ACCEPTED_FILE_TYPES")}}),cn({root:e,action:{value:e.query("GET_ALLOW_MULTIPLE")}}),fn({root:e,action:{value:e.query("GET_ALLOW_DIRECTORIES_ONLY")}}),dn({root:e}),pn({root:e,action:{value:e.query("GET_REQUIRED")}}),hn({root:e,action:{value:e.query("GET_CAPTURE_METHOD")}}),e.ref.handleChange=function(t){if(e.element.value){var r=Array.from(e.element.files).map((function(t){return t._relativePath=t.webkitRelativePath,t}));setTimeout((function(){n.onload(r),function(t){if(t&&""!==t.value){try{t.value=""}catch(t){}if(t.value){var e=pe("form"),n=t.parentNode,r=t.nextSibling;e.appendChild(t),e.reset(),r?n.insertBefore(t,r):n.appendChild(t)}}}(e.element)}),250)}},e.element.addEventListener("change",e.ref.handleChange)},destroy:function(t){var e=t.root;e.element.removeEventListener("change",e.ref.handleChange)},write:S({DID_LOAD_ITEM:gn,DID_REMOVE_ITEM:gn,DID_THROW_ITEM_INVALID:function(t){var e=t.root;e.query("GET_CHECK_VALIDITY")&&e.element.setCustomValidity(e.query("GET_LABEL_INVALID_FIELD"))},DID_SET_DISABLED:dn,DID_SET_ALLOW_BROWSE:dn,DID_SET_ALLOW_DIRECTORIES_ONLY:fn,DID_SET_ALLOW_MULTIPLE:cn,DID_SET_ACCEPTED_FILE_TYPES:ln,DID_SET_CAPTURE_METHOD:hn,DID_SET_REQUIRED:pn})}),mn=function(t,e){t.innerHTML=e;var n=t.querySelector(".filepond--label-action");return n&&r(n,"tabindex","0"),e},En=I({name:"drop-label",ignoreRect:!0,create:function(t){var e=t.root,n=t.props,i=pe("label");r(i,"for","filepond--browser-"+n.id),r(i,"id","filepond--drop-label-"+n.id),r(i,"aria-hidden","true"),e.ref.handleKeyDown=function(t){(13===t.keyCode||32===t.keyCode)&&(t.preventDefault(),e.ref.label.click())},e.ref.handleClick=function(t){t.target===i||i.contains(t.target)||e.ref.label.click()},i.addEventListener("keydown",e.ref.handleKeyDown),e.element.addEventListener("click",e.ref.handleClick),mn(i,n.caption),e.appendChild(i),e.ref.label=i},destroy:function(t){var e=t.root;e.ref.label.addEventListener("keydown",e.ref.handleKeyDown),e.element.removeEventListener("click",e.ref.handleClick)},write:S({DID_SET_LABEL_IDLE:function(t){var e=t.root,n=t.action;mn(e.ref.label,n.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),_n=I({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),bn=S({DID_DRAG:function(t){var e=t.root,n=t.action;e.ref.blob?(e.ref.blob.translateX=n.position.scopeLeft,e.ref.blob.translateY=n.position.scopeTop,e.ref.blob.scaleX=1,e.ref.blob.scaleY=1,e.ref.blob.opacity=1):function(t){var e=t.root,n=.5*e.rect.element.width,r=.5*e.rect.element.height;e.ref.blob=e.appendChildView(e.createChildView(_n,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:n,translateY:r}))}({root:e})},DID_DROP:function(t){var e=t.root;e.ref.blob&&(e.ref.blob.scaleX=2.5,e.ref.blob.scaleY=2.5,e.ref.blob.opacity=0)},DID_END_DRAG:function(t){var e=t.root;e.ref.blob&&(e.ref.blob.opacity=0)}}),yn=I({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:function(t){var e=t.root,n=t.props,r=t.actions;bn({root:e,props:n,actions:r});var i=e.ref.blob;0===r.length&&i&&0===i.opacity&&(e.removeChildView(i),e.ref.blob=null)}}),Tn=function(t,e){try{var n=new DataTransfer;e.forEach((function(t){t instanceof File?n.items.add(t):n.items.add(new File([t],t.name,{type:t.type}))})),t.files=n.files}catch(t){return!1}return!0},In=function(t,e){return t.ref.fields[e]},Sn=function(t){t.query("GET_ACTIVE_ITEMS").forEach((function(e){t.ref.fields[e.id]&&t.element.appendChild(t.ref.fields[e.id])}))},Rn=function(t){var e=t.root;return Sn(e)},wn=S({DID_SET_DISABLED:function(t){var e=t.root;e.element.disabled=e.query("GET_DISABLED")},DID_ADD_ITEM:function(t){var e=t.root,n=t.action,r=!(e.query("GET_ITEM",n.id).origin===ut.LOCAL)&&e.query("SHOULD_UPDATE_FILE_INPUT"),i=pe("input");i.type=r?"file":"hidden",i.name=e.query("GET_NAME"),i.disabled=e.query("GET_DISABLED"),e.ref.fields[n.id]=i,Sn(e)},DID_LOAD_ITEM:function(t){var e=t.root,n=t.action,r=In(e,n.id);if(r&&(null!==n.serverFileReference&&(r.value=n.serverFileReference),e.query("SHOULD_UPDATE_FILE_INPUT"))){var i=e.query("GET_ITEM",n.id);Tn(r,[i.file])}},DID_REMOVE_ITEM:function(t){var e=t.root,n=t.action,r=In(e,n.id);r&&(r.parentNode&&r.parentNode.removeChild(r),delete e.ref.fields[n.id])},DID_DEFINE_VALUE:function(t){var e=t.root,n=t.action,r=In(e,n.id);r&&(null===n.value?r.removeAttribute("value"):r.value=n.value,Sn(e))},DID_PREPARE_OUTPUT:function(t){var e=t.root,n=t.action;e.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout((function(){var t=In(e,n.id);t&&Tn(t,[n.file])}),0)},DID_REORDER_ITEMS:Rn,DID_SORT_ITEMS:Rn}),On=I({tag:"fieldset",name:"data",create:function(t){return t.root.ref.fields={}},write:wn,ignoreRect:!0}),Cn=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],Mn=["css","csv","html","txt"],Dn={zip:"zip|compressed",epub:"application/epub+zip"},xn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t=t.toLowerCase(),Cn.includes(t)?"image/"+("jpg"===t?"jpeg":"svg"===t?"svg+xml":t):Mn.includes(t)?"text/"+t:Dn[t]||""},An=function(t){return new Promise((function(e,n){var r=qn(t);if(r.length&&!Pn(t))return e(r);Ln(t).then(e)}))},Pn=function(t){return!!t.files&&t.files.length>0},Ln=function(t){return new Promise((function(e,n){var r=(t.items?Array.from(t.items):[]).filter((function(t){return Nn(t)})).map((function(t){return Gn(t)}));r.length?Promise.all(r).then((function(t){var n=[];t.forEach((function(t){n.push.apply(n,t)})),e(n.filter((function(t){return t})).map((function(t){return t._relativePath||(t._relativePath=t.webkitRelativePath),t})))})).catch(console.error):e(t.files?Array.from(t.files):[])}))},Nn=function(t){if(Fn(t)){var e=Un(t);if(e)return e.isFile||e.isDirectory}return"file"===t.kind},Gn=function(t){return new Promise((function(e,n){zn(t)?kn(Un(t)).then(e).catch(n):e([t.getAsFile()])}))},kn=function(t){return new Promise((function(e,n){var r=[],i=0,o=0,a=function(){0===o&&0===i&&e(r)};!function t(e){i++;var s=e.createReader();!function e(){s.readEntries((function(n){if(0===n.length)return i--,void a();n.forEach((function(e){e.isDirectory?t(e):(o++,e.file((function(t){var n=Bn(t);e.fullPath&&(n._relativePath=e.fullPath),r.push(n),o--,a()})))})),e()}),n)}()}(t)}))},Bn=function(t){if(t.type.length)return t;var e=t.lastModifiedDate,n=t.name,r=xn(Lt(t.name));return r.length?((t=t.slice(0,t.size,r)).name=n,t.lastModifiedDate=e,t):t},zn=function(t){return Fn(t)&&(Un(t)||{}).isDirectory},Fn=function(t){return"webkitGetAsEntry"in t},Un=function(t){return t.webkitGetAsEntry()},qn=function(t){var e=[];try{if((e=Yn(t)).length)return e;e=Vn(t)}catch(t){}return e},Vn=function(t){var e=t.getData("url");return"string"==typeof e&&e.length?[e]:[]},Yn=function(t){var e=t.getData("text/html");if("string"==typeof e&&e.length){var n=e.match(/src\s*=\s*"(.+?)"/);if(n)return[n[1]]}return[]},jn=[],Wn=function(t){return{pageLeft:t.pageX,pageTop:t.pageY,scopeLeft:t.offsetX||t.layerX,scopeTop:t.offsetY||t.layerY}},Xn=function(t){var n=[],r={dragenter:Qn,dragover:Kn,dragleave:tr,drop:Jn},i={};e(r,(function(e,r){i[e]=r(t,n),t.addEventListener(e,i[e],!1)}));var o={element:t,addListener:function(a){return n.push(a),function(){n.splice(n.indexOf(a),1),0===n.length&&(jn.splice(jn.indexOf(o),1),e(r,(function(e){t.removeEventListener(e,i[e],!1)})))}}};return o},Hn=function(t,e){var n,r=function(t,e){return"elementFromPoint"in t||(t=document),t.elementFromPoint(e.x,e.y)}("getRootNode"in(n=e)?n.getRootNode():document,{x:t.pageX-window.pageXOffset,y:t.pageY-window.pageYOffset});return r===e||e.contains(r)},$n=null,Zn=function(t,e){try{t.dropEffect=e}catch(t){}},Qn=function(t,e){return function(t){t.preventDefault(),$n=t.target,e.forEach((function(e){var n=e.element,r=e.onenter;Hn(t,n)&&(e.state="enter",r(Wn(t)))}))}},Kn=function(t,e){return function(t){t.preventDefault();var n=t.dataTransfer;An(n).then((function(r){var i=!1;e.some((function(e){var o=e.filterElement,a=e.element,s=e.onenter,u=e.onexit,l=e.ondrag,c=e.allowdrop;Zn(n,"copy");var f=c(r);if(f)if(Hn(t,a)){if(i=!0,null===e.state)return e.state="enter",void s(Wn(t));if(e.state="over",o&&!f)return void Zn(n,"none");l(Wn(t))}else o&&!i&&Zn(n,"none"),e.state&&(e.state=null,u(Wn(t)));else Zn(n,"none")}))}))}},Jn=function(t,e){return function(t){t.preventDefault();var n=t.dataTransfer;An(n).then((function(n){e.forEach((function(e){var r=e.filterElement,i=e.element,o=e.ondrop,a=e.onexit,s=e.allowdrop;if(e.state=null,!r||Hn(t,i))return s(n)?void o(Wn(t),n):a(Wn(t))}))}))}},tr=function(t,e){return function(t){$n===t.target&&e.forEach((function(e){var n=e.onexit;e.state=null,n(Wn(t))}))}},er=function(t,e,n){t.classList.add("filepond--hopper");var r=n.catchesDropsOnPage,i=n.requiresDropOnElement,o=n.filterItems,a=void 0===o?function(t){return t}:o,s=function(t,e,n){var r=function(t){var e=jn.find((function(e){return e.element===t}));if(e)return e;var n=Xn(t);return jn.push(n),n}(e),i={element:t,filterElement:n,state:null,ondrop:function(){},onenter:function(){},ondrag:function(){},onexit:function(){},onload:function(){},allowdrop:function(){}};return i.destroy=r.addListener(i),i}(t,r?document.documentElement:t,i),u="",l="";s.allowdrop=function(t){return e(a(t))},s.ondrop=function(t,n){var r=a(n);e(r)?(l="drag-drop",c.onload(r,t)):c.ondragend(t)},s.ondrag=function(t){c.ondrag(t)},s.onenter=function(t){l="drag-over",c.ondragstart(t)},s.onexit=function(t){l="drag-exit",c.ondragend(t)};var c={updateHopperState:function(){u!==l&&(t.dataset.hopperState=l,u=l)},onload:function(){},ondragstart:function(){},ondrag:function(){},ondragend:function(){},destroy:function(){s.destroy()}};return c},nr=!1,rr=[],ir=function(t){var e=document.activeElement;if(e&&/textarea|input/i.test(e.nodeName)){for(var n=!1,r=e;r!==document.body;){if(r.classList.contains("filepond--root")){n=!0;break}r=r.parentNode}if(!n)return}An(t.clipboardData).then((function(t){t.length&&rr.forEach((function(e){return e(t)}))}))},or=null,ar=null,sr=[],ur=function(t,e){t.element.textContent=e},lr=function(t,e,n){var r=t.query("GET_TOTAL_ITEMS");ur(t,n+" "+e+", "+r+" "+(1===r?t.query("GET_LABEL_FILE_COUNT_SINGULAR"):t.query("GET_LABEL_FILE_COUNT_PLURAL"))),clearTimeout(ar),ar=setTimeout((function(){!function(t){t.element.textContent=""}(t)}),1500)},cr=function(t){return t.element.parentNode.contains(document.activeElement)},fr=function(t){var e=t.root,n=t.action,r=e.query("GET_ITEM",n.id).filename,i=e.query("GET_LABEL_FILE_PROCESSING_ABORTED");ur(e,r+" "+i)},dr=function(t){var e=t.root,n=t.action,r=e.query("GET_ITEM",n.id).filename;ur(e,n.status.main+" "+r+" "+n.status.sub)},pr=I({create:function(t){var e=t.root,n=t.props;e.element.id="filepond--assistant-"+n.id,r(e.element,"role","status"),r(e.element,"aria-live","polite"),r(e.element,"aria-relevant","additions")},ignoreRect:!0,ignoreRectUpdate:!0,write:S({DID_LOAD_ITEM:function(t){var e=t.root,n=t.action;if(cr(e)){e.element.textContent="";var r=e.query("GET_ITEM",n.id);sr.push(r.filename),clearTimeout(or),or=setTimeout((function(){lr(e,sr.join(", "),e.query("GET_LABEL_FILE_ADDED")),sr.length=0}),750)}},DID_REMOVE_ITEM:function(t){var e=t.root,n=t.action;if(cr(e)){var r=n.item;lr(e,r.filename,e.query("GET_LABEL_FILE_REMOVED"))}},DID_COMPLETE_ITEM_PROCESSING:function(t){var e=t.root,n=t.action,r=e.query("GET_ITEM",n.id).filename,i=e.query("GET_LABEL_FILE_PROCESSING_COMPLETE");ur(e,r+" "+i)},DID_ABORT_ITEM_PROCESSING:fr,DID_REVERT_ITEM_PROCESSING:fr,DID_THROW_ITEM_REMOVE_ERROR:dr,DID_THROW_ITEM_LOAD_ERROR:dr,DID_THROW_ITEM_INVALID:dr,DID_THROW_ITEM_PROCESSING_ERROR:dr}),tag:"span",name:"assistant"}),hr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t.replace(new RegExp(e+".","g"),(function(t){return t.charAt(1).toUpperCase()}))},gr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Date.now(),i=null;return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];clearTimeout(i);var u=Date.now()-r,l=function(){r=Date.now(),t.apply(void 0,a)};u<e?n||(i=setTimeout(l,e-u)):l()}},vr=function(t){return t.preventDefault()},mr=function(t,e){var n=t.query("GET_ALLOW_REPLACE"),r=t.query("GET_ALLOW_MULTIPLE"),i=t.query("GET_TOTAL_ITEMS"),o=t.query("GET_MAX_FILES"),a=e.length;return!r&&a>1||!!(k(o=r||n?o:1)&&i+a>o)&&(t.dispatch("DID_THROW_MAX_FILES",{source:e,error:Xt("warning",0,"Max files")}),!0)},Er=function(t,e,n){var r=t.childViews[0];return Ke(r,e,{left:n.scopeLeft-r.rect.element.left,top:n.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},_r=function(t){var e=t.query("GET_ALLOW_DROP"),n=t.query("GET_DISABLED"),r=e&&!n;if(r&&!t.ref.hopper){var i=er(t.element,(function(e){var n=t.query("GET_BEFORE_DROP_FILE")||function(){return!0};return!t.query("GET_DROP_VALIDATION")||e.every((function(e){return ht("ALLOW_HOPPER_ITEM",e,{query:t.query}).every((function(t){return!0===t}))&&n(e)}))}),{filterItems:function(e){var n=t.query("GET_IGNORED_FILES");return e.filter((function(t){return!ne(t)||!n.includes(t.name.toLowerCase())}))},catchesDropsOnPage:t.query("GET_DROP_ON_PAGE"),requiresDropOnElement:t.query("GET_DROP_ON_ELEMENT")});i.onload=function(e,n){var r=t.ref.list.childViews[0].childViews.filter((function(t){return t.rect.element.height})),i=t.query("GET_ACTIVE_ITEMS").map((function(t){return r.find((function(e){return e.id===t.id}))})).filter((function(t){return t}));pt("ADD_ITEMS",e,{dispatch:t.dispatch}).then((function(e){if(mr(t,e))return!1;t.dispatch("ADD_ITEMS",{items:e,index:Er(t.ref.list,i,n),interactionMethod:2})})),t.dispatch("DID_DROP",{position:n}),t.dispatch("DID_END_DRAG",{position:n})},i.ondragstart=function(e){t.dispatch("DID_START_DRAG",{position:e})},i.ondrag=gr((function(e){t.dispatch("DID_DRAG",{position:e})})),i.ondragend=function(e){t.dispatch("DID_END_DRAG",{position:e})},t.ref.hopper=i,t.ref.drip=t.appendChildView(t.createChildView(yn))}else!r&&t.ref.hopper&&(t.ref.hopper.destroy(),t.ref.hopper=null,t.removeChildView(t.ref.drip))},br=function(t,e){var n=t.query("GET_ALLOW_BROWSE"),r=t.query("GET_DISABLED"),i=n&&!r;i&&!t.ref.browser?t.ref.browser=t.appendChildView(t.createChildView(vn,Object.assign({},e,{onload:function(e){pt("ADD_ITEMS",e,{dispatch:t.dispatch}).then((function(e){if(mr(t,e))return!1;t.dispatch("ADD_ITEMS",{items:e,index:-1,interactionMethod:3})}))}})),0):!i&&t.ref.browser&&(t.removeChildView(t.ref.browser),t.ref.browser=null)},yr=function(t){var e=t.query("GET_ALLOW_PASTE"),n=t.query("GET_DISABLED"),r=e&&!n;r&&!t.ref.paster?(t.ref.paster=function(){var t=function(t){e.onload(t)},e={destroy:function(){var e;e=t,nt(rr,rr.indexOf(e)),0===rr.length&&(document.removeEventListener("paste",ir),nr=!1)},onload:function(){}};return function(t){rr.includes(t)||(rr.push(t),nr||(nr=!0,document.addEventListener("paste",ir)))}(t),e}(),t.ref.paster.onload=function(e){pt("ADD_ITEMS",e,{dispatch:t.dispatch}).then((function(e){if(mr(t,e))return!1;t.dispatch("ADD_ITEMS",{items:e,index:-1,interactionMethod:4})}))}):!r&&t.ref.paster&&(t.ref.paster.destroy(),t.ref.paster=null)},Tr=S({DID_SET_ALLOW_BROWSE:function(t){var e=t.root,n=t.props;br(e,n)},DID_SET_ALLOW_DROP:function(t){var e=t.root;_r(e)},DID_SET_ALLOW_PASTE:function(t){var e=t.root;yr(e)},DID_SET_DISABLED:function(t){var e=t.root,n=t.props;_r(e),yr(e),br(e,n),e.query("GET_DISABLED")?e.element.dataset.disabled="disabled":e.element.removeAttribute("data-disabled")}}),Ir=I({name:"root",read:function(t){var e=t.root;e.ref.measure&&(e.ref.measureHeight=e.ref.measure.offsetHeight)},create:function(t){var e=t.root,n=t.props,r=e.query("GET_ID");r&&(e.element.id=r);var i=e.query("GET_CLASS_NAME");i&&i.split(" ").filter((function(t){return t.length})).forEach((function(t){e.element.classList.add(t)})),e.ref.label=e.appendChildView(e.createChildView(En,Object.assign({},n,{translateY:null,caption:e.query("GET_LABEL_IDLE")}))),e.ref.list=e.appendChildView(e.createChildView(sn,{translateY:null})),e.ref.panel=e.appendChildView(e.createChildView(je,{name:"panel-root"})),e.ref.assistant=e.appendChildView(e.createChildView(pr,Object.assign({},n))),e.ref.data=e.appendChildView(e.createChildView(On,Object.assign({},n))),e.ref.measure=pe("div"),e.ref.measure.style.height="100%",e.element.appendChild(e.ref.measure),e.ref.bounds=null,e.query("GET_STYLES").filter((function(t){return!C(t.value)})).map((function(t){var n=t.name,r=t.value;e.element.dataset[n]=r})),e.ref.widthPrevious=null,e.ref.widthUpdated=gr((function(){e.ref.updateHistory=[],e.dispatch("DID_RESIZE_ROOT")}),250),e.ref.previousAspectRatio=null,e.ref.updateHistory=[];var o=window.matchMedia("(pointer: fine) and (hover: hover)").matches,a="PointerEvent"in window;e.query("GET_ALLOW_REORDER")&&a&&!o&&(e.element.addEventListener("touchmove",vr,{passive:!1}),e.element.addEventListener("gesturestart",vr));var s=e.query("GET_CREDITS");if(2===s.length){var u=document.createElement("a");u.className="filepond--credits",u.setAttribute("aria-hidden","true"),u.href=s[0],u.tabindex=-1,u.target="_blank",u.rel="noopener noreferrer",u.textContent=s[1],e.element.appendChild(u),e.ref.credits=u}},write:function(t){var e=t.root,n=t.props,r=t.actions;if(Tr({root:e,props:n,actions:r}),r.filter((function(t){return/^DID_SET_STYLE_/.test(t.type)})).filter((function(t){return!C(t.data.value)})).map((function(t){var n=t.type,r=t.data,i=hr(n.substr(8).toLowerCase(),"_");e.element.dataset[i]=r.value,e.invalidateLayout()})),!e.rect.element.hidden){e.rect.element.width!==e.ref.widthPrevious&&(e.ref.widthPrevious=e.rect.element.width,e.ref.widthUpdated());var i=e.ref.bounds;i||(i=e.ref.bounds=function(t){var e=t.ref.measureHeight||null;return{cappedHeight:parseInt(t.style.maxHeight,10)||null,fixedHeight:0===e?null:e}}(e),e.element.removeChild(e.ref.measure),e.ref.measure=null);var o=e.ref,a=o.hopper,s=o.label,u=o.list,l=o.panel;a&&a.updateHopperState();var c=e.query("GET_PANEL_ASPECT_RATIO"),f=e.query("GET_ALLOW_MULTIPLE"),d=e.query("GET_TOTAL_ITEMS"),p=d===(f?e.query("GET_MAX_FILES")||1e6:1),h=r.find((function(t){return"DID_ADD_ITEM"===t.type}));if(p&&h){var g=h.data.interactionMethod;s.opacity=0,f?s.translateY=-40:1===g?s.translateX=40:s.translateY=3===g?40:30}else p||(s.opacity=1,s.translateX=0,s.translateY=0);var v=function(t){var e=t.ref.list.childViews[0].childViews[0];return e?{top:e.rect.element.marginTop,bottom:e.rect.element.marginBottom}:{top:0,bottom:0}}(e),m=function(t){var e=0,n=0,r=t.ref.list,i=r.childViews[0],o=i.childViews.filter((function(t){return t.rect.element.height})),a=t.query("GET_ACTIVE_ITEMS").map((function(t){return o.find((function(e){return e.id===t.id}))})).filter((function(t){return t}));if(0===a.length)return{visual:e,bounds:n};var s=i.rect.element.width,u=Ke(i,a,r.dragCoordinates),l=a[0].rect.element,c=l.marginTop+l.marginBottom,f=l.marginLeft+l.marginRight,d=l.width+f,p=l.height+c,h=void 0!==u&&u>=0?1:0,g=a.find((function(t){return t.markedForRemoval&&t.opacity<.45}))?-1:0,v=a.length+h+g,m=Qe(s,d);return 1===m?a.forEach((function(t){var r=t.rect.element.height+c;n+=r,e+=r*t.opacity})):(n=Math.ceil(v/m)*p,e=n),{visual:e,bounds:n}}(e),E=s.rect.element.height,_=!f||p?0:E,b=p?u.rect.element.marginTop:0,y=0===d?0:u.rect.element.marginBottom,T=_+b+m.visual+y,I=_+b+m.bounds+y;if(u.translateY=Math.max(0,_-u.rect.element.marginTop)-v.top,c){var S=e.rect.element.width,R=S*c;c!==e.ref.previousAspectRatio&&(e.ref.previousAspectRatio=c,e.ref.updateHistory=[]);var w=e.ref.updateHistory;if(w.push(S),w.length>4)for(var O=w.length,M=O-10,D=0,x=O;x>=M;x--)if(w[x]===w[x-2]&&D++,D>=2)return;l.scalable=!1,l.height=R;var A=R-_-(y-v.bottom)-(p?b:0);m.visual>A?u.overflow=A:u.overflow=null,e.height=R}else if(i.fixedHeight){l.scalable=!1;var P=i.fixedHeight-_-(y-v.bottom)-(p?b:0);m.visual>P?u.overflow=P:u.overflow=null}else if(i.cappedHeight){var L=T>=i.cappedHeight,N=Math.min(i.cappedHeight,T);l.scalable=!0,l.height=L?N:N-v.top-v.bottom;var G=N-_-(y-v.bottom)-(p?b:0);T>i.cappedHeight&&m.visual>G?u.overflow=G:u.overflow=null,e.height=Math.min(i.cappedHeight,I-v.top-v.bottom)}else{var k=d>0?v.top+v.bottom:0;l.scalable=!0,l.height=Math.max(E,T-k),e.height=Math.max(E,I-k)}e.ref.credits&&l.heightCurrent&&(e.ref.credits.style.transform="translateY("+l.heightCurrent+"px)")}},destroy:function(t){var e=t.root;e.ref.paster&&e.ref.paster.destroy(),e.ref.hopper&&e.ref.hopper.destroy(),e.element.removeEventListener("touchmove",vr),e.element.removeEventListener("gesturestart",vr)},mixins:{styles:["height"]}}),Sr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=null,i=vt(),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=Object.assign({},t),i=[],o=[],a=function(t,e,n){!n||document.hidden?(c[t]&&c[t](e),i.push({type:t,data:e})):o.push({type:t,data:e})},s=function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return l[t]?(e=l)[t].apply(e,r):null},u={getState:function(){return Object.assign({},r)},processActionQueue:function(){var t=[].concat(i);return i.length=0,t},processDispatchQueue:function(){var t=[].concat(o);o.length=0,t.forEach((function(t){var e=t.type,n=t.data;a(e,n)}))},dispatch:a,query:s},l={};e.forEach((function(t){l=Object.assign({},t(r),{},l)}));var c={};return n.forEach((function(t){c=Object.assign({},t(a,s,r),{},c)})),u}({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:j(i)},[Dt,H(i)],[de,X(i)]);o.dispatch("SET_OPTIONS",{options:t});var a=function(){document.hidden||o.dispatch("KICK")};document.addEventListener("visibilitychange",a);var s=null,u=!1,l=!1,c=null,f=null,d=function(){u||(u=!0),clearTimeout(s),s=setTimeout((function(){u=!1,c=null,f=null,l&&(l=!1,o.dispatch("DID_STOP_RESIZE"))}),500)};window.addEventListener("resize",d);var p=Ir(o,{id:$()}),h=!1,v=!1,m={_read:function(){u&&(f=window.innerWidth,c||(c=f),l||f===c||(o.dispatch("DID_START_RESIZE"),l=!0)),v&&h&&(h=null===p.element.offsetParent),h||(p._read(),v=p.rect.element.hidden)},_write:function(t){var e,n=o.processActionQueue().filter((function(t){return!/^SET_/.test(t.type)}));h&&!n.length||(y(n),h=p._write(t,n,l),(e=o.query("GET_ITEMS")).forEach((function(t,n){t.released&&nt(e,n)})),h&&o.processDispatchQueue())}},E=function(t){return function(e){var n={type:t};if(!e)return n;if(e.hasOwnProperty("error")&&(n.error=e.error?Object.assign({},e.error):null),e.status&&(n.status=Object.assign({},e.status)),e.file&&(n.output=e.file),e.source)n.file=e.source;else if(e.item||e.id){var r=e.item?e.item:o.query("GET_ITEM",e.id);n.file=r?at(r):null}return e.items&&(n.items=e.items.map(at)),/progress/.test(t)&&(n.progress=e.progress),e.hasOwnProperty("origin")&&e.hasOwnProperty("target")&&(n.origin=e.origin,n.target=e.target),n}},_={DID_DESTROY:E("destroy"),DID_INIT:E("init"),DID_THROW_MAX_FILES:E("warning"),DID_INIT_ITEM:E("initfile"),DID_START_ITEM_LOAD:E("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:E("addfileprogress"),DID_LOAD_ITEM:E("addfile"),DID_THROW_ITEM_INVALID:[E("error"),E("addfile")],DID_THROW_ITEM_LOAD_ERROR:[E("error"),E("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[E("error"),E("removefile")],DID_PREPARE_OUTPUT:E("preparefile"),DID_START_ITEM_PROCESSING:E("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:E("processfileprogress"),DID_ABORT_ITEM_PROCESSING:E("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:E("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:E("processfiles"),DID_REVERT_ITEM_PROCESSING:E("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[E("error"),E("processfile")],DID_REMOVE_ITEM:E("removefile"),DID_UPDATE_ITEMS:E("updatefiles"),DID_ACTIVATE_ITEM:E("activatefile"),DID_REORDER_ITEMS:E("reorderfiles")},b=function(t){var e=Object.assign({pond:D},t);delete e.type,p.element.dispatchEvent(new CustomEvent("FilePond:"+t.type,{detail:e,bubbles:!0,cancelable:!0,composed:!0}));var n=[];t.hasOwnProperty("error")&&n.push(t.error),t.hasOwnProperty("file")&&n.push(t.file);var r=["type","error","file"];Object.keys(t).filter((function(t){return!r.includes(t)})).forEach((function(e){return n.push(t[e])})),D.fire.apply(D,[t.type].concat(n));var i=o.query("GET_ON"+t.type.toUpperCase());i&&i.apply(void 0,n)},y=function(t){t.length&&t.filter((function(t){return _[t.type]})).forEach((function(t){var e=_[t.type];(Array.isArray(e)?e:[e]).forEach((function(e){"DID_INIT_ITEM"===t.type?b(e(t.data)):setTimeout((function(){b(e(t.data))}),0)}))}))},T=function(t){return new Promise((function(e,n){o.dispatch("REQUEST_ITEM_PREPARE",{query:t,success:function(t){e(t)},failure:function(t){n(t)}})}))},I=function(t,e){var n;return"object"!=typeof t||(n=t).file&&n.id||e||(e=t,t=void 0),o.dispatch("REMOVE_ITEM",Object.assign({},e,{query:t})),null===o.query("GET_ACTIVE_ITEM",t)},S=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Promise((function(t,n){var r=[],i={};if(O(e[0]))r.push.apply(r,e[0]),Object.assign(i,e[1]||{});else{var a=e[e.length-1];"object"!=typeof a||a instanceof Blob||Object.assign(i,e.pop()),r.push.apply(r,e)}o.dispatch("ADD_ITEMS",{items:r,index:i.index,interactionMethod:1,success:t,failure:n})}))},C=function(){return o.query("GET_ACTIVE_ITEMS")},M=function(t){return new Promise((function(e,n){o.dispatch("REQUEST_ITEM_PROCESSING",{query:t,success:function(t){e(t)},failure:function(t){n(t)}})}))},D=Object.assign({},rt(),{},m,{},function(t,n){var r={};return e(n,(function(e){r[e]={get:function(){return t.getState().options[e]},set:function(n){t.dispatch("SET_"+W(e,"_").toUpperCase(),{value:n})}}})),r}(o,i),{setOptions:function(t){return o.dispatch("SET_OPTIONS",{options:t})},addFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){S([{source:t,options:e}],{index:e.index}).then((function(t){return n(t&&t[0])})).catch(r)}))},addFiles:S,getFile:function(t){return o.query("GET_ACTIVE_ITEM",t)},processFile:M,prepareFile:T,removeFile:I,moveFile:function(t,e){return o.dispatch("MOVE_ITEM",{query:t,index:e})},getFiles:C,processFiles:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Array.isArray(e[0])?e[0]:e;if(!r.length){var i=C().filter((function(t){return!(t.status===st.IDLE&&t.origin===ut.LOCAL)&&t.status!==st.PROCESSING&&t.status!==st.PROCESSING_COMPLETE&&t.status!==st.PROCESSING_REVERT_ERROR}));return Promise.all(i.map(M))}return Promise.all(r.map(M))},removeFiles:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=Array.isArray(e[0])?e[0]:e;"object"==typeof i[i.length-1]?r=i.pop():Array.isArray(e[0])&&(r=e[1]);var o=C();return i.length?i.map((function(t){return g(t)?o[t]?o[t].id:null:t})).filter((function(t){return t})).map((function(t){return I(t,r)})):Promise.all(o.map((function(t){return I(t,r)})))},prepareFiles:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=Array.isArray(e[0])?e[0]:e,i=r.length?r:C();return Promise.all(i.map(T))},sort:function(t){return o.dispatch("SORT",{compare:t})},browse:function(){var t=p.element.querySelector("input[type=file]");t&&t.click()},destroy:function(){D.fire("destroy",p.element),o.dispatch("ABORT_ALL"),p._destroy(),window.removeEventListener("resize",d),document.removeEventListener("visibilitychange",a),o.dispatch("DID_DESTROY")},insertBefore:function(t){return R(p.element,t)},insertAfter:function(t){return w(p.element,t)},appendTo:function(t){return t.appendChild(p.element)},replaceElement:function(t){R(p.element,t),t.parentNode.removeChild(t),r=t},restoreElement:function(){r&&(w(r,p.element),p.element.parentNode.removeChild(p.element),r=null)},isAttachedTo:function(t){return p.element===t||r===t},element:{get:function(){return p.element}},status:{get:function(){return o.query("GET_STATUS")}}});return o.dispatch("DID_INIT"),n(D)},Rr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};return e(vt(),(function(t,e){n[t]=e[0]})),Sr(Object.assign({},n,{},t))},wr=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];e(t.attributes,(function(e){i.push(t.attributes[e])}));var o=i.filter((function(t){return t.name})).reduce((function(e,n){var i,o=r(t,n.name);return e[(i=n.name,hr(i.replace(/^data-/,"")))]=o===n.name||o,e}),{});return function t(n,r){e(r,(function(r,i){e(n,(function(t,e){var o=new RegExp(r);if(o.test(t)&&(delete n[t],!1!==i))if(P(i))n[i]=e;else{var a,s=i.group;U(i)&&!n[s]&&(n[s]={}),n[s][(a=t.replace(o,""),a.charAt(0).toLowerCase()+a.slice(1))]=e}})),i.mapping&&t(n[i.group],i.mapping)}))}(o,n),o},Or=function(){return(arguments.length<=0?void 0:arguments[0])instanceof HTMLElement?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};ht("SET_ATTRIBUTE_TO_OPTION_MAP",n);var r=Object.assign({},e),i=wr("FIELDSET"===t.nodeName?t.querySelector("input[type=file]"):t,n);Object.keys(i).forEach((function(t){U(i[t])?(U(r[t])||(r[t]={}),Object.assign(r[t],i[t])):r[t]=i[t]})),r.files=(e.files||[]).concat(Array.from(t.querySelectorAll("input:not([type=file])")).map((function(t){return{source:t.value,options:{type:t.dataset.type}}})));var o=Rr(r);return t.files&&Array.from(t.files).forEach((function(t){o.addFile(t)})),o.replaceElement(t),o}.apply(void 0,arguments):Rr.apply(void 0,arguments)},Cr=["fire","_read","_write"],Mr=function(t){var e={};return it(t,e,Cr),e},Dr=function(t,e){return t.replace(/(?:{([a-zA-Z]+)})/g,(function(t,n){return e[n]}))},xr=function(t){var e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(e),r=new Worker(n);return{transfer:function(t,e){},post:function(t,e,n){var i=$();r.onmessage=function(t){t.data.id===i&&e(t.data.message)},r.postMessage({id:i,message:t},n)},terminate:function(){r.terminate(),URL.revokeObjectURL(n)}}},Ar=function(t){return new Promise((function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=function(t){n(t)},r.src=t}))},Pr=function(t,e){var n=t.slice(0,t.size,t.type);return n.lastModifiedDate=t.lastModifiedDate,n.name=e,n},Lr=function(t){return Pr(t,t.name)},Nr=[],Gr=function(t){var n;Nr.includes(t)||(Nr.push(t),n=t({addFilter:gt,utils:{Type:ft,forin:e,isString:P,isFile:ne,toNaturalFileSize:Ee,replaceInString:Dr,getExtensionFromFilename:Lt,getFilenameWithoutExtension:ee,guesstimateMimeType:xn,getFileFromBlob:kt,getFilenameFromURL:Pt,createRoute:S,createWorker:xr,createView:I,createItemAPI:at,loadImage:Ar,copyFile:Lr,renameFile:Pr,createBlob:Bt,applyFilterChain:pt,text:he,getNumericAspectRatioFromString:_t},views:{fileActionButton:me}}).options,Object.assign(mt,n))},kr=(De=c()&&!("[object OperaMini]"===Object.prototype.toString.call(window.operamini))&&"visibilityState"in document&&"Promise"in window&&"slice"in Blob.prototype&&"URL"in window&&"createObjectURL"in window.URL&&"performance"in window&&("supports"in(window.CSS||{})||/MSIE|Trident/.test(window.navigator.userAgent)),function(){return De}),Br={apps:[]},zr=function(){};if(t.Status={},t.FileStatus={},t.FileOrigin={},t.OptionTypes={},t.create=zr,t.destroy=zr,t.parse=zr,t.find=zr,t.registerPlugin=zr,t.getOptions=zr,t.setOptions=zr,kr()){!function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,r="__framePainter";if(window[r])return window[r].readers.push(t),void window[r].writers.push(e);window[r]={readers:[t],writers:[e]};var i=window[r],o=1e3/n,a=null,s=null,u=null,l=null,c=function(){document.hidden?(u=function(){return window.setTimeout((function(){return f(performance.now())}),o)},l=function(){return window.clearTimeout(s)}):(u=function(){return window.requestAnimationFrame(f)},l=function(){return window.cancelAnimationFrame(s)})};document.addEventListener("visibilitychange",(function(){l&&l(),c(),f(performance.now())}));var f=function t(e){s=u(t),a||(a=e);var n=e-a;n<=o||(a=e-n%o,i.readers.forEach((function(t){return t()})),i.writers.forEach((function(t){return t(e)})))};c(),f(performance.now())}((function(){Br.apps.forEach((function(t){return t._read()}))}),(function(t){Br.apps.forEach((function(e){return e._write(t)}))}));var Fr=function e(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:kr,create:t.create,destroy:t.destroy,parse:t.parse,find:t.find,registerPlugin:t.registerPlugin,setOptions:t.setOptions}})),document.removeEventListener("DOMContentLoaded",e)};"loading"!==document.readyState?setTimeout((function(){return Fr()}),0):document.addEventListener("DOMContentLoaded",Fr);var Ur=function(){return e(vt(),(function(e,n){t.OptionTypes[e]=n[1]}))};t.Status=Object.assign({},yt),t.FileOrigin=Object.assign({},ut),t.FileStatus=Object.assign({},st),t.OptionTypes={},Ur(),t.create=function(){var e=Or.apply(void 0,arguments);return e.on("destroy",t.destroy),Br.apps.push(e),Mr(e)},t.destroy=function(t){var e=Br.apps.findIndex((function(e){return e.isAttachedTo(t)}));return e>=0&&(Br.apps.splice(e,1)[0].restoreElement(),!0)},t.parse=function(e){return Array.from(e.querySelectorAll(".filepond")).filter((function(t){return!Br.apps.find((function(e){return e.isAttachedTo(t)}))})).map((function(e){return t.create(e)}))},t.find=function(t){var e=Br.apps.find((function(e){return e.isAttachedTo(t)}));return e?Mr(e):null},t.registerPlugin=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(Gr),Ur()},t.getOptions=function(){var t={};return e(vt(),(function(e,n){t[e]=n[0]})),t},t.setOptions=function(n){return U(n)&&(Br.apps.forEach((function(t){t.setOptions(n)})),function(t){e(t,(function(t,e){mt[t]&&(mt[t][0]=Y(e,mt[t][0],mt[t][1]))}))}(n)),t.getOptions()}}t.supported=kr,Object.defineProperty(t,"__esModule",{value:!0})})),function(t){"use strict";t.browser||(t.browser={},t.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),t.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),t.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),t.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var e={destroy:function(){return t(this).unbind(".maskMoney"),t.browser.msie&&(this.onpaste=null),this},mask:function(e){return this.each((function(){var n,r=t(this);return"number"==typeof e&&(r.trigger("mask"),n=t(r.val().split(/\D/)).last()[0].length,e=e.toFixed(n),r.val(e)),r.trigger("mask")}))},unmasked:function(){return this.map((function(){var e,n=t(this).val()||"0",r=-1!==n.indexOf("-");return t(n.split(/\D/).reverse()).each((function(t,n){return n?(e=n,!1):void 0})),n=(n=n.replace(/\D/g,"")).replace(new RegExp(e+"$"),"."+e),r&&(n="-"+n),parseFloat(n)}))},init:function(e){return e=t.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1},e),this.each((function(){function n(){var t,e,n,r,i,o=p.get(0),a=0,s=0;return"number"==typeof o.selectionStart&&"number"==typeof o.selectionEnd?(a=o.selectionStart,s=o.selectionEnd):(e=document.selection.createRange())&&e.parentElement()===o&&(r=o.value.length,t=o.value.replace(/\r\n/g,"\n"),(n=o.createTextRange()).moveToBookmark(e.getBookmark()),(i=o.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",i)>-1?a=s=r:(a=-n.moveStart("character",-r),a+=t.slice(0,a).split("\n").length-1,n.compareEndPoints("EndToEnd",i)>-1?s=r:(s=-n.moveEnd("character",-r),s+=t.slice(0,s).split("\n").length-1))),{start:a,end:s}}function r(t){var n="";return t.indexOf("-")>-1&&(t=t.replace("-",""),n="-"),n+e.prefix+t+e.suffix}function i(t){var n,i,o,a=t.indexOf("-")>-1&&e.allowNegative?"-":"",s=t.replace(/[^0-9]/g,""),u=s.slice(0,s.length-e.precision);return""===(u=(u=u.replace(/^0*/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,e.thousands))&&(u="0"),n=a+u,e.precision>0&&(i=s.slice(s.length-e.precision),o=new Array(e.precision+1-i.length).join(0),n+=e.decimal+o+i),r(n)}function o(t){var e=p.val().length;p.val(i(p.val())),function(t){p.each((function(e,n){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var r=n.createTextRange();r.collapse(!0),r.moveEnd("character",t),r.moveStart("character",t),r.select()}}))}(t-=e-p.val().length)}function a(){var t=p.val();p.val(i(t))}function s(){var t=p.val();return e.allowNegative?""!==t&&"-"===t.charAt(0)?t.replace("-",""):"-"+t:t}function u(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function l(e){var r,i,a,l,c,f=(e=e||window.event).which||e.charCode||e.keyCode;return void 0!==f&&(48>f||f>57?45===f?(p.val(s()),!1):43===f?(p.val(p.val().replace("-","")),!1):13===f||9===f||(!(!t.browser.mozilla||37!==f&&39!==f||0!==e.charCode)||(u(e),!0)):!!function(){var t=!(p.val().length>=p.attr("maxlength")&&p.attr("maxlength")>=0),e=n(),r=e.start,i=e.end,o=!(e.start===e.end||!p.val().substring(r,i).match(/\d/)),a="0"===p.val().substring(0,1);return t||o||a}()&&(u(e),r=String.fromCharCode(f),a=(i=n()).start,l=i.end,c=p.val(),p.val(c.substring(0,a)+r+c.substring(l,c.length)),o(a+1),!1))}function c(){setTimeout((function(){a()}),0)}function f(){return(parseFloat("0")/Math.pow(10,e.precision)).toFixed(e.precision).replace(new RegExp("\\.","g"),e.decimal)}var d,p=t(this);e=t.extend(e,p.data()),p.unbind(".maskMoney"),p.bind("keypress.maskMoney",l),p.bind("keydown.maskMoney",(function(t){var r,i,a,s,l,c=(t=t||window.event).which||t.charCode||t.keyCode;return void 0!==c&&(i=(r=n()).start,a=r.end,8!==c&&46!==c&&63272!==c||(u(t),s=p.val(),i===a&&(8===c?""===e.suffix?i-=1:(l=s.split("").reverse().join("").search(/\d/),a=(i=s.length-l-1)+1):a+=1),p.val(s.substring(0,i)+s.substring(a,s.length)),o(i),!1))})),p.bind("blur.maskMoney",(function(n){if(t.browser.msie&&l(n),""===p.val()||p.val()===r(f()))e.allowZero?e.affixesStay?p.val(r(f())):p.val(f()):p.val("");else if(!e.affixesStay){var i=p.val().replace(e.prefix,"").replace(e.suffix,"");p.val(i)}p.val()!==d&&p.change()})),p.bind("focus.maskMoney",(function(){d=p.val(),a();var t,e=p.get(0);e.createTextRange&&((t=e.createTextRange()).collapse(!1),t.select())})),p.bind("click.maskMoney",(function(){var t,e=p.get(0);e.setSelectionRange?(t=p.val().length,e.setSelectionRange(t,t)):p.val(p.val())})),p.bind("cut.maskMoney",c),p.bind("paste.maskMoney",c),p.bind("mask.maskMoney",a)}))}};t.fn.maskMoney=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist on jQuery.maskMoney"):e.init.apply(this,arguments)}}(window.jQuery||window.Zepto),function(t,e,n,r){function i(e,i){this.w=t(n),this.el=t(e),(i=i||s).rootClass!==r&&"dd"!==i.rootClass&&(i.listClass=i.listClass?i.listClass:i.rootClass+"-list",i.itemClass=i.itemClass?i.itemClass:i.rootClass+"-item",i.dragClass=i.dragClass?i.dragClass:i.rootClass+"-dragel",i.handleClass=i.handleClass?i.handleClass:i.rootClass+"-handle",i.collapsedClass=i.collapsedClass?i.collapsedClass:i.rootClass+"-collapsed",i.placeClass=i.placeClass?i.placeClass:i.rootClass+"-placeholder",i.noDragClass=i.noDragClass?i.noDragClass:i.rootClass+"-nodrag",i.noChildrenClass=i.noChildrenClass?i.noChildrenClass:i.rootClass+"-nochildren",i.emptyClass=i.emptyClass?i.emptyClass:i.rootClass+"-empty"),this.options=t.extend({},s,i),this.options.json!==r&&this._build(),this.init()}var o="ontouchstart"in n,a=function(){var t=n.createElement("div"),r=n.documentElement;if(!("pointerEvents"in t.style))return!1;t.style.pointerEvents="auto",t.style.pointerEvents="x",r.appendChild(t);var i=e.getComputedStyle&&"auto"===e.getComputedStyle(t,"").pointerEvents;return r.removeChild(t),!!i}(),s={contentCallback:function(t){return t.content?t.content:t.id},listNodeName:"ol",itemNodeName:"li",handleNodeName:"div",contentNodeName:"span",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",contentClass:"dd-content",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",noChildrenClass:"dd-nochildren",emptyClass:"dd-empty",expandBtnHTML:'<button class="dd-expand" data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button class="dd-collapse" data-action="collapse" type="button">Collapse</button>',group:0,maxDepth:5,threshold:20,fixedDepth:!1,fixed:!1,includeContent:!1,scroll:!1,scrollSensitivity:1,scrollSpeed:5,scrollTriggers:{top:40,left:40,right:-40,bottom:-40},effect:{animation:"none",time:"slow"},callback:function(t,e,n){},onDragStart:function(t,e,n){},beforeDragStop:function(t,e,n){},listRenderer:function(t,e){var n="<"+e.listNodeName+' class="'+e.listClass+'">';return(n+=t)+"</"+e.listNodeName+">"},itemRenderer:function(e,n,r,i,o){var a=t.map(e,(function(t,e){return" "+e+'="'+t+'"'})).join(" "),s="<"+i.itemNodeName+a+">";return s+="<"+i.handleNodeName+' class="'+i.handleClass+'">',s+="<"+i.contentNodeName+' class="'+i.contentClass+'">',s+=n,s+="</"+i.contentNodeName+">",s+="</"+i.handleNodeName+">",(s+=r)+"</"+i.itemNodeName+">"}};i.prototype={init:function(){var n=this;n.reset(),n.el.data("nestable-group",this.options.group),n.placeEl=t('<div class="'+n.options.placeClass+'"/>');var r=this.el.find(n.options.itemNodeName);t.each(r,(function(e,r){var i=t(r),o=i.parent();n.setParent(i),o.hasClass(n.options.collapsedClass)&&n.collapseItem(o.parent())})),r.length||this.appendEmptyElement(this.el),n.el.on("click","button",(function(e){if(!n.dragEl){var r=t(e.currentTarget),i=r.data("action"),o=r.parents(n.options.itemNodeName).eq(0);"collapse"===i&&n.collapseItem(o),"expand"===i&&n.expandItem(o)}}));var i=function(e){var r=t(e.target);if(!r.hasClass(n.options.handleClass)){if(r.closest("."+n.options.noDragClass).length)return;r=r.closest("."+n.options.handleClass)}r.length&&!n.dragEl&&(n.isTouch=/^touch/.test(e.type),n.isTouch&&1!==e.touches.length||(e.preventDefault(),n.dragStart(e.touches?e.touches[0]:e)))},a=function(t){n.dragEl&&(t.preventDefault(),n.dragMove(t.touches?t.touches[0]:t))},s=function(t){n.dragEl&&(t.preventDefault(),n.dragStop(t.touches?t.changedTouches[0]:t))};o&&(n.el[0].addEventListener("touchstart",i,!1),e.addEventListener("touchmove",a,!1),e.addEventListener("touchend",s,!1),e.addEventListener("touchcancel",s,!1)),n.el.on("mousedown",i),n.w.on("mousemove",a),n.w.on("mouseup",s),n.el.bind("destroy-nestable",(function(){o&&(n.el[0].removeEventListener("touchstart",i,!1),e.removeEventListener("touchmove",a,!1),e.removeEventListener("touchend",s,!1),e.removeEventListener("touchcancel",s,!1)),n.el.off("mousedown",i),n.w.off("mousemove",a),n.w.off("mouseup",s),n.el.off("click"),n.el.unbind("destroy-nestable"),n.el.data("nestable",null)}))},destroy:function(){this.el.trigger("destroy-nestable")},add:function(e){var n="."+this.options.listClass,i=t(this.el).children(n);e.parent_id!==r&&(i=i.find('[data-id="'+e.parent_id+'"]'),delete e.parent_id,0===i.children(n).length&&(i=i.append(this.options.listRenderer("",this.options))),i=i.find(n+":first"),this.setParent(i.parent())),i.append(this._buildItem(e,this.options))},replace:function(t){var e=this._buildItem(t,this.options);this._getItemById(t.id).replaceWith(e)},removeItem:function(e){var n=this.options,r=this.el;(e=e||this).remove();var i="."+n.listClass+" ."+n.listClass+":not(:has(*))";t(r).find(i).remove(),t(r).find('[data-action="expand"], [data-action="collapse"]').each((function(){0===t(this).siblings("."+n.listClass).length&&t(this).remove()}))},remove:function(t,e){var n=this.options,r=this,i=this._getItemById(t),o=n.effect.animation||"fade",a=n.effect.time||"slow";"fade"===o?i.fadeOut(a,(function(){r.removeItem(i)})):this.removeItem(i),e&&e()},removeAll:function(e){function n(){a.each((function(){r.removeItem(t(this))})),o.show(),e&&e()}var r=this,i=this.options,o=r.el.find(i.listNodeName).first(),a=o.children(i.itemNodeName),s=i.effect.animation||"fade",u=i.effect.time||"slow";"fade"===s?o.fadeOut(u,n):n()},_getItemById:function(e){return t(this.el).children("."+this.options.listClass).find('[data-id="'+e+'"]')},_build:function(){var e=this.options.json;"string"==typeof e&&(e=JSON.parse(e)),t(this.el).html(this._buildList(e,this.options))},_buildList:function(e,n){if(!e)return"";var r="",i=this;return t.each(e,(function(t,e){r+=i._buildItem(e,n)})),n.listRenderer(r,n)},_buildItem:function(e,n){var r=function(e){delete(e=t.extend({},e)).children,delete e.classes,delete e.content;var n={};return t.each(e,(function(t,e){"object"==typeof e&&(e=JSON.stringify(e)),n["data-"+t]=function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t+"".replace(/[&<>"']/g,(function(t){return e[t]}))}(e)})),n}(e);r.class=function(e,n){var r=e.classes||{};"string"==typeof r&&(r=[r]);var i=function(t){var e={};for(var n in t)e[t[n]]=t[n];return e}(r);return i[n.itemClass]=n.itemClass,t.map(i,(function(t){return t})).join(" ")}(e,n);var i=n.contentCallback(e),o=this._buildList(e.children,n),a=t(n.itemRenderer(r,i,o,n,e));return this.setParent(a),a[0].outerHTML},serialize:function(){var e=this,n=function(r){var i=[];return r.children(e.options.itemNodeName).each((function(){var r=t(this),o=t.extend({},r.data()),a=r.children(e.options.listNodeName);if(e.options.includeContent){var s=r.find("."+e.options.contentClass).html();s&&(o.content=s)}a.length&&(o.children=n(a)),i.push(o)})),i};return n(e.el.find(e.options.listNodeName).first())},asNestedSet:function(){function e(o,a,s){var u,l,c=s+1;return t(o).children(r.listNodeName).children(r.itemNodeName).length>0&&(a++,t(o).children(r.listNodeName).children(r.itemNodeName).each((function(){c=e(t(this),a,c)})),a--),n(u=t(o).attr("data-id"))&&(u=parseInt(u)),n(l=t(o).parent(r.listNodeName).parent(r.itemNodeName).attr("data-id")||"")&&(u=parseInt(l)),u&&i.push({id:u,parent_id:l,depth:a,lft:s,rgt:c}),c+1}function n(e){return t.isNumeric(e)&&Math.floor(e)==e}var r=this.options,i=[],o=1;return this.el.find(r.listNodeName).first().children(r.itemNodeName).each((function(){o=e(this,0,o)})),i=i.sort((function(t,e){return t.lft-e.lft}))},returnOptions:function(){return this.options},serialise:function(){return this.serialize()},toHierarchy:function(e){function n(e){var i=(t(e).attr(r.attribute||"id")||"").match(r.expression||/(.+)[-=_](.+)/);if(i){var o={id:i[2]};return t(e).children(r.listType).children(r.items).length>0&&(o.children=[],t(e).children(r.listType).children(r.items).each((function(){var t=n(this);o.children.push(t)}))),o}}var r=t.extend({},this.options,e),i=[];return t(this.element).children(r.items).each((function(){var t=n(this);i.push(t)})),i},toArray:function(){function e(o,a,s){var u,l,c=s+1;return o.children(n.options.listNodeName).children(n.options.itemNodeName).length>0&&(a++,o.children(n.options.listNodeName).children(n.options.itemNodeName).each((function(){c=e(t(this),a,c)})),a--),u=o.data().id,l=a===r+1?n.rootID:o.parent(n.options.listNodeName).parent(n.options.itemNodeName).data().id,u&&i.push({id:u,parent_id:l,depth:a,left:s,right:c}),c+1}var n=t.extend({},this.options,this),r=n.startDepthCount||0,i=[],o=2,a=this;return a.el.find(a.options.listNodeName).first().children(a.options.itemNodeName).each((function(){o=e(t(this),r+1,o)})),i=i.sort((function(t,e){return t.left-e.left}))},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.isTouch=!1,this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null},expandItem:function(t){t.removeClass(this.options.collapsedClass)},collapseItem:function(t){t.children(this.options.listNodeName).length&&t.addClass(this.options.collapsedClass)},expandAll:function(){var e=this;e.el.find(e.options.itemNodeName).each((function(){e.expandItem(t(this))}))},collapseAll:function(){var e=this;e.el.find(e.options.itemNodeName).each((function(){e.collapseItem(t(this))}))},setParent:function(e){e.is(this.options.itemNodeName)&&e.children(this.options.listNodeName).length&&(e.children("[data-action]").remove(),e.prepend(t(this.options.expandBtnHTML)),e.prepend(t(this.options.collapseBtnHTML)))},unsetParent:function(t){t.removeClass(this.options.collapsedClass),t.children("[data-action]").remove(),t.children(this.options.listNodeName).remove()},dragStart:function(e){var r=this.mouse,i=t(e.target).closest(this.options.itemNodeName),o={top:e.pageY,left:e.pageX},a=this.options.onDragStart.call(this,this.el,i,o);if(void 0===a||!1!==a){this.placeEl.css("height",i.height()),r.offsetX=e.pageX-i.offset().left,r.offsetY=e.pageY-i.offset().top,r.startX=r.lastX=e.pageX,r.startY=r.lastY=e.pageY,this.dragRootEl=this.el,this.dragEl=t(n.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",i.outerWidth()),this.setIndexOfItem(i),i.after(this.placeEl),i[0].parentNode.removeChild(i[0]),i.appendTo(this.dragEl),t(n.body).append(this.dragEl),this.dragEl.css({left:e.pageX-r.offsetX,top:e.pageY-r.offsetY});var s,u,l=this.dragEl.find(this.options.itemNodeName);for(s=0;s<l.length;s++)(u=t(l[s]).parents(this.options.listNodeName).length)>this.dragDepth&&(this.dragDepth=u)}},createSubLevel:function(e,n){var r=t("<"+this.options.listNodeName+"/>").addClass(this.options.listClass);return n&&r.append(n),e.append(r),this.setParent(e),r},setIndexOfItem:function(e,n){(n=n||[]).unshift(e.index()),t(e[0].parentNode)[0]!==this.dragRootEl[0]?this.setIndexOfItem(t(e[0].parentNode),n):this.dragEl.data("indexOfItem",n)},restoreItemAtIndex:function(e,n){for(var r=this.el,i=n.length-1,o=0;o<n.length;o++){if(i===parseInt(o))return void function(e,r){0===n[i]?t(e).prepend(r.clone(!0)):t(e.children[n[i]-1]).after(r.clone(!0))}(r,e);var a=r[0]?r[0]:r;r=a.children[n[o]]||this.createSubLevel(t(a))}},dragStop:function(t){var e={top:t.pageY,left:t.pageX},n=this.dragEl.data("indexOfItem"),r=this.dragEl.children(this.options.itemNodeName).first();r[0].parentNode.removeChild(r[0]),this.dragEl.remove();var i=this.options.beforeDragStop.call(this,this.el,r,this.placeEl.parent());if(void 0!==i&&!1===i){var o=this.placeEl.parent();return this.placeEl.remove(),o.children().length||this.unsetParent(o.parent()),this.restoreItemAtIndex(r,n),void this.reset()}this.placeEl.replaceWith(r),this.hasNewRoot?(!0===this.options.fixed?this.restoreItemAtIndex(r,n):this.el.trigger("lostItem"),this.dragRootEl.trigger("gainedItem")):this.dragRootEl.trigger("change"),this.options.callback.call(this,this.dragRootEl,r,e),this.reset()},dragMove:function(r){var i,o,s,u=this.options,l=this.mouse;this.dragEl.css({left:r.pageX-l.offsetX,top:r.pageY-l.offsetY}),l.lastX=l.nowX,l.lastY=l.nowY,l.nowX=r.pageX,l.nowY=r.pageY,l.distX=l.nowX-l.lastX,l.distY=l.nowY-l.lastY,l.lastDirX=l.dirX,l.lastDirY=l.dirY,l.dirX=0===l.distX?0:l.distX>0?1:-1,l.dirY=0===l.distY?0:l.distY>0?1:-1;var c=Math.abs(l.distX)>Math.abs(l.distY)?1:0;if(!l.moving)return l.dirAx=c,void(l.moving=!0);if(u.scroll)if(void 0!==e.jQuery.fn.scrollParent){var f=!1,d=this.el.scrollParent()[0];d!==n&&"HTML"!==d.tagName?(u.scrollTriggers.bottom+d.offsetHeight-r.pageY<u.scrollSensitivity?d.scrollTop=f=d.scrollTop+u.scrollSpeed:r.pageY-u.scrollTriggers.top<u.scrollSensitivity&&(d.scrollTop=f=d.scrollTop-u.scrollSpeed),u.scrollTriggers.right+d.offsetWidth-r.pageX<u.scrollSensitivity?d.scrollLeft=f=d.scrollLeft+u.scrollSpeed:r.pageX-u.scrollTriggers.left<u.scrollSensitivity&&(d.scrollLeft=f=d.scrollLeft-u.scrollSpeed)):(r.pageY-t(n).scrollTop()<u.scrollSensitivity?f=t(n).scrollTop(t(n).scrollTop()-u.scrollSpeed):t(e).height()-(r.pageY-t(n).scrollTop())<u.scrollSensitivity&&(f=t(n).scrollTop(t(n).scrollTop()+u.scrollSpeed)),r.pageX-t(n).scrollLeft()<u.scrollSensitivity?f=t(n).scrollLeft(t(n).scrollLeft()-u.scrollSpeed):t(e).width()-(r.pageX-t(n).scrollLeft())<u.scrollSensitivity&&(f=t(n).scrollLeft(t(n).scrollLeft()+u.scrollSpeed)))}else console.warn("To use scrolling you need to have scrollParent() function, check documentation for more information");this.scrollTimer&&clearTimeout(this.scrollTimer),u.scroll&&f&&(this.scrollTimer=setTimeout((function(){t(e).trigger(r)}),10)),l.dirAx!==c?(l.distAxX=0,l.distAxY=0):(l.distAxX+=Math.abs(l.distX),0!==l.dirX&&l.dirX!==l.lastDirX&&(l.distAxX=0),l.distAxY+=Math.abs(l.distY),0!==l.dirY&&l.dirY!==l.lastDirY&&(l.distAxY=0)),l.dirAx=c,l.dirAx&&l.distAxX>=u.threshold&&(l.distAxX=0,s=this.placeEl.prev(u.itemNodeName),l.distX>0&&s.length&&!s.hasClass(u.collapsedClass)&&!s.hasClass(u.noChildrenClass)&&(i=s.find(u.listNodeName).last(),this.placeEl.parents(u.listNodeName).length+this.dragDepth<=u.maxDepth&&(i.length?(i=s.children(u.listNodeName).last()).append(this.placeEl):this.createSubLevel(s,this.placeEl))),l.distX<0&&(this.placeEl.next(u.itemNodeName).length||(o=this.placeEl.parent(),this.placeEl.closest(u.itemNodeName).after(this.placeEl),o.children().length||this.unsetParent(o.parent()))));var p=!1;if(a||(this.dragEl[0].style.visibility="hidden"),this.pointEl=t(n.elementFromPoint(r.pageX-n.body.scrollLeft,r.pageY-(e.pageYOffset||n.documentElement.scrollTop))),a||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(u.handleClass)&&(this.pointEl=this.pointEl.closest(u.itemNodeName)),this.pointEl.hasClass(u.emptyClass))p=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(u.itemClass))return;var h=this.pointEl.closest("."+u.rootClass),g=this.dragRootEl.data("nestable-id")!==h.data("nestable-id");if(!l.dirAx||g||p){if(g&&u.group!==h.data("nestable-group"))return;if(this.options.fixedDepth&&this.dragDepth+1!==this.pointEl.parents(u.listNodeName).length)return;if(this.dragDepth-1+this.pointEl.parents(u.listNodeName).length>u.maxDepth)return;var v=r.pageY<this.pointEl.offset().top+this.pointEl.height()/2;o=this.placeEl.parent(),p?((i=t(n.createElement(u.listNodeName)).addClass(u.listClass)).append(this.placeEl),this.pointEl.replaceWith(i)):v?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),o.children().length||this.unsetParent(o.parent()),this.dragRootEl.find(u.itemNodeName).length||this.appendEmptyElement(this.dragRootEl),this.dragRootEl=h,g&&(this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}},appendEmptyElement:function(t){t.append('<div class="'+this.options.emptyClass+'"/>')}},t.fn.nestable=function(n){var r=this,o=this,a=arguments;return"Nestable"in e||(e.Nestable={},Nestable.counter=0),r.each((function(){var e=t(this).data("nestable");if(e){if("string"==typeof n&&"function"==typeof e[n])if(a.length>1){for(var r=[],s=1;s<a.length;s++)r.push(a[s]);o=e[n].apply(e,r)}else o=e[n]()}else Nestable.counter++,t(this).data("nestable",new i(this,n)),t(this).data("nestable-id",Nestable.counter)})),o||r}}(window.jQuery||window.Zepto,window,document),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Moveable=e()}(this,(function(){"use strict";var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};function e(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e){return function(n){n&&(t[e]=n)}}function i(t,e,n){return function(r){r&&(t[e][n]=r)}}function o(t,e){return function(n){var r=n.prototype;t.forEach((function(t){e(r,t)}))}}var a=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,i=n.indexOf(t);n[i=-1===i?n.length:i]=t,r[i]=e},t}(),s=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),u="function"==typeof Map,l=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}(),c=function(){function t(t,e,n,r,i,o,a,s){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=i,this.maintained=o,this.changedBeforeAdded=a,this.fixed=s}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){r=this.changedBeforeAdded,t=this.fixed,e=[],n=[],r.forEach((function(t){var r=t[0],i=(t=t[1],new l);e[r]=i,n[t]=i})),e.forEach((function(t,n){t.connect(e[n-1])}));var t,e,n,r=r.filter((function(e,n){return!t[n]})).map((function(t,r){if((i=t[0])===(t=t[1]))return[0,0];var i=e[i],o=(t=n[t-1],i.getIndex());return i.disconnect(),t?i.connect(t,t.next):i.connect(void 0,e[0]),[o,i.getIndex()]})),i=this.changed,o=[];this.cacheOrdered=r.filter((function(t,e){var n=t[0],r=(t=t[1],(e=i[e])[0]);e=e[1];if(n!==t)return o.push([r,e]),!0})),this.cachePureChanged=o},t}();function f(t,e,n){var r=u?Map:n?s:a,i=(n=n||function(t){return t},[]),o=[],l=[],f=t.map(n),d=(n=e.map(n),new r),p=new r,h=[],g=[],v={},m=[],E=0,_=0;return f.forEach((function(t,e){d.set(t,e)})),n.forEach((function(t,e){p.set(t,e)})),f.forEach((function(t,e){void 0===(t=p.get(t))?(++_,o.push(e)):v[t]=_})),n.forEach((function(t,e){void 0===(t=d.get(t))?(i.push(e),++E):(l.push([t,e]),_=v[e]||0,h.push([t-_,e-E]),g.push(e===t),t!==e&&m.push([t,e]))})),o.reverse(),new c(t,e,i,o,m,l,h,g)}var d=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){t=[].slice.call(t);var e=f(this.list,t,this.findKeyCallback);return this.list=t,e},t}(),p="undefined",h=typeof window!==p,g=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],v=1e-7,m={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return t/100*(void 0===e?window.innerWidth:e)},vh:function(t,e){return t/100*(void 0===e?window.innerHeight:e)},vmax:function(t,e){return t/100*(void 0===e?Math.max(window.innerWidth,window.innerHeight):e)},vmin:function(t,e){return t/100*(void 0===e?Math.min(window.innerWidth,window.innerHeight):e)}};function E(t,e,n,r){return(t*r+e*n)/(n+r)}function _(t){return typeof t===p}function b(t){return t&&"object"==typeof t}function y(t){return Array.isArray(t)}function T(t){return"string"==typeof t}function I(t){return"number"==typeof t}function S(t){return"function"==typeof t}function R(t,e,n,r,i){if(w(t,e,n))return n;for(var o,a=t,s=e,u=r,l=i,c=n+1;c<u;++c){var f=function(t){var e,n,r=s[t].trim();return r!==a.close||w(a,s,t)?(e=t,-1===(e=(n=N(l,(function(t){return t.open===r})))?R(n,s,t,u,l):e)?(o=t,"break"):void(o=t=e)):{value:t}}(c);if(c=o,"object"==typeof f)return f.value;if("break"===f)break}return-1}function w(t,e,n){return t.ignore?(e=e.slice(Math.max(n-3,0),n+3).join(""),new RegExp(t.ignore).exec(e)):null}function O(t,e){var n=void 0===(s=(e=T(e)?{separator:e}:e).separator)?",":s,r=e.isSeparateFirst,i=e.isSeparateOnlyOpenClose,o=void 0===(s=e.isSeparateOpenClose)?i:s,a=void 0===(s=e.openCloseCharacters)?g:s,s=(e=a.map((function(t){var e=t.open;return e===(t=t.close)?e:e+"|"+t})).join("|"),new RegExp("(\\s*"+n+"\\s*|"+e+"|\\s+)","g")),u=t.split(s).filter(Boolean),l=u.length,c=[],f=[];function d(){return f.length&&(c.push(f.join("")),f=[])}for(var p,h=function(e){var s=u[e].trim(),h=e,g=N(a,(function(t){return t.open===s})),v=N(a,(function(t){return t.close===s}));if(g){if(-1!==(h=R(g,u,e,l,a))&&o)return d()&&r?(p=e,"break"):(c.push(u.slice(e,h+1).join("")),e=h,r?(p=e,"break"):(p=e,"continue"))}else{if(v&&!w(v,u,e))return(g=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(a)).splice(a.indexOf(v),1),{value:O(t,{separator:n,isSeparateFirst:r,isSeparateOnlyOpenClose:i,isSeparateOpenClose:o,openCloseCharacters:g})};if(v=s,!((""!==(g=n)&&" "!=g||""!==v&&" "!=v)&&v!==g||i))return d(),r?(p=e,"break"):(p=e,"continue")}f.push(u.slice(e,(h=-1===h?l-1:h)+1).join("")),p=e=h},v=0;v<l;++v){var m=h(v);v=p;if("object"==typeof m)return m.value;if("break"===m)break}return f.length&&c.push(f.join("")),c}function C(t){return O(t,"")}function M(t){return O(t,",")}function D(t){return!(t=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t))||t.length<4?{}:{prefix:t[1],value:t[2],suffix:t[3]}}function x(t){if(!(t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t)))return{prefix:"",unit:"",value:NaN};var e=t[1],n=t[2];return{prefix:e,unit:t[3],value:parseFloat(n)}}function A(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,n,r){return""+n+e+r.toLowerCase()}))}function P(){return Date.now?Date.now():(new Date).getTime()}function L(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function N(t,e,n){return-1<(e=L(t,e))?t[e]:n}var G=function(){var t=P(),e=h&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var n=P();return window.setTimeout((function(){e(n-t)}),1e3/60)}}(),k=function(){var t=h&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(t){clearTimeout(t)}}();function B(t){return Object.keys(t)}function z(t,e){var n=(t=x(t)).value;t=t.unit;if(b(e)){var r=e[t];if(r){if(S(r))return r(n);if(m[t])return m[t](n,r)}}else if("%"===t)return n*e/100;return m[t]?m[t](n):n}function F(t,e,n){return Math.max(e,Math.min(t,n))}function U(t,e,n,r){return void 0===r&&(r=t[0]/t[1]),[[W(e[0],v),W(e[0]/r,v)],[W(e[1]*r,v),W(e[1],v)]].filter((function(t){return t.every((function(t,r){var i=W(r=e[r],v);return n?t<=r||t<=i:r<=t||i<=t}))}))[0]||t}function q(t){for(var e=t.length,n=0,r=e-1;0<=r;--r)n+=t[r];return e?n/e:0}function V(t,e){var n=e[0]-t[0];e=e[1]-t[1];return 0<=(t=Math.atan2(e,n))?t:t+2*Math.PI}function Y(t){e=t;var e,n=[0,1].map((function(t){return q(e.map((function(e){return e[t]})))})),r=V(n,t[0]);return r<(n=V(n,t[1]))&&n-r<Math.PI||n<r&&n-r<-Math.PI?1:-1}function j(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function W(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function X(t,e){t.forEach((function(n,r){t[r]=W(t[r],e)}))}function H(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function $(t,e,n,r){t.addEventListener(e,n,r)}function Z(t,e,n,r){t.removeEventListener(e,n,r)}var Q=function(t,e){return(Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function K(t,e){function n(){this.constructor=t}Q(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var J=function(){return(J=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function tt(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function et(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function nt(t,e){var n=Object.keys(t),r=Object.keys(e),i=f(n,r,(function(t){return t})),o={},a={},s={};return i.added.forEach((function(t){t=r[t],o[t]=e[t]})),i.removed.forEach((function(e){e=n[e],a[e]=t[e]})),i.maintained.forEach((function(r){r=r[0],r=n[r];var i=[t[r],e[r]];t[r]!==e[r]&&(s[r]=i)})),{added:o,removed:a,changed:s}}function rt(t){t.forEach((function(t){t()}))}function it(t){var e=0;return t.map((function(t){return null==t?"$compat"+ ++e:""+t}))}function ot(t,e,n,r){return T(t)||I(t)?new ft("text_"+t,e,n,r,null,{}):new("string"==typeof t.type?dt:t.type.prototype.render?mt:gt)(t.type,e,n,r,t.ref,t.props)}function at(t){var e=t.className;t=tt(t,["className"]);return null!=e&&(t.class=e),delete t.style,delete t.children,t}function st(t,e){if(!e)return t;for(var n in e)_(t[n])&&(t[n]=e[n]);return t}function ut(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=(e=e||{}).key,o=e.ref;e=tt(e,["key","ref"]);return{type:t,key:i,ref:o,props:J(J({},e),{children:function t(e){var n=[];return e.forEach((function(e){n=n.concat(y(e)?t(e):e)})),n}(n).filter((function(t){return null!=t&&!1!==t}))})}}var lt=function(){function t(t,e,n,r,i,o){void 0===o&&(o={}),this.type=t,this.key=e,this.index=n,this.container=r,this.ref=i,this.props=o,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,n,r){return!(this.base&&!T(e)&&!r&&!this._should(e.props,n))&&(this.original=e,this._setState(n),r=this.props,T(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?r:{},n),!0)},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function ct(t){var e,n={},r={};for(e in t)0===e.indexOf("on")?r[e.replace("on","").toLowerCase()]=t[e]:n[e]=t[e];return{attributes:n,events:r}}var ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}K(e,t);var n=e.prototype;return n._render=function(t){var e=this,n=!this.base;return n&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push((function(){n?e._mounted():e._updated()})),!0},n._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(lt),dt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.events={},e._isSVG=!1,e}K(e,t);var n=e.prototype;return n.addEventListener=function(t,e){var n=this.events;n[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,n[t])},n.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},n._should=function(t){return et(this.props,t)},n._render=function(t,e){var n,r=this,i=!this.base,o=(i&&(o=this._hasSVG(),this._isSVG=o,(a=this.props.portalContainer)||(s=this.type,a=o?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)),this.base=a),bt(this,this._providers,this.props.children,t,null),this.base),a=(s=ct(e)).attributes,s=s.events,u=(l=ct(this.props)).attributes,l=l.events,c=o,f=(a=nt(a=at(a),u=at(u))).added,d=(u=a.removed,a.changed);for(n in f)c.setAttribute(n,f[n]);for(n in d)c.setAttribute(n,d[n][1]);for(n in u)c.removeAttribute(n);var p,h=this,g=(u=nt(u=s,s=l)).added,v=(s=u.removed,u.changed);for(p in s)h.removeEventListener(p);for(p in g)h.addEventListener(p,g[p]);for(p in v)h.removeEventListener(p),h.addEventListener(p,v[p][1]);for(p in s)h.removeEventListener(p);l=e.style||{},u=this.props.style||{};var m,E=(e=o).style,_=(e=nt(l,u)).added,b=(l=e.removed,e.changed);for(m in _){var y=A(m,"-");E.setProperty?E.setProperty(y,_[m]):E[y]=_[m]}for(m in b)y=A(m,"-"),E.setProperty?E.setProperty(y,b[m][1]):E[y]=b[m][1];for(m in l)y=A(m,"-"),E.removeProperty?E.removeProperty(y):E[y]="";return t.push((function(){i?r._mounted():r._updated()})),!0},n._unmount=function(){var t,e=this.events,n=this.base;for(t in e)n.removeEventListener(t,e[t]);this._providers.forEach((function(t){t._unmount()})),this.events={},this.props.portalContainer||n.parentNode.removeChild(n)},n._hasSVG=function(){if(this._isSVG||"svg"===this.type)return!0;var t=pt(this.container);return t&&"ownerSVGElement"in t},e}(lt);function pt(t){if(!t)return null;var e=t.base;return e instanceof Node?e:pt(t.container)}function ht(t){return t?t instanceof Node?t:(t=t.$_provider._providers).length?ht(t[0].base):null:null}var gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}K(e,t);var n=e.prototype;return n._render=function(t){var e=this.type(this.props);return bt(this,this._providers,e?[e]:[],t),!0},n._unmount=function(){this._providers.forEach((function(t){t._unmount()}))},e}(lt),vt=function(t){function e(e){var n=t.call(this,"container","container",0,null)||this;return n.base=e,n}K(e,t);var n=e.prototype;return n._render=function(){return!0},n._unmount=function(){},e}(lt),mt=function(t){function e(e,n,r,i,o,a){return t.call(this,e,n,r,i,o,st(a=void 0===a?{}:a,e.defaultProps))||this}K(e,t);var n=e.prototype;return n._should=function(t,e){return this.base.shouldComponentUpdate(st(t,this.type.defaultProps),e||this.base.state)},n._render=function(t,e){var n=this,r=(this.props=st(this.props,this.type.defaultProps),!this.base),i=(r?(this.base=new this.type(this.props),this.base.$_provider=this):this.base.props=this.props,this.base),o=i.state,a=i.render();a&&a.props&&!a.props.children.length&&(a.props.children=this.props.children),bt(this,this._providers,a?[a]:[],t),t.push((function(){r?(n._mounted(),i.componentDidMount()):(n._updated(),i.componentDidUpdate(e,o))}))},n._setState=function(t){var e=this.base;e&&t&&(e.state=t)},n._unmount=function(){this._providers.forEach((function(t){t._unmount()})),clearTimeout(this.base.$_timer),this.base.componentWillUnmount()},e}(lt),Et=(lt=function(){function t(t){this.props=t=void 0===t?{}:t,this.state={},this.$_timer=0,this.$_state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,n){var r=this;this.$_timer||(this.$_state={}),clearTimeout(this.$_timer),this.$_timer=0,this.$_state=J(J({},this.$_state),t),n?this.$_setState(e,n):this.$_timer=setTimeout((function(){r.$_timer=0,r.$_setState(e,n)}))},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},e.$_setState=function(t,e){var n=[],r=this.$_provider;bt(r.container,[r],[r.original],n,J(J({},this.state),this.$_state),e)&&(t&&n.push(t),rt(n))},t}(),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return K(e,t),e.prototype.shouldComponentUpdate=function(t,e){return et(this.props,t)||et(this.state,e)},e}(lt)),_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}K(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=(e=this.props).element,e=e.container;this._portalProvider=new vt(e),yt(t,e,this._portalProvider)},n.componentDidUpdate=function(){var t=this.props;yt(t.element,t.container,this._portalProvider)},n.componentWillUnmount=function(){yt(null,this.props.container,this._portalProvider),this._portalProvider=null},e}(Et);function bt(t,e,n,r,i,o){var a=function(t,e,n){var r=n.map((function(t){return T(t)?null:t.key})),i=f(it(e.map((function(t){return t.key}))),it(r),(function(t){return t})),o=(i.removed.forEach((function(t){e.splice(t,1)[0]._unmount()})),i.ordered.forEach((function(t){var n=t[0];t=t[1],n=e.splice(n,1)[0],e.splice(t,0,n),n=ht(n.base),t=ht(e[t+1]&&e[t+1].base),n&&n.parentNode.insertBefore(n,t)})),i.added.forEach((function(i){e.splice(i,0,ot(n[i],r[i],i,t))})),i.maintained.filter((function(i){i[0],i=i[1];var o=n[i],a=e[i];return(T(o)?"text_"+o:o.type)!==a.type?(a._unmount(),e.splice(i,1,ot(o,r[i],i,t)),!0):(a.index=i,!1)})));return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(i.added,o.map((function(t){return t[0],t[1]})))}(t,e,n),s=e.filter((function(t,e){return t._update(r,n[e],i,o)})),u=pt(t);return u&&a.reverse().forEach((function(n){var r=ht((n=e[n]).base);r&&u!==r&&!r.parentNode&&(n=function(t,e){for(var n=t._providers,r=n.length,i=e.index+1;i<r;++i){var o=ht(n[i].base);if(o)return o}return null}(t,n),u.insertBefore(r,n))})),0<s.length}function yt(t,e,n){var r,i=!!(n=void 0===n?e.__REACT_COMPAT__:n);t=t?[t]:[],r=[],bt(n=n||new vt(e),n._providers,t,r,undefined),rt(r),i||(e.__REACT_COMPAT__=n)}function Tt(t,e,n){var r=e.__REACT_COMPAT__;t&&!r&&(e.innerHTML=""),yt(t,e,r),n&&n()}function It(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function St(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function Rt(t){if(void 0===t){if("undefined"==typeof navigator||!navigator)return"";t=navigator.userAgent||""}return t.toLowerCase()}function wt(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function Ot(t){return t.replace(/_/g,".")}function Ct(t,e){var n=null,r="-1";return It(t,(function(t){var i=wt("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);if(i&&!t.brand)return n=t,r=i[3]||"-1",t.versionAlias?r=t.versionAlias:t.versionTest&&(i=t.versionTest.toLowerCase(),r=((i=wt("("+i+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e))?i[3]:"")||r),r=Ot(r),1})),{preset:n,version:r}}function Mt(t,e){var n={brand:"",version:"-1"};return It(t,(function(t){var r=Dt(e,t);return r&&(n.brand=t.id,n.version=t.versionAlias||r.version,"-1"!==n.version)})),n}function Dt(t,e){return St(t,(function(t){return t=t.brand,wt(""+e.test,t.toLowerCase())}))}var xt=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],At=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Pt=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Lt=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Nt=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Gt(t){return!!Ct(Lt,t).preset}function kt(t,e,n){void 0===n&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function Bt(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=ne(e),i=0;i<e;++i){var o=e*i+i;if(!W(n[o],v))for(var a=i+1;a<e;++a)if(n[e*i+a]){m=g=h=p=d=u=s=void 0;for(var s=n,u=r,l=i,c=a,f=e,d=0;d<f;++d){var p=l+d*f,h=c+d*f,g=s[p],m=u[p];s[p]=s[h],s[h]=g,u[p]=u[h],u[h]=m}break}if(!W(n[o],v))return[];S=I=_=E=void 0;for(var E=n,_=r,b=i,y=e,T=n[o],I=0;I<y;++I){var S=b+I*y;E[S]/=T,_[S]/=T}for(a=0;a<e;++a){var R=a,w=n[a+i*e];if(W(w,v)&&i!==a){N=L=P=C=O=void 0;for(var O=n,C=r,M=R,D=i,x=e,A=-w,P=0;P<x;++P){var L=M+P*x,N=D+P*x;O[L]+=O[N]*A,C[L]+=C[N]*A}}}}return r}function zt(t,e){for(var n=[],r=t[(e=void 0===e?Math.sqrt(t.length):e)*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function Ft(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function Ut(t,e,n){if((e=void 0===e?Math.sqrt(t.length):e)===n)return t;for(var r=ne(n),i=Math.min(e,n),o=0;o<i-1;++o){for(var a=0;a<i-1;++a)r[o*n+a]=t[o*e+a];r[(o+1)*n-1]=t[(o+1)*e-1],r[(n-1)*n+o]=t[(e-1)*e+o]}return r[n*n-1]=t[e*e-1],r}function qt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=ne(t);return e.forEach((function(e){r=Vt(r,e,t)})),r}function Vt(t,e,n){void 0===n&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,o=e.length/i;if(!i)return e;if(!o)return t;for(var a=0;a<n;++a)for(var s=0;s<o;++s)for(var u=r[s*n+a]=0;u<i;++u)r[s*n+a]+=t[u*n+a]*e[s*i+u];return r}function Yt(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function jt(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function Wt(t,e){return(e=void 0===e?9===t.length:e)?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function Xt(t,e,n){var r=(t=Vt(t,e,n=void 0===n?e.length:n))[n-1];return t.map((function(t){return t/r}))}function Ht(t,e){return Vt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function $t(t,e){return Vt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function Zt(t,e){return Vt(t,ee(e,4))}function Qt(t,e){var n=e[0],r=e[1];return Vt(t,[void 0===n?1:n,0,0,0,0,void 0===r?1:r,0,0,0,0,void 0===(e=e[2])?1:e,0,0,0,0,1],4)}function Kt(t,e){return Xt(ee(e,3),Ft(t,3))}function Jt(t,e){var n=e[0],r=e[1];return Vt(t,[1,0,0,0,0,1,0,0,0,0,1,0,void 0===n?0:n,void 0===r?0:r,void 0===(e=e[2])?0:e,1],4)}function te(t,e){return Vt(t,e,4)}function ee(t,e){var n=Math.cos(t),r=(t=Math.sin(t),ne(e));return r[0]=n,r[1]=t,r[e]=-t,r[e+1]=n,r}function ne(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function re(t,e){for(var n=ne(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function ie(t,e){for(var n=ne(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function oe(t,e,n,r,i,o,a,s){var u=t[0],l=(t=t[1],e[0]),c=(e=e[1],n[0]),f=(n=n[1],r[0]),d=(r=r[1],i[0]),p=(i=i[1],o[0]),h=(o=o[1],a[0]),g=(a=a[1],s[0]);return(u=Bt([u,0,l,0,c,0,f,0,t,0,e,0,n,0,r,0,1,0,1,0,1,0,1,0,0,u,0,l,0,c,0,f,0,t,0,e,0,n,0,r,0,1,0,1,0,1,0,1,-d*u,-i*u,-p*l,-o*l,-h*c,-a*c,-g*f,-(s=s[1])*f,-d*t,-i*t,-p*e,-o*e,-h*n,-a*n,-g*r,-s*r],8)).length?((l=Vt(u,[d,i,p,o,h,a,g,s],8))[8]=1,Ut(function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}(l),3,4)):[]}function ae(t){return se(ue(t))}function se(t){var e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return t.forEach((function(t){var n=t.matrixFunction;t=t.functionValue;n&&(e=n(e,t))})),e}function ue(t){return(y(t)?t:C(t)).map((function(t){var e,n,r,i=(t=D(t)).prefix,o=(t=t.value,null),a=i,s="";return"translate"===i||"translateX"===i||"translate3d"===i?(o=Jt,s=[(r=M(t).map((function(t){return parseFloat(t)})))[0],void 0===(e=r[1])?0:e,void 0===(e=r[2])?0:e]):"translateY"===i?(o=Jt,s=[0,parseFloat(t),0]):"translateZ"===i?(o=Jt,s=[0,0,parseFloat(t)]):"scale"===i||"scale3d"===i?(o=Qt,s=[n=(r=M(t).map((function(t){return parseFloat(t)})))[0],void 0===(e=r[1])?n:e,void 0===(e=r[2])?1:e]):"scaleX"===i?(o=Qt,s=[n=parseFloat(t),1,1]):"scaleY"===i?(o=Qt,s=[1,parseFloat(t),1]):"scaleZ"===i?(o=Qt,s=[1,1,parseFloat(t)]):"rotate"===i||"rotateZ"===i||"rotateX"===i||"rotateY"===i?(e=(r=x(t)).unit,n=r.value,"rotate"===i||"rotateZ"===i?(a="rotateZ",o=Zt):"rotateX"===i?o=Ht:"rotateY"===i&&(o=$t),s="rad"===e?n:n*Math.PI/180):"matrix3d"===i?(o=te,s=M(t).map((function(t){return parseFloat(t)}))):"matrix"===i?(o=te,s=[(r=M(t).map((function(t){return parseFloat(t)})))[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,r[4],r[5],0,1]):a="",{name:i,functionName:a,value:t,matrixFunction:o,functionValue:s}}))}var le,ce=function(t,e){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},fe="function"==typeof Map?void 0:(le=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++le)}),de=function(t){function e(){this.constructor=n}var n,r;function i(e){return t.call(this,e=void 0===e?[]:e,fe)||this}return ce(n=i,r=t),n.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e),i}(d);function pe(t){return W(t,v)}function he(t){return t.length<3?0:Math.abs(function(t){for(var e=0,n=t.length-1;0<=n;--n)e+=t[n];return e}(t.map((function(e,n){return n=t[n+1]||t[0],e[0]*n[1]-n[0]*e[1]}))))/2}function ge(t,e){var n=e.width,r=e.height,i=e.left,o=e.top,a=(e=ve(t)).minX,s=e.minY,u=e.maxX,l=(e=e.maxY,n/(u-a)),c=r/(e-s);return t.map((function(t){return[i+(t[0]-a)*l,o+(t[1]-s)*c]}))}function ve(t){var e=t.map((function(t){return t[0]}));t=t.map((function(t){return t[1]}));return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,t),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,t)}}function me(t,e,n){var r=t[0],i=t[1],o=(a=ve(e)).minX,a=a.maxX,s=[[o,i],[a,i]],u=Ee(s[0],s[1]),l=(o=ye(e),[]);if(o.forEach((function(e){var n,r=Ee(e[0],e[1]),o=e[0];n=r,u.every((function(t,e){return 0===pe(t-n[e])}))?l.push({pos:t,line:e,type:"line"}):be(_e(u,r),[s,e]).forEach((function(t){e.some((function(e){return n=t,!pe(e[0]-n[0])&&!pe(e[1]-n[1]);var n}))?l.push({pos:t,line:e,type:"point"}):0!==pe(o[1]-i)&&l.push({pos:t,line:e,type:"intersection"})}))})),!n&&N(l,(function(t){return t[0]===r})))return!0;var c=0,f={};return l.forEach((function(t){var e=t.pos,n=t.type;t=t.line;e[0]>r||("intersection"===n?++c:"line"!==n&&"point"===n&&(n=N(t,(function(t){return t[1]!==i})),t=f[e[0]],n=n[1]>i?1:-1,t?t!==n&&++c:f[e[0]]=n))})),c%2==1}function Ee(t,e){var n=t[0],r=(t=t[1],e[0]-n),i=(e=e[1]-t,Math.abs(r)<v&&(r=0),Math.abs(e)<v&&(e=0),0),o=0,a=0;return r?a=e?(o=1,-(i=-e/r)*n-t):(o=1,-t):e&&(i=-1,a=n),[i,o,a]}function _e(t,e){var n,r,i=t[0],o=t[1],a=(t=t[2],e[0]),s=e[1],u=(e=e[2],0===i&&0===a),l=0===o&&0===s;return u&&l?[]:u?(u=-t/o)!=-e/s?[]:[[-1/0,u],[1/0,u]]:l?(u=-t/i)!=-e/a?[]:[[u,-1/0],[u,1/0]]:(0===i?[[n=-(s*(r=-t/o)+e)/a,r]]:0===a?[[n=-(o*(r=-e/s)+t)/i,r]]:0===o?[[n=-t/i,r=-(a*n+e)/s]]:0===s?[[n=-e/a,r=-(i*n+t)/o]]:[[n=(o*e-s*t)/(s*i-o*a),r=-(i*n+t)/o]]).map((function(t){return[t[0],t[1]]}))}function be(t,e){var n=e.map((function(t){return[0,1].map((function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]}))}));e=[];if(2===t.length){var r=(i=t[0])[0],i=i[1];if(pe(r-t[1][0])){if(!pe(i-t[1][1])){var o=Math.max.apply(Math,n.map((function(t){return t[0][0]}))),a=Math.min.apply(Math,n.map((function(t){return t[0][1]})));if(0<pe(o-a))return[];e=[[o,i],[a,i]]}}else{if(o=Math.max.apply(Math,n.map((function(t){return t[1][0]}))),a=Math.min.apply(Math,n.map((function(t){return t[1][1]}))),0<pe(o-a))return[];e=[[r,o],[r,a]]}}return(e=e.length?e:t.filter((function(t){var e=t[0],r=t[1];return n.every((function(t){return 0<=pe(e-t[0][0])&&0<=pe(t[0][1]-e)&&0<=pe(r-t[1][0])&&0<=pe(t[1][1]-r)}))}))).map((function(t){return[pe(t[0]),pe(t[1])]}))}function ye(t){return function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(t.slice(1),[t[0]]).map((function(e,n){return[t[n],e]}))}var Te=function(){return(Te=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Ie=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(b(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(b(t))for(var n in t)this.off(n);else{var r,i;e?(r=this._events[t])&&-1<(i=L(r,(function(t){return t.listener===e})))&&r.splice(i,1):this._events[t]=[]}else this._events={};return this},e.once=function(t,e){var n=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){n._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var n=this,r=(void 0===e&&(e={}),this._events[t]);if(!t||!r)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}(r).forEach((function(r){r.listener(e),r.once&&n.off(t,r.listener)})),!i},e.trigger=function(t,e){return this.emit(t,e=void 0===e?{}:e)},e._addEvent=function(t,e,n){var r=this._events;r[t]=r[t]||[],r[t].push(Te({listener:e},n))},t}(),Se=function(t,e){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},Re=function(){return(Re=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function we(t){return(t=t.container)===document.body?[t.scrollLeft||document.documentElement.scrollLeft,t.scrollTop||document.documentElement.scrollTop]:[t.scrollLeft,t.scrollTop]}function Oe(t){return t?S(t)?t():t instanceof Element?t:"current"in t?t.current:"value"in t?t.value:void 0:null}var Ce=function(t){function e(){this.constructor=n}var n;function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._startRect=null,e._startPos=[],e._prevTime=0,e._timer=0,e._prevScrollPos=[0,0],e._isWait=!1,e._flag=!1,e}Se(n=r,i=t),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e);var i=r.prototype;return i.dragStart=function(t,e){var n,r,i,o,a=Oe(e.container);a?(i=r=n=0,o=a===document.body?(i=window.innerWidth,window.innerHeight):(n=(a=a.getBoundingClientRect()).top,r=a.left,i=a.width,a.height),this._flag=!0,this._startPos=[t.clientX,t.clientY],this._startRect={top:n,left:r,width:i,height:o},this._prevScrollPos=this._getScrollPosition([0,0],e)):this._flag=!1},i.drag=function(t,e){var n,r,i,o,a,s;if(this._flag)return n=t.clientX,r=t.clientY,i=void 0===(i=e.threshold)?0:i,o=this._startRect,a=this._startPos,s=[0,0],o.top>r-i?(a[1]>o.top||r<a[1])&&(s[1]=-1):o.top+o.height<r+i&&(a[1]<o.top+o.height||r>a[1])&&(s[1]=1),o.left>n-i?(a[0]>o.left||n<a[0])&&(s[0]=-1):o.left+o.width<n+i&&(a[0]<o.left+o.width||n>a[0])&&(s[0]=1),clearTimeout(this._timer),!(!s[0]&&!s[1])&&this._continueDrag(Re(Re({},e),{direction:s,inputEvent:t,isDrag:!0}))},i.checkScroll=function(t){var e=this;if(this._isWait)return!1;var n=void 0===(n=t.prevScrollPos)?this._prevScrollPos:n,r=t.direction,i=void 0===(i=t.throttleTime)?0:i,o=t.inputEvent,a=t.isDrag,s=this._getScrollPosition(r||[0,0],t),u=s[0]-n[0];n=s[1]-n[1],r=r||[u?Math.abs(u)/u:0,n?Math.abs(n)/n:0];return this._prevScrollPos=s,!(!u&&!n||(this.trigger("move",{offsetX:r[0]?u:0,offsetY:r[1]?n:0,inputEvent:o}),i&&a&&(this._timer=window.setTimeout((function(){e._continueDrag(t)}),i)),0))},i.dragEnd=function(){clearTimeout(this._timer)},i._getScrollPosition=function(t,e){var n=e.container;return(void 0===(e=e.getScrollPosition)?we:e)({container:Oe(n),direction:t})},i._continueDrag=function(t){var e=this,n=t.container,r=t.direction,i=t.throttleTime,o=t.useScroll,a=t.isDrag,s=t.inputEvent;if(!a||!this._isWait){var u=P();return 0<(i=Math.max(i+this._prevTime-u,0))?(this._timer=window.setTimeout((function(){e._continueDrag(t)}),i),!1):(this._prevTime=u,i=this._getScrollPosition(r,t),this._prevScrollPos=i,a&&(this._isWait=!0),this.trigger("scroll",{container:Oe(n),direction:r,inputEvent:s}),this._isWait=!1,o||this.checkScroll(Re(Re({},t),{prevScrollPos:i,direction:r,inputEvent:s})))}},r}(Ie),Me=function(t,e){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},De=function(){return(De=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function xe(t){return 180*(e=[t[0].clientX,t[0].clientY],n=(t=[t[1].clientX,t[1].clientY])[0]-e[0],t=t[1]-e[1],(0<=(e=Math.atan2(t,n))?e:e+2*Math.PI)/Math.PI);var e,n}function Ae(t){if(!t)return[];if(t.touches){for(var e=t.touches,n=Math.min(e.length,2),r=[],i=0;i<n;++i)r.push(Ne(e[i]));return r}return[Ne(t)]}function Pe(t,e,n){var r=n.length,i=(t=Ge(t,r)).clientX,o=t.clientY;return{clientX:t.originalClientX,clientY:t=t.originalClientY,deltaX:i-(e=Ge(e,r)).clientX,deltaY:o-(e=e.clientY),distX:i-(n=Ge(n,r)).clientX,distY:o-n.clientY}}function Le(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Ne(t){return{clientX:t.clientX,clientY:t.clientY}}function Ge(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=0;r<e;++r){var i=t[r];n.originalClientX+="originalClientX"in i?i.originalClientX:i.clientX,n.originalClientY+="originalClientY"in i?i.originalClientY:i.clientY,n.clientX+=i.clientX,n.clientY+=i.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var ke=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.getAngle=function(t){return xe(t=void 0===t?this.prevClients:t)},e.getRotation=function(t){return xe(t=void 0===t?this.prevClients:t)-xe(this.startClients)},e.getPosition=function(t,e){var n=Pe((t=void 0===t?this.prevClients:t)||this.prevClients,this.prevClients,this.startClients),r=n.deltaX,i=n.deltaY;return this.movement+=Math.sqrt(r*r+i*i),this.prevClients=t,n},e.getPositions=function(t){void 0===t&&(t=this.prevClients);var e=this.prevClients;return this.startClients.map((function(n,r){return Pe([t[r]],[e[r]],[n])}))},e.getMovement=function(t){var e=this.movement;if(!t)return e;t=Ge(t,this.length);var n=Ge(this.prevClients,this.length),r=t.clientX-n.clientX;t=t.clientY-n.clientY;return Math.sqrt(r*r+t*t)+e},e.getDistance=function(t){return Le(t=void 0===t?this.prevClients:t)},e.getScale=function(t){return Le(t=void 0===t?this.prevClients:t)/Le(this.startClients)},e.move=function(t,e){this.startClients.forEach((function(n){n.clientX-=t,n.clientY-=e}))},t}(),Be=["textarea","input"],ze=function(t){function e(){this.constructor=n}var n;function r(e,n){void 0===n&&(n={});var r,i=t.call(this)||this,o=(e=(i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.isMouse=!1,i.isTouch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._dragFlag=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i.onDragStart=function(t,e){if(void 0===e&&(e=!0),i.flag||!1!==t.cancelable){var n=(f=i.options).container,r=f.pinchOutside,o=f.preventWheelClick,a=f.preventRightClick,s=f.preventDefault,u=f.checkInput,l=f.preventClickEventOnDragStart,c=f.preventClickEventOnDrag,f=f.preventClickEventByCondition,d=i.isTouch,p=!i.flag;if(i._isSecondaryButton=3===t.which||2===t.button,o&&(2===t.which||1===t.button)||a&&(3===t.which||2===t.button))return i.stop(),!1;if(p){if(o=document.activeElement,a=t.target){var h=a.tagName.toLowerCase(),g=(h=-1<Be.indexOf(h),a.isContentEditable);if(h||g){if(u||o===a)return!1;if(o&&g&&o.isContentEditable&&o.contains(a))return!1}else(s||"touchstart"===t.type)&&o&&(h=o.tagName,(o.isContentEditable||-1<Be.indexOf(h))&&o.blur());(l||c||f)&&$(window,"click",i._onClick,!0)}i.clientStores=[new ke(Ae(t))],i.flag=!0,i.isDrag=!1,i._dragFlag=!0,i.data={},i.doubleFlag=P()-i.prevTime<200,i._isMouseEvent=(u=t)&&(-1<u.type.indexOf("mouse")||"button"in u),!i._isMouseEvent&&i._preventMouseEvent&&(i._preventMouseEvent=!1),!1===(i._preventMouseEvent||i.emit("dragStart",De(De({data:i.data,datas:i.data,inputEvent:t,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:e,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){t.preventDefault()},preventDrag:function(){i._dragFlag=!1}})))&&i.stop(),i._isMouseEvent&&i.flag&&s&&t.preventDefault()}if(!i.flag)return!1;g=0,p?(i._attchDragEvent(),d&&r&&(g=setTimeout((function(){$(n,"touchstart",i.onDragStart,{passive:!1})})))):d&&r&&Z(n,"touchstart",i.onDragStart),i.flag&&(a=t).touches&&2<=a.touches.length&&(clearTimeout(g),p&&t.touches.length!==t.changedTouches.length||i.pinchFlag||i.onPinchStart(t))}},i.onDrag=function(t,e){if(i.flag){var n=i.options.preventDefault,r=(n=(!i._isMouseEvent&&n&&t.preventDefault(),Ae(t)),i.moveClients(n,t,!1));if(i._dragFlag){if((i.pinchFlag||r.deltaX||r.deltaY)&&!1===(i._preventMouseEvent||i.emit("drag",De(De({},r),{isScroll:!!e,inputEvent:t}))))return void i.stop();i.pinchFlag&&i.onPinch(t,n)}i.getCurrentStore().getPosition(n,!0)}},i.onDragEnd=function(t){var e,n,r,o,a,s;i.flag&&(s=(r=i.options).pinchOutside,e=r.container,a=r.preventClickEventOnDrag,o=r.preventClickEventOnDragStart,r=r.preventClickEventByCondition,n=i.isDrag,(a||o||r)&&requestAnimationFrame((function(){i._allowClickEvent()})),r||o||!a||n||i._allowClickEvent(),i.isTouch&&s&&Z(e,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(t),0!==(r=null!=t&&t.touches?Ae(t):[]).length&&i.options.keepDragging?i._addStore(new ke(r)):i.flag=!1,o=i._getPosition(),a=P(),s=!n&&i.doubleFlag,i.prevTime=n||s?0:a,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",De({data:i.data,datas:i.data,isDouble:s,isDrag:n,isClick:!n,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:t},o)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,requestAnimationFrame((function(){requestAnimationFrame((function(){i._preventMouseEvent=!1}))})))))},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Z(window,"click",i._onClick,!0)},i._onClick=function(t){i._preventMouseEvent=!1;var e=i.options.preventClickEventByCondition;null!=e&&e(t)||(t.stopPropagation(),t.preventDefault())},i._onContextMenu=function(t){i.options.preventRightClick?i.onDragEnd(t):t.preventDefault()},i._passCallback=function(){},[].concat(e)),(n=(i.options=De({checkInput:!1,container:1<e.length?window:e[0],preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},n),i.options)).container),a=n.events;n=n.checkWindowBlur;return i.isTouch=-1<a.indexOf("touch"),i.isMouse=-1<a.indexOf("mouse"),i.targets=e,i.isMouse&&(e.forEach((function(t){$(t,"mousedown",i.onDragStart),$(t,"mousemove",i._passCallback)})),$(o,"contextmenu",i._onContextMenu)),n&&$(window,"blur",i.onBlur),i.isTouch&&(r={passive:!1},e.forEach((function(t){$(t,"touchstart",i.onDragStart,r),$(t,"touchmove",i._passCallback,r)}))),i}Me(n=r,i=t),n.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e);var i=r.prototype;return i.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._allowClickEvent(),this._dettachDragEvent()},i.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce((function(t,e){return t+e.movement}),0)},i.isDragging=function(){return this.isDrag},i.isFlag=function(){return this.flag},i.isPinchFlag=function(){return this.pinchFlag},i.isDoubleFlag=function(){return this.doubleFlag},i.isPinching=function(){return this.isPinch},i.scrollBy=function(t,e,n,r){void 0===r&&(r=!0),this.flag&&(this.clientStores[0].move(t,e),r&&this.onDrag(n,!0))},i.move=function(t,e){var n=t[0],r=t[1];t=this.getCurrentStore().prevClients;return this.moveClients(t.map((function(t){var e=t.clientX;t=t.clientY;return{clientX:e+n,clientY:t+r,originalClientX:e,originalClientY:t}})),e,!0)},i.triggerDragStart=function(t){this.onDragStart(t,!1)},i.setEventData=function(t){var e,n=this.data;for(e in t)n[e]=t[e];return this},i.setEventDatas=function(t){return this.setEventData(t)},i.getCurrentEvent=function(t){return De(De({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},i.getEventData=function(){return this.data},i.getEventDatas=function(){return this.data},i.unset=function(){var t=this,e=this.targets,n=this.options.container;this.off(),Z(window,"blur",this.onBlur),this.isMouse&&(e.forEach((function(e){Z(e,"mousedown",t.onDragStart)})),Z(n,"contextmenu",this._onContextMenu)),this.isTouch&&(e.forEach((function(e){Z(e,"touchstart",t.onDragStart)})),Z(n,"touchstart",this.onDragStart)),this._dettachDragEvent()},i.onPinchStart=function(t){var e=this.options.pinchThreshold;this.isDrag&&this.getMovement()>e||(e=new ke(Ae(t)),this.pinchFlag=!0,this._addStore(e),!1===this.emit("pinchStart",De(De({data:this.data,datas:this.data,angle:e.getAngle(),touches:this.getCurrentStore().getPositions()},e.getPosition()),{inputEvent:t}))&&(this.pinchFlag=!1))},i.onPinch=function(t,e){var n;!this.flag||!this.pinchFlag||e.length<2||(n=this.getCurrentStore(),this.isPinch=!0,this.emit("pinch",De(De({data:this.data,datas:this.data,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e)),{inputEvent:t})))},i.onPinchEnd=function(t){var e,n;this.pinchFlag&&(e=this.isPinch,this.isPinch=!1,this.pinchFlag=!1,n=this.getCurrentStore(),this.emit("pinchEnd",De(De({data:this.data,datas:this.data,isPinch:e,touches:n.getPositions()},n.getPosition()),{inputEvent:t})))},i.getCurrentStore=function(){return this.clientStores[0]},i.moveClients=function(t,e,n){return((n=this._getPosition(t,n)).deltaX||n.deltaY)&&(this.isDrag=!0),De(De({data:this.data,datas:this.data},n),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:e})},i._addStore=function(t){this.clientStores.splice(0,0,t)},i._getPosition=function(t,e){t=this.getCurrentStore().getPosition(t,e),e=this.clientStores.slice(1).reduce((function(t,e){return e=e.getPosition(),t.distX+=e.distX,t.distY+=e.distY,t}),t);var n=e.distX;e=e.distY;return De(De({},t),{distX:n,distY:e})},i._attchDragEvent=function(){var t=this.options.container,e={passive:!1};this.isMouse&&($(t,"mousemove",this.onDrag),$(t,"mouseup",this.onDragEnd)),this.isTouch&&($(t,"touchmove",this.onDrag,e),$(t,"touchend",this.onDragEnd,e),$(t,"touchcancel",this.onDragEnd,e))},i._dettachDragEvent=function(){var t=this.options.container;this.isMouse&&(Z(t,"mousemove",this.onDrag),Z(t,"mouseup",this.onDragEnd)),this.isTouch&&(Z(t,"touchstart",this.onDragStart),Z(t,"touchmove",this.onDrag),Z(t,"touchend",this.onDragEnd),Z(t,"touchcancel",this.onDragEnd))},r}(Ie);function Fe(t){var e,n="rCS"+function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}(t).toString(36),r=0;return{className:n,inject:function(i,o){void 0===o&&(o={});var a,s=function(t){if(t&&t.getRootNode&&11===(t=t.getRootNode()).nodeType)return t}(i);i=0===r;return(s||i)&&(a=function(t,e,n,r){var i,o=document.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",t),n.nonce&&o.setAttribute("nonce",n.nonce),o.innerHTML=(i=t,t=e,n.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(t,e){return((e=e.trim())?M(e):[""]).map((function(t){return 0===(t=t.trim()).indexOf("@")?t:-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+i):t?"."+i+" "+t:"."+i})).join(", ")+" {"}))),(r||document.head||document.body).appendChild(o),o}(n,t,o,s)),i&&(e=a),s||++r,{destroy:function(){s?(s.removeChild(a),a=null):(0<r&&--r,0===r&&e&&(e.parentNode.removeChild(e),e=null))}}}}}var Ue=function(t,e){return(Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function qe(t,e){function n(){this.constructor=t}Ue(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ve=function(){return(Ve=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},Ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.injectResult=null,e.tag="div",e}qe(e,t);var n=e.prototype;return n.render=function(){var t=void 0===(t=(n=this.props).className)?"":t,e=(n.cspNonce,n.portalContainer),n=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}(n,["className","cspNonce","portalContainer"]),i=this.injector.className,o=this.tag,a={};return-1<"simple-1.1.0".indexOf("simple")&&e&&(a={portalContainer:e}),ut(o,Ve({ref:r(this,"element"),"data-styled-id":i,className:t+" "+i},a,n))},n.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},n.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},n.getElement=function(){return this.element},e}(lt);function je(t,e){var n=Fe(e);return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.injector=n,r.tag=t,r}return qe(r,e),r}(Ye)}var We=function(t,e){return(We=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Xe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}We(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var He=function(){return(He=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function $e(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function Ze(t,e){var n;return He({events:{},props:((n={})[t]=Boolean,n),name:t},e)}Nt=void 0===Zi&&function(){var t;if("undefined"!=typeof navigator&&navigator&&navigator.userAgentData)return(t=(t=navigator.userAgentData).brands||t.uaList)&&t.length}()?(Qe=((nn=navigator.userAgentData).uaList||nn.brands).slice(),Ke=Qi&&Qi.fullVersionList,Je=nn.mobile||!1,tn=Qe[0],en=(Qi&&Qi.platform||nn.platform||navigator.platform).toLowerCase(),nn={name:tn.brand,version:tn.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Mt(Lt,Qe).brand||Gt(Rt())},tn={name:"unknown",version:"-1",majorVersion:-1},nn.webkit=!nn.chromium&&It(Pt,(function(t){return Dt(Qe,t)})),rn=Mt(At,Qe),nn.chromium=!!rn.brand,nn.chromiumVersion=rn.version,nn.chromium||(rn=Mt(Pt,Qe),nn.webkit=!!rn.brand,nn.webkitVersion=rn.version),rn=St(Nt,(function(t){return new RegExp(""+t.test,"g").exec(en)})),tn.name=rn?rn.id:"",Qi&&(tn.version=Qi.platformVersion),Ke&&Ke.length?(rn=Mt(xt,Ke),nn.name=rn.brand||nn.name,nn.version=rn.version||nn.version):(Ke=Mt(xt,Qe),nn.name=Ke.brand||nn.name,nn.version=Ke.brand&&Qi?Qi.uaFullVersion:Ke.version),nn.webkit&&(tn.name=Je?"ios":"mac"),"ios"===tn.name&&nn.webview&&(nn.version="-1"),tn.version=Ot(tn.version),nn.version=Ot(nn.version),tn.majorVersion=parseInt(tn.version,10),nn.majorVersion=parseInt(nn.version,10),{browser:nn,os:tn,isMobile:Je,isHints:!0}):(rn=Rt(rn=Zi),Qi=!!/mobi/g.exec(rn),Ke={name:"unknown",version:"-1",majorVersion:-1,webview:Gt(rn),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},nn={name:"unknown",version:"-1",majorVersion:-1},Je=(tn=Ct(xt,rn)).preset,tn=tn.version,d=(Zi=Ct(Nt,rn)).preset,Zi=Zi.version,xt=Ct(At,rn),Ke.chromium=!!xt.preset,Ke.chromiumVersion=xt.version,Ke.chromium||(xt=Ct(Pt,rn),Ke.webkit=!!xt.preset,Ke.webkitVersion=xt.version),d&&(nn.name=d.id,nn.version=Zi,nn.majorVersion=parseInt(Zi,10)),Je&&(Ke.name=Je.id,Ke.version=tn,Ke.webview&&"ios"===nn.name&&"safari"!==Ke.name&&(Ke.webview=!1)),Ke.majorVersion=parseInt(Ke.version,10),{browser:Ke,os:nn,isMobile:Qi,isHints:!1});var Qe,Ke,Je,tn,en,nn,rn,on=Nt.browser.webkit,an=on&&(At="undefined"==typeof window?{userAgent:""}:window.navigator,!!(At=/applewebkit\/([^\s]+)/g.exec(At.userAgent.toLowerCase()))&&parseFloat(At[1])<605),sn="firefox"===Nt.browser.name,un=612<=parseInt(Nt.browser.webkitVersion,10)||15<=parseInt(Nt.browser.version,10),ln="moveable-",cn="\n{\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --moveable-color: #4af;\n    --zoom: 1;\n    --zoompx: 1px;\n    will-change: transform;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n    position: absolute;\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n    background: #4af;\n    background: var(--moveable-color);\n\tmargin-top: -7px;\n    margin-left: -7px;\n    border: 2px solid #fff;\n    z-index: 10;\n}\n.padding {\n    position: absolute;\n    top: 0px;\n    left: 0px;\n    width: 100px;\n    height: 100px;\n    transform-origin: 0 0;\n}\n.line {\n\twidth: 1px;\n    height: 1px;\n    background: #4af;\n    background: var(--moveable-color);\n\ttransform-origin: 0px 50%;\n}\n.line.edge {\n    z-index: 1;\n    background: transparent;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top-color: #4af;\n    border-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left-color: #4af;\n    border-left-color: var(--moveable-color);\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n\tpointer-events: none;\n}\n".concat([0,15,30,45,60,75,90,105,120,135,150,165].map((function(t){return'\n.direction[data-rotation="'.concat(t,'"] {\n\t').concat((n=t,e='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*(e=1),'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(n,'deg);transform-origin: 16px 16px"></path></svg>'),n=45*Math.round(t/45)%180,t="ns-resize",135==n?t="nwse-resize":45==n?t="nesw-resize":90==n&&(t="ew-resize"),"cursor:".concat(t,";cursor: url('").concat(e,"') 16 16, ").concat(t,";")),"\n}\n");var e,n})).join("\n"),"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid, .area.pass {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n\n").concat(an?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"","\n"),fn=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],dn=1e-7,pn=Math.pow(10,10),hn=-pn,gn=["n","w","s","e"],vn=["n","w","s","e","nw","ne","sw","se"],mn={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},En={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},_n={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},bn=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors"];function yn(t,e,n,r,i,o){var a=(a=(n=e.gestos[o=void 0===o?"draggable":o].move(n,t.inputEvent)).originalDatas||n.datas)[o]||(a[o]={});return He(He({},i?Ar(e,n):n),{isPinch:!!r,parentEvent:!0,datas:a,originalDatas:t.originalDatas})}var Tn=function(){function t(t){var e;this.ableName=t=void 0===t?"draggable":t,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=((e={})[t]={},e)}var e=t.prototype;return e.dragStart=function(t,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return(this.datas=n)[this.ableName]||(n[this.ableName]={}),He(He({},this.move(t,e.inputEvent)),{type:"dragstart"})},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var n,r;return this.isFlag?(n=this.prevX+t[0],r=this.prevY+t[1],(t[0]||t[1])&&(this.isDrag=!0)):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],r=t[1],this.isFlag=!0),{type:"drag",clientX:this.prevX=n,clientY:this.prevY=r,inputEvent:e,isDrag:this.isDrag,distX:n-this.startX,distY:r-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function In(t,e){var n=e.clientX,r=e.clientY,i=(e=e.datas,(t=t.state).moveableClientRect),o=t.rootMatrix,a=t.is3d;t=t.pos1;return[(n=Mn({datas:e,distX:(o=jt(xr(o,[n-i.left,r-i.top],a?4:3),t))[0],distY:o[1]}))[0],n[1]]}function Sn(t,e){e=e.datas;var n=(t=t.state).allMatrix,r=t.beforeMatrix,i=t.is3d,o=t.left,a=t.top,s=t.origin,u=t.offsetMatrix,l=t.targetMatrix,c=(t=t.transformOrigin,i?4:3);e.is3d=i,e.matrix=n,e.targetMatrix=l,e.beforeMatrix=r,e.offsetMatrix=u,e.transformOrigin=t,e.inverseMatrix=Bt(n,c),e.inverseBeforeMatrix=Bt(r,c),e.absoluteOrigin=Ft(Yt([o,a],s),c),e.startDragBeforeDist=Xt(e.inverseBeforeMatrix,e.absoluteOrigin,c),e.startDragDist=Xt(e.inverseMatrix,e.absoluteOrigin,c)}function Rn(t,e){var n,r,i,o,a,s,u,l,c,f,d,p,h,g=t.datas,v=(t=t.originalDatas.beforeRenderable,g.transformIndex),m=(b=t.nextTransforms).length,E=t.nextTransformAppendedIndexes,_=0,b=(-1===v?(_=b.length,g.transformIndex=_):_=N(E,(function(t){return t.index===v&&t.functionName===e}))?v:v+E.filter((function(t){return t.index<v})).length,n=_,r=b.slice(0,n<0?void 0:n),i=b.slice(0,n<0?void 0:n+1),o=b[n]||"",a=n<0?[]:b.slice(n),n=n<0?[]:b.slice(n+1),s=ue(r),u=ue(i),l=ue([o]),c=ue(a),f=ue(n),y=se(s),T=se(u),d=se(c),p=se(f),h=Vt(y,d,4),{transforms:b,beforeFunctionMatrix:y,beforeFunctionMatrix2:T,targetFunctionMatrix:se(l),afterFunctionMatrix:d,afterFunctionMatrix2:p,allFunctionMatrix:h,beforeFunctions:s,beforeFunctions2:u,targetFunction:l[0],afterFunctions:c,afterFunctions2:f,beforeFunctionTexts:r,beforeFunctionTexts2:i,targetFunctionText:o,afterFunctionTexts:a,afterFunctionTexts2:n}),y=b.targetFunction,T="rotate"===e?"rotateZ":e;g.beforeFunctionTexts=b.beforeFunctionTexts,g.afterFunctionTexts=b.afterFunctionTexts,g.beforeTransform=b.beforeFunctionMatrix,g.beforeTransform2=b.beforeFunctionMatrix2,g.targetTansform=b.targetFunctionMatrix,g.afterTransform=b.afterFunctionMatrix,g.afterTransform2=b.afterFunctionMatrix2,g.targetAllTransform=b.allFunctionMatrix,y.functionName===T?(g.afterFunctionTexts.splice(0,1),g.isAppendTransform=!1):_<m&&(g.isAppendTransform=!0,t.nextTransformAppendedIndexes=$e($e([],E,!0),[{functionName:e,index:_,isAppend:!0}],!1))}function wn(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function On(t,e,n){var r=t.beforeTransform,i=t.afterTransform,o=t.beforeTransform2,a=t.afterTransform2;t=t.targetAllTransform,e=n?Vt(t,e,4):Vt(e,t,4),t=Vt(Bt(n?o:r,4),e,4);return Vt(t,Bt(n?a:i,4),4)}function Cn(t){var e=t.datas,n=t.distX,r=(t=t.distY,e.inverseBeforeMatrix),i=e.is3d,o=e.startDragBeforeDist;i=i?4:3;return jt(Xt(r,Yt(e.absoluteOrigin,[n,t]),i),o)}function Mn(t,e){var n=t.datas,r=t.distX,i=(t=t.distY,n.inverseBeforeMatrix),o=n.inverseMatrix,a=n.is3d,s=n.startDragBeforeDist,u=n.startDragDist;a=a?4:3;return jt(Xt(e?i:o,Yt(n.absoluteOrigin,[r,t]),a),e?s:u)}function Dn(t){var e=[];return 0<=t[1]&&(0<=t[0]&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(0<=t[0]&&e.push(1),t[0]<=0&&e.push(0)),e}function xn(t,e){var n=(e[0]+1)/2,r=(e=(e[1]+1)/2,[E(t[0][0],t[1][0],n,1-n),E(t[0][1],t[1][1],n,1-n)]);t=[E(t[2][0],t[3][0],n,1-n),E(t[2][1],t[3][1],n,1-n)];return[E(r[0],t[0],e,1-e),E(r[1],t[1],e,1-e)]}function An(t,e,n,r){return Vt(t,Hn(e,r,n),r)}function Pn(t){var e=kn(t);return{setTransform:function(n,r){void 0===r&&(r=-1),e.startTransforms=y(n)?n:C(n),Nn(t,r)},setTransformIndex:function(e){Nn(t,e)}}}function Ln(t,e){Nn(t,L(kn(t).startTransforms,(function(t){return 0===t.indexOf("".concat(e,"("))})))}function Nn(t,e){var n=kn(t);-1!==((t=t.datas).transformIndex=e)&&(n=n.startTransforms[e])&&(e=ue([n]),t.startValue=e[0].functionValue)}function Gn(t,e){kn(t).nextTransforms=C(e)}function kn(t){return t.originalDatas.beforeRenderable}function Bn(t){return t.originalDatas.beforeRenderable.nextTransforms}function zn(t){return Bn(t).join(" ")}function Fn(t){return kn(t).nextStyle}function Un(t,e,n,r,i){return Gn(i,e),n=(t=Vi.drag(t,yn(i,t.state,n,r,!1)))?t.transform:e,He(He({transform:e,drag:t},br({transform:n},i)),{afterTransform:n})}function qn(t,e,n,r,i){var o=(a=t.state).left,a=a.top,s=t.props.groupable;c=(u=t.state).transformOrigin,f=u.offsetMatrix,u=u.is3d,d=i.beforeTransform,l=i.afterTransform,u=u?4:3;var u,l,c,f,d;i=s?o:0,o=s?a:0,s=jt(r,Vn(t,n,An(f,Ut(Vt(Vt(d,ae([e]),4),l,4),4,u),c,u)));return jt(s,[i,o])}function Vn(t,e,n){void 0===n&&(n=t.state.allMatrix);var r=(t=t.state).width,i=t.height;t=t.is3d;return rr(n,[r/2*(1+e[0]),i/2*(1+e[1])],t?4:3)}function Yn(t,e,n,r,i,o){var a=t.props.groupable,s=(t=t.state).transformOrigin,u=t.offsetMatrix,l=t.is3d,c=t.width,f=t.height,d=t.left,p=t.top,h=o.fixedDirection;o=o.nextTargetMatrix||t.targetMatrix,t=l?4:3;g=e,v=n,void 0===(m=c)&&(m=g),void 0===(E=f)&&(E=v),void 0===(_=s)&&(_=[0,0]);var g,v,m,E,_;l=a?d:0,c=a?p:0,s=An(u,o,(f=i)?f.map((function(t,e){var n=(r=x(t)).value,r=r.unit,i=e?E:m,o=e?v:g;return"%"===t||isNaN(n)?o*(i?_[e]/i:0):"%"!==r?n:o*n/100})):_,t);return d=r,a=h,p=xn(ir(p=s,e,n,t),a),jt([d[0]-p[0],d[1]-p[1]],[l,c])}function jn(t,e){return xn(Er(t.state),e)}function Wn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map((function(e){return e.split(" ").map((function(e){return e?""+t+e:""})).join(" ")})).join(" ")}.apply(void 0,$e([ln],t,!1))}function Xn(t){t()}function Hn(t,e,n){return qt(e,ie(n,e),t,ie(n.map((function(t){return-t})),e))}function $n(t){return(t=t.transformOrigin)?t.split(" "):["0","0"]}function Zn(t,e){var n=(e=void 0===e?wr(t):e).transform;if(n&&"none"!==n)return e.transform;if("transform"in t){var r=t.transform.baseVal;if(!r)return"";var i=r.length;if(!i)return"";for(var o=[],a=0;a<i;++a)!function(t){var e=r[t].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map((function(t){return e[t]})).join(", "),")"))}(a);return o.join(" ")}return""}function Qn(t,e,n){for(var r,i,o,a=document.body,s=!1,u=(o=!t||n?t:(n=null==(n=null==t?void 0:t.assignedSlot)?void 0:n.parentElement,i=t.parentElement,n?(s=!0,r=i,n):i),!1),l=t===e||o===e,c="relative";o&&o!==a;){e===o&&(l=!0);var f=wr(o),d=o.tagName.toLowerCase(),p=Zn(o,f),h=f.willChange;c=f.position;if("svg"===d||"static"!==c||p&&"none"!==p||"transform"===h)break;if(d=null==(f=null==t?void 0:t.assignedSlot)?void 0:f.parentNode,p=o.parentNode,d&&(s=!0,r=p),(h=d||p)&&11===h.nodeType){o=h.host,u=!0;break}o=h,c="relative"}return{hasSlot:s,parentSlotElement:r,isCustomElement:u,isStatic:"static"===c,isEnd:l||!o||o===a,offsetParent:o||a}}function Kn(t,e,n){var r,i,o=t.tagName.toLowerCase(),a=t.offsetLeft,s=t.offsetTop,u=_(a),l=!u;return l||"svg"===o?i=(r=$n(n).map((function(t){return parseFloat(t)}))).slice():(i=(r=an?function(t){return $n(wr(t,":before")).map((function(e,n){var r=(e=x(e)).value;return e=e.unit,r*(r=t,n=0===n,"%"===e?nr(r.ownerSVGElement)[n?"width":"height"]/100:1)}))}(t):$n(n).map((function(t){return parseFloat(t)}))).slice(),l=!0,a=(n=function(t,e,n){if(!t.getBBox||!n&&"g"===t.tagName.toLowerCase())return[0,0,0,0];n=t.getBBox(),t=nr(t.ownerSVGElement);var r=n.x-t.x;return[r,n=n.y-t.y,e[0]-r,e[1]-n]}(t,r,t===e&&"g"===e.tagName.toLowerCase()))[0],s=n[1],r[0]=n[2],r[1]=n[3]),{tagName:o,isSVG:u,hasOffset:l,offset:[a||0,s||0],origin:r,targetOrigin:i}}function Jn(t,e,n){void 0===n&&(n=wr(t));var r=(t=wr(document.body)).position;return e||r&&"static"!==r?(e=parseInt(t.marginLeft,10),r=parseInt(t.marginTop,10),"absolute"===n.position&&("auto"===n.top&&"auto"===n.bottom||(r=0),"auto"===n.left&&"auto"===n.right||(e=0)),[e,r]):[0,0]}function tr(t){t.forEach((function(t){var e=t.matrix;e&&(t.matrix=Ut(e,3,4))}))}function er(t,e){return void 0===e&&(e=9<t.length),"".concat(e?"matrix3d":"matrix","(").concat(Wt(t,!e).join(","),")")}function nr(t){var e=t.clientWidth,n=t.clientHeight;return t?{x:(t=(t=t.viewBox)&&t.baseVal||{x:0,y:0,width:0,height:0}).x,y:t.y,width:t.width||e,height:t.height||n,clientWidth:e,clientHeight:n}:{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n}}function rr(t,e,n){return Xt(t,Ft(e,n),n)}function ir(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map((function(e){return rr(t,e,r)}))}function or(t){var e=t.map((function(t){return t[0]})),n=(t=t.map((function(t){return t[1]})),Math.min.apply(Math,e)),r=Math.min.apply(Math,t);return{left:n,top:r,right:e=Math.max.apply(Math,e),bottom:t=Math.max.apply(Math,t),width:e-n,height:t-r}}function ar(t,e,n,r){return or(ir(t,e,n,r))}function sr(t,e,n,r){var i=(r=(n=ir(t,n,r,f=16===t.length?4:3))[0])[0],o=(r=r[1],(a=n[1])[0]),a=a[1],s=(u=n[2])[0],u=u[1],l=(c=n[3])[0],c=c[1],f=(e=(t=rr(t,e,f))[0],t[1]),d=(t=Math.min(i,o,s,l),Math.min(r,a,u,c));return{left:t,top:d,right:Math.max(i,o,s,l),bottom:Math.max(r,a,u,c),origin:[e-t||0,f-d||0],pos1:[i-t||0,r-d||0],pos2:[o-t||0,a-d||0],pos3:[s-t||0,u-d||0],pos4:[l-t||0,c-d||0],direction:Y(n)}}function ur(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function lr(t,e){return ur([e[0]-t[0],e[1]-t[1]])}function cr(t,e,n,r){return void 0===n&&(n=1),void 0===r&&(r=V(t,e)),e=lr(t,e),{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(e,"px")}}function fr(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,o=n.reduce((function(t,e){return t+e[0]}),0)/i;i=n.reduce((function(t,e){return t+e[1]}),0)/i;return{transform:"translateZ(0px) translate(".concat(o,"px, ").concat(i,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function dr(t,e){return b(e=t[e])?He(He({},t),e):t}function pr(t,e){void 0===e&&(e=t?wr(t):null);var n,r,i,o,a,s,u,l,c=t&&!_(t.offsetWidth),f=0,d=0,p=0,h=0,g=0,v=0,m=0,E=0,b=0,y=0,T=0,I=0,S=1/0,R=1/0,w=1/0,O=1/0,C=!1;return t&&(h=c||"svg"===t.tagName.toLowerCase()?(c=t.style,n="border-box"===e.boxSizing,o=parseFloat(e.borderLeftWidth)||0,i=parseFloat(e.borderRightWidth)||0,a=parseFloat(e.borderTopWidth)||0,s=parseFloat(e.borderBottomWidth)||0,o=(r=(parseFloat(e.paddingLeft)||0)+(parseFloat(e.paddingRight)||0))+(o+i),a=(i=(parseFloat(e.paddingTop)||0)+(parseFloat(e.paddingBottom)||0))+(a+s),b=Math.max(r,z(e.minWidth,0)||0),y=Math.max(i,z(e.minHeight,0)||0),S=z(e.maxWidth,0),R=z(e.maxHeight,0),isNaN(S)&&(R=S=1/0),s=z(c.width,0)||0,c=z(c.height,0)||0,u=parseFloat(e.width)||0,l=parseFloat(e.height)||0,g=parseFloat(e.width),v=parseFloat(e.height),p=f=m=Math.abs(u-s)<1?F(b,s||g,S):u,h=d=E=Math.abs(l-c)<1?F(y,c||v,R):l,n?(w=S,O=R,T=b,I=y,m=f-o,E=d-a):(w=S+o,O=R+a,T=b+o,I=y+a,f=m+o,d=E+a),p=m+r,E+i):(C=!0,g=f=(e=t.getBBox()).width,v=d=e.height,p=m=f,E=d)),{svg:C,offsetWidth:f,offsetHeight:d,clientWidth:p,clientHeight:h,contentWidth:m,contentHeight:E,cssWidth:g,cssHeight:v,minWidth:b,minHeight:y,maxWidth:S,maxHeight:R,minOffsetWidth:T,minOffsetHeight:I,maxOffsetWidth:w,maxOffsetHeight:O}}function hr(t,e){return V(0<e?t[0]:t[1],0<e?t[1]:t[0])}function gr(t,e){var n=0,r=0,i=0,o=0,a=(t&&(t===document.body||t===document.documentElement?(i=window.innerWidth,o=window.innerHeight,n=(a=[-(a=[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop])[0],-a[1]])[0],r=a[1]):(n=(a=t.getBoundingClientRect()).left,r=a.top,i=a.width,o=a.height)),{left:n,top:r,width:i,height:o,right:n+i,bottom:r+o});return t&&e&&(a.clientLeft=t.clientLeft,a.clientTop=t.clientTop,a.clientWidth=t.clientWidth,a.clientHeight=t.clientHeight,a.scrollWidth=t.scrollWidth,a.scrollHeight=t.scrollHeight,a.overflow="visible"!==wr(t).overflow),a}function vr(t){var e;if(t&&(t=t.getAttribute("data-direction")))return e=[0,0],-1<t.indexOf("w")&&(e[0]=-1),-1<t.indexOf("e")&&(e[0]=1),-1<t.indexOf("n")&&(e[1]=-1),-1<t.indexOf("s")&&(e[1]=1),e}function mr(t,e){return[Yt(e,t[0]),Yt(e,t[1]),Yt(e,t[2]),Yt(e,t[3])]}function Er(t){var e=t.left,n=t.top;return mr([t.pos1,t.pos2,t.pos3,t.pos4],[e,n])}function _r(t,e){var n;null!=(n=t[e])&&n.unset(),t[e]=null}function br(t,e){return e&&((e=kn(e)).nextStyle=He(He({},e.nextStyle),t)),{style:t,cssText:B(t).map((function(e){return"".concat(e,": ").concat(t[e],";")})).join("")}}function yr(t,e,n){var r=e.afterTransform||e.transform;return He(He({},br(He(He(He({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function Tr(t,e,n,r){var i=e.datas;i.datas||(i.datas={}),n=He(He({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,stopDrag:function(){var t;null!=(t=e.stop)&&t.call(e)}});return i.isStartEvent?r||(i.lastEvent=n):i.isStartEvent=!0,n}function Ir(t,e,n){var r=e.datas,i=("isDrag"in n?n:e).isDrag;return r.datas||(r.datas={}),He(He({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas})}function Sr(t,e,n){t._emitter.on(e,n)}function Rr(t,e,n,r){return t.triggerEvent(e,n,r)}function wr(t,e){return window.getComputedStyle(t,e)}function Or(t,e,n){var r={},i={};return t.filter((function(t){var o=t.name;if(r[o]||!e.some((function(e){return t[e]})))return!1;if(!n&&t.ableGroup){if(i[t.ableGroup])return!1;i[t.ableGroup]=!0}return r[o]=!0}))}function Cr(t,e){return t===e||null==t&&null==e}function Mr(t){return t.reduce((function(t,e){return t.concat(e)}),[])}function Dr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort((function(t,e){return Math.abs(e)-Math.abs(t)})),t[0]}function xr(t,e,n){return Xt(Bt(t,n),Ft(e,n),n)}function Ar(t,e){var n=t.is3d;t=xr(t.rootMatrix,[e.distX,e.distY],n?4:3);return e.distX=t[0],e.distY=t[1],e}function Pr(t,e,n,r,i){return jt(rr(t,Yt(n,e),i),r)}function Lr(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function Nr(t){return Math.abs(t)<=dn?0:t}function Gr(t,e){return void 0===e&&(e=[t]),function(n,r){if(r.isRequest)return!!e.some((function(t){return r.requestAble===t}))&&r.parentDirection;var i=r.inputEvent.target;return H(i,Wn("direction"))&&(!t||H(i,Wn(t)))}}function kr(t,e){return t?t instanceof Element?t:T(t)?e?document.querySelector(t):t:S(t)?t():"current"in t?t.current:t:null}function Br(t,e){return t?(!(n=t)||!b(n)||n instanceof Element||!y(n)&&!("length"in n)?[t]:[].slice.call(t)).reduce((function(t,n){return T(n)&&e?$e($e([],t,!0),[].slice.call(document.querySelectorAll(n)),!0):(y(n)?t.push(Br(n,e)):t.push(kr(n,e)),t)}),[]):[];var n}function zr(t,e){var n=Bt(n=t.rootMatrix,(t=t.is3d)?4:3);return(n=t?n:Ut(n,3,4))[12]=0,n[13]=0,n[14]=0,n=(t=Xt(t=n,[(n=e)[0],n[1]||0,n[2]||0,1],4))[3]||1,[t[0]/n,t[1]/n,t[2]/n]}function Fr(t,e,n,r,i){var o,a,s=t[0],u=(t=t[1],0),l=0;return i&&s&&t?(i=V([0,0],e),o=V([0,0],r),a=ur(e),i=Math.cos(i-o)*a,r[0]?l=r[1]?(o=2*r[0]*s,a=2*r[1]*t,s=ur([o+e[0],a+e[1]])-ur([o,a]),t=V([0,0],[n,1]),u=Math.cos(t)*s,Math.sin(t)*s):(u=i)/n:u=(l=i)*n):(u=r[0]*e[0],l=r[1]*e[1]),[u,l]}function Ur(t,e,n,r){var i,o,a=n.ratio,s=n.startOffsetWidth,u=n.startOffsetHeight,l=0,c=0,f=r.distX,d=r.distY,p=r.parentDistance,h=r.parentDist,g=(r=r.parentScale,n.fixedDirection),v=[0,1].map((function(e){return Math.abs(t[e]-g[e])})),m=[0,1].map((function(t){return 0!==(t=v[t])?2/t:t}));return h?(l=h[0],c=h[1],e&&(l?c=c||l/a:l=c*a)):c=r?(l=(r[0]-1)*s,(r[1]-1)*u):p?(l=p/(i=ur([h=s*v[0],r=u*v[1]]))*h*m[0],p/i*r*m[1]):(o=Mn({datas:n,distX:f,distY:d}),l=(h=Fr([s,u],o=m.map((function(t,e){return o[e]*t})),a,t,e))[0],h[1]),{distWidth:l,distHeight:c}}function qr(t,e,n){var r,i=((r=((r=n.originalDatas).groupable=r.groupable||{},r.groupable)).childDatas=r.childDatas||[],r.childDatas);return t.moveables.map((function(t,r){return i[r]=i[r]||{},i[r][e]=i[r][e]||{},He(He({},n),{datas:i[r][e],originalDatas:i[r]})}))}function Vr(t,e,n,r,i,o,a){var s=!!n.match(/Start$/g),u=!!n.match(/End$/g),l=i.isPinch,c=i.datas,f=(i=qr(t,e.name,i),t.moveables);t=i.map((function(t,i){var d=f[i],p=d.state,h=p.gestos,g=t;if(s)g=new Tn(a).dragStart(r,t);else{if(h[a]||(h[a]=c.childGestos[i]),!h[a])return;g=yn(t,p,r,l,o,a)}return i=e[n](d,He(He({},g),{parentFlag:!0})),u&&(h[a]=null),i}));return s&&(c.childGestos=f.map((function(t){return t.state.gestos[a]}))),t}function Yr(t,e,n,r,i,o){void 0===i&&(i=function(t,e){return e});var a=!!n.match(/End$/g),s=(r=qr(t,e.name,r),t.moveables);return r.map((function(t,r){var u=s[r],l=i(u,t);return(l=e[n](u,He(He({},l),{parentFlag:!0})))&&o&&o(u,t,l,r),a&&(u.state.gestos={}),l}))}Pt=Ze("pinchable",{events:{onPinchStart:"pinchStart",onPinch:"pinch",onPinchEnd:"pinchEnd",onPinchGroupStart:"pinchGroupStart",onPinchGroup:"pinchGroup",onPinchGroupEnd:"pinchGroupEnd"},dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,o=e.originalDatas,a=(s=t.props).pinchable,s=s.ables;if(!a)return!1;var u="onPinch".concat(r?"Group":"","Start"),l="drag".concat(r?"Group":"","ControlStart"),c=(s=(!0===a?t.controlAbles:s.filter((function(t){return-1<a.indexOf(t.name)}))).filter((function(t){return t.canPinch&&t[l]})),Tr(t,e,{}));r&&(c.targets=r),r=Rr(t,u,c);return!!(u=(n.isPinch=!1!==r,n.ables=s,n.isPinch))&&(s.forEach((function(n){var r;o[n.name]=o[n.name]||{},n[l]&&(r=He(He({},e),{datas:o[n.name],parentRotate:i,isPinch:!0}),n[l](t,r))})),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},u)},pinch:function(t,e){var n,r,i=e.datas,o=e.scale,a=e.distance,s=e.originalDatas,u=e.inputEvent,l=e.targets,c=e.angle;if(i.isPinch)return n=a*(1-1/o),a=Tr(t,e,{}),l&&(a.targets=l),o="onPinch".concat(l?"Group":""),Rr(t,o,a),o=i.ables,r="drag".concat(l?"Group":"","Control"),o.forEach((function(i){i[r]&&i[r](t,He(He({},e),{datas:s[i.name],inputEvent:u,parentDistance:n,parentRotate:c,isPinch:!0}))})),a},pinchEnd:function(t,e){var n,r,i,o=e.datas,a=e.isPinch,s=e.inputEvent,u=e.targets,l=e.originalDatas;if(o.isPinch)return r="onPinch".concat(u?"Group":"","End"),n=Ir(t,e,{isDrag:a}),u&&(n.targets=u),Rr(t,r,n),r=o.ables,i="drag".concat(u?"Group":"","ControlEnd"),r.forEach((function(n){n[i]&&n[i](t,He(He({},e),{isDrag:a,datas:l[n.name],inputEvent:s,isPinch:!0}))})),a},pinchGroupStart:function(t,e){return this.pinchStart(t,He(He({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,He(He({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,He(He({},e),{targets:t.props.targets}))}});var jr=["left","right","center"],Wr=["top","bottom","middle"],Xr={start:"left",end:"right",center:"center"},Hr={start:"top",end:"bottom",center:"middle"};function $r(t,e){var n=(u=t.props).snappable,r=u.bounds,i=u.innerBounds,o=u.verticalGuidelines,a=u.horizontalGuidelines,s=u.snapGridWidth,u=u.snapGridHeight,l=(t=t.state).guidelines;t=t.enableSnap;return n&&t&&!(e&&!0!==n&&n.indexOf(e)<0)&&!!(s||u||r||i||l&&l.length||o&&o.length||a&&a.length)}function Zr(t){return!1===t?{}:!0!==t&&t?t:{left:!0,right:!0,top:!0,bottom:!0}}function Qr(t,e){var n=function(t,e){var n,r=Zr(t),i={};for(n in r)n in e&&r[n]&&(i[n]=e[n]);return i}(t,e);t=Wr.filter((function(t){return t in n})),e=jr.filter((function(t){return t in n}));return{horizontal:t.map((function(t){return n[t]})),vertical:e.map((function(t){return n[t]}))}}function Kr(t,e,n,r){return r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!_(i))return i}return t[n]}(r,t.props.snapThreshold,5),Jr(t.state.guidelines,e,n,r)}function Jr(t,e,n,r){return{vertical:ni(t,"vertical",e,r),horizontal:ni(t,"horizontal",n,r)}}function ti(t,e,n){return Kr(t,(e=Qr(t.props.snapDirections,e)).vertical,e.horizontal,n)}function ei(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=(i=(t=t.posInfos[0]).guidelineInfos[0]).offset,r=i.dist,i=i.guideline;return{isSnap:e,offset:n,dist:r,pos:t.pos,guideline:i}}function ni(t,e,n,r){if(!t||!t.length)return{isSnap:!1,index:-1,posInfos:[]};var i="vertical"===e?0:1,o=(n=n.map((function(n,o){var a=t.map((function(t){var e=t.pos;return{offset:e=n-e[i],dist:Math.abs(e),guideline:t}})).filter((function(t){var n=t.guideline;t=t.dist;return!(n.type!==e||r<t)})).sort((function(t,e){return t.dist-e.dist}));return{pos:n,index:o,guidelineInfos:a}})).filter((function(t){return 0<t.guidelineInfos.length})).sort((function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist})),0<n.length);return{isSnap:o,index:o?n[0].index:-1,posInfos:n}}function ri(t,e){var n=Math.abs(t.offset),r=Math.abs(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<dn?1:r<dn?-1:n-r}function ii(t,e){return t.slice().sort((function(t,n){var r=t.sign[e],i=n.sign[e],o=t.offset[e],a=n.offset[e];return r?i?ri({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:a}):-1:1}))[0]}function oi(t,e){var n=q([e[0][0],e[1][0]]);e=q([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:e<=t[1]}}function ai(t,e){var n,r=e[0],i=(e=e[1])[0]-r[0];e=e[1]-r[1];return Math.abs(i)<dn&&(i=0),Math.abs(e)<dn&&(e=0),e=i?(n=e?e/i*(t[0]-r[0])+r[1]:r[1],t[1]):(n=r[0],t[0]),n-e}function si(t,e,n,r){return void 0===r&&(r=dn),t.every((function(t){return(t=ai(t,e))<=0===n||Math.abs(t)<=r}))}function ui(t,e,n,r,i){return void 0===i&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function li(t,e,n,r,i,o){var a,s,u=e[0],l=(e=e[1],t=t[0],n[0]),c=Nr((n=n[1])[1]-l[1]),f=e,d=u;u=-u/e;return Nr(n[0]-l[0])?c||o&&!f?{isBound:!1,offset:0}:d?ui((l[1]-t[1])/u+t[0],l[0],n[0],r,i):(a=l[1]-t[1],{isBound:s=Math.abs(a)<=(i||0),offset:s?a:0}):o&&!d?{isBound:!1,offset:0}:f?ui(u*(l[0]-t[0])+t[1],l[1],n[1],r,i):(a=l[0]-t[0],{isBound:s=Math.abs(a)<=(i||0),offset:s?a:0})}function ci(t,e,n){return e.map((function(e){var r=function(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,o=e.horizontalSign;e=e.lineConstants;if(!(t=t.props.innerBounds))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var a=t.left,s=t.top,u=t.width,l=[[a,s],[a,s+(t=t.height)]],c=[[a,s],[a+u,s]],f=[[a+u,s],[a+u,s+t]],d=[[a,s+t],[a+u,s+t]];return si([[a,s],[a+u,s],[a,s+t],[a+u,s+t]],n,r)?{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]}:(a=li(n,e,c,i),u=li(n,e,d,i),s=li(n,e,l,o),t=li(n,e,f,o),r=a.isBound&&u.isBound,c=a.isBound||u.isBound,d=s.isBound&&t.isBound,i=s.isBound||t.isBound,l=Dr(a.offset,u.offset),n=Dr(s.offset,t.offset),f=!(e=[0,0]),{isAllBound:Math.abs(n)<Math.abs(l)?(e=[l,0],f=c,r):(e=[0,n],f=i,d),isVerticalBound:c,isHorizontalBound:i,isBound:f,offset:e})}(t,e),i=r.isBound,o=r.offset,a=r.isVerticalBound,s=(r=r.isHorizontalBound,e.multiple);e=Mn({datas:n,distX:o[0],distY:o[1]}).map((function(t,e){return t*(s[e]?2/s[e]:0)}));return{sign:s,isBound:i,isVerticalBound:a,isHorizontalBound:r,isSnap:!1,offset:e}}))}function fi(t,e,n,r){var i,o,a=ir((t=t.state).allMatrix,100,100,t.is3d?4:3),s=xn(a,[0,0]);return t=r,r=[],i=n[0],o=n[1],i&&o?r.push([[0,2*o],n,[-i,o]],[[2*i,0],n,[i,-o]]):i?(r.push([[2*i,0],[i,1],[i,-1]]),t&&r.push([[0,-1],[i,-1],[-i,-1]],[[0,1],[i,1],[-i,1]])):o?(r.push([[0,2*o],[1,o],[-1,o]]),t&&r.push([[-1,0],[-1,o],[-1,-o]],[[1,0],[1,o],[1,-o]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r.map((function(t){var n,r,i=t[0],o=t[1],u=(t=t[2],[xn(a,o),xn(a,t)]),l=(f=(l=u)[0],c=(l=l[1])[0]-f[0],l=l[1]-f[1],Math.abs(c)<v&&(c=0),Math.abs(l)<v&&(l=0),r=n=d=0,r=c?l?(d=-l/c)*f[0]-f[n=1]:-f[n=1]:(d=-1,f[0]),[d,n,r].map((function(t){return W(t,v)}))),c=oi(s,u),f=c.vertical,d=c.horizontal;return{multiple:i,centerSign:ai(s,u)<=0,verticalSign:f,horizontalSign:d,lineConstants:l,line:[xn(e,o),xn(e,t)]}}))}function di(t,e,n,r){return[[(t=r?t.map((function(t){return Kt(t,r)})):t)[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].some((function(t){var r=ai(n,t)<=0;return!si(e,t,r)}))}function pi(t,e,n){var r=(t=t||{}).position,i=t.left,o=t.top,a=t.right;return{vertical:gi(r={position:void 0===r?"client":r,left:void 0===i?-1/0:i,top:void 0===o?-1/0:o,right:void 0===a?1/0:a,bottom:void 0===(t=t.bottom)?1/0:t},e,!0),horizontal:gi(r,n,!1)}}function hi(t,e){var n=(o=(l=t.state).containerClientRect).clientHeight,r=o.clientWidth,i=o.clientLeft,o=o.clientTop,a=(l=l.snapOffset).left,s=l.top,u=l.right,l=l.bottom,c=(t="css"===((e=e||t.props.bounds||{}).position||"client"),e.left),f=e.top,d=void 0===(d=e.right)?t?-1/0:1/0:d;e=void 0===(e=e.bottom)?t?-1/0:1/0:e;return t&&(d=r+u-a-d,e=n+l-s-e),{left:(void 0===c?-1/0:c)+a-i,right:d+a-i,top:(void 0===f?-1/0:f)+s-o,bottom:e+s-o}}function gi(t,e,n){var r=t[n?"left":"top"],i=(t=t[n?"right":"bottom"],n=Math.min.apply(Math,e),e=Math.max.apply(Math,e),[]);return n<r+1&&i.push({isBound:!0,offset:n-r,pos:r}),t-1<e&&i.push({isBound:!0,offset:e-t,pos:t}),i.length||i.push({isBound:!1,offset:0,pos:0}),i.sort((function(t,e){return Math.abs(e.offset)-Math.abs(t.offset)}))}function vi(t,e,n){return(n?t.map((function(t){return Kt(t,n)})):t).some((function(t){return t[0]<e.left&&.1<Math.abs(t[0]-e.left)||t[0]>e.right&&.1<Math.abs(t[0]-e.right)||t[1]<e.top&&.1<Math.abs(t[1]-e.top)||t[1]>e.bottom&&.1<Math.abs(t[1]-e.bottom)}))}function mi(t,e){return n=(t=He(He({},t),{classNames:$e([Wn("line","guideline",t.direction)],t.classNames,!0).filter((function(t){return t})),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map((function(t){return"".concat(W(t,.1),"px")}))})).direction,r=t.classNames,i=t.size,o=t.pos,a=t.zoom,t=t.key,s=(n="horizontal"===n)?"Y":"X",e.createElement("div",{key:t,className:r.join(" "),style:((e={})[n?"width":"height"]="".concat(i),e.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(s,"(-50%) scale").concat(s,"(").concat(a,")"),e)});var n,r,i,o,a,s}function Ei(t,e,n,r,i,o,a,s){var u=t.props.zoom;return n.map((function(t,n){var l=t.type,c=(t=t.pos,[0,0]);return c[a]=r,c[a?0:1]=-i+t,mi({key:"".concat(e,"TargetGuideline").concat(n),classNames:[Wn("target","bold",l)],posValue:c,sizeValue:o,zoom:u,direction:e},s)}))}function _i(t,e,n,r,i,o){var a=(t=t.props).zoom,s=t.isDisplayInnerSnapDigit,u="horizontal"===e?Xr:Hr,l=i[u.start],c=i[u.end];return n.filter((function(t){var e=t.hide;t=t.elementRect;return!e&&!(s&&t&&(e=t.rect)[u.start]<=l&&c<=e[u.end])})).map((function(t,n){var i=t.pos,s=t.size,u=t.element;t=t.className,i=[-r[0]+i[0],-r[1]+i[1]];return mi({key:"".concat(e,"-default-guideline-").concat(n),classNames:u?[Wn("bold"),t]:[Wn("normal"),t],direction:e,posValue:i,sizeValue:s,zoom:a},o)}))}function bi(t,e,n,r,i,o,a,s){var u=void 0===(u=(t=t.props).snapDigit)?0:u,l=void 0===(l=t.isDisplaySnapDigit)||l,c=void 0===(c=t.snapDistFormat)?function(t,e){return t}:c,f=(t=t.zoom,"horizontal"===e?"X":"Y"),d="vertical"===e?"height":"width";i=Math.abs(i),l=l?parseFloat(i.toFixed(u)):0;return s.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:Wn("guideline-group",e),style:((u={left:"".concat(o[0],"px"),top:"".concat(o[1],"px")})[d]="".concat(i,"px"),u)},mi({direction:e,classNames:[Wn(n),a],size:"100%",posValue:[0,0],sizeValue:i,zoom:t},s),s.createElement("div",{className:Wn("size-value","gap"),style:{transform:"translate".concat(f,"(-50%) scale(").concat(t,")")}},0<l?c(l,e):""))}function yi(t,e,n,r,i){o=t,a=(u=e)[0]-o[0],s=u[1]-o[1],Math.abs(a)<v&&(a=0),Math.abs(s)<v&&(s=0);var o=a?s?(s/=a,a=o[1]-s*o[0],r?[n,s*(u[0]+n)+a-u[1]]:[(u[1]+n-a)/s-u[0],n]):r?[n,0]:[0,0]:r?[0,0]:[0,n];if(!o)return{isOutside:!1,offset:[0,0]};var a=j(t,e),s=j(o,t),u=j(o,e);r=a<s||a<u;return{offset:[(n=Mn({datas:i,distX:o[0],distY:o[1]}))[0],n[1]],isOutside:r}}function Ti(t,e){return t.isBound?t.offset:e.isSnap?ei(e).offset:0}function Ii(t,e,n,r,i,o){if(!$r(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var a,s,u,l,c=(p=or(g=mr(o.absolutePoses,[e,n]))).left,f=p.right,d=p.top,p=p.bottom,h={horizontal:g.map((function(t){return t[1]})),vertical:g.map((function(t){return t[0]}))},g=(c=(i=Si(t,i,Qr(Zr(t.props.snapDirections),{left:c,right:f,top:d,bottom:p,center:(c+f)/2,middle:(d+p)/2}),h)).vertical,f=i.horizontal,d=function(t,e,n){e=ii(t=ci(t,fi(t,e,[0,0],!1).map((function(t){return He(He({},t),{multiple:t.multiple.map((function(t){return 2*Math.abs(t)}))})})),n),0),t=ii(t,1);var r,i,o,a,s=0,u=0,l=e.isVerticalBound||t.isVerticalBound,c=e.isHorizontalBound||t.isHorizontalBound;return(l||c)&&(e=(n={datas:n,distX:-e.offset[0],distY:-t.offset[1]}).datas,t=n.distX,n=n.distY,r=e.beforeMatrix,i=e.matrix,o=e.is3d,e.startDragBeforeDist,a=e.startDragDist,e=e.absoluteOrigin,o=o?4:3,s=(r=jt(Xt(i,Yt(a,[t,n]),o),e))[0],u=r[1]),{vertical:{isBound:l,offset:s},horizontal:{isBound:c,offset:u}}}(t,g,o),p=d.vertical,h=d.horizontal,i=c.isSnap,t=f.isSnap,c.isBound||p.isBound),m=(o=f.isBound||h.isBound,d=Dr(c.offset,p.offset),c=Dr(f.offset,h.offset),p=r,f=[g,o],h=[i,t],r=[d,c],s=(d=[e,n])[0],u=d[1],d=f[0],f=f[1],c=h[0],h=h[1],n=-(e=r[0]),l=-(r=r[1]),p&&s&&u?(l=n=0,m=[],d&&f?m.push([0,r],[e,0]):d?m.push([e,0]):f?m.push([0,r]):c&&h?m.push([0,r],[e,0]):c?m.push([e,0]):h&&m.push([0,r]),m.length&&(m.sort((function(t,e){return ur(jt([s,u],t))-ur(jt([s,u],e))})),(c=m[0])[0]&&Math.abs(s)>v?(n=-c[0],l=u*Math.abs(s+n)/Math.abs(s)-u):c[1]&&Math.abs(u)>v&&(h=u,l=-c[1],n=s*Math.abs(u+l)/Math.abs(h)-s),p&&f&&d&&(Math.abs(n)>v&&Math.abs(n)<Math.abs(e)?(n*=a=Math.abs(e)/Math.abs(n),l*=a):Math.abs(l)>v&&Math.abs(l)<Math.abs(r)?(n*=a=Math.abs(r)/Math.abs(l),l*=a):(n=Dr(-e,n),l=Dr(-r,l))))):(n=s||d?-e:0,l=u||f?-r:0),[n,l]);return[{isBound:g,isSnap:i,offset:m[0]},{isBound:o,isSnap:t,offset:m[1]}]}function Si(t,e,n,r){var i=(r=pi(hi(t),(r=void 0===r?n:r).vertical,r.horizontal)).horizontal,o=(r=r.vertical,t=(e=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Kr(t,n.vertical,n.horizontal)).horizontal,n=e.vertical,e=Ti(i[0],t),Ti(r[0],n)),a=Math.abs(e),s=Math.abs(o);return{horizontal:{isBound:i[0].isBound,isSnap:t.isSnap,snapIndex:t.index,offset:e,dist:a,bounds:i,snap:t},vertical:{isBound:r[0].isBound,isSnap:n.isSnap,snapIndex:n.index,offset:o,dist:s,bounds:r,snap:n}}}function Ri(t,e,n,r,i){var o=(e=pi(e,n,r)).horizontal,a=(e=e.vertical,n=(t=Jr(t,n,r,i)).horizontal,r=t.vertical,i=Ti(o[0],n),t=Ti(e[0],r),Math.abs(i)),s=Math.abs(t);return{horizontal:{isBound:o[0].isBound,isSnap:n.isSnap,snapIndex:n.index,offset:i,dist:a,bounds:o,snap:n},vertical:{isBound:e[0].isBound,isSnap:r.isSnap,snapIndex:r.index,offset:t,dist:s,bounds:e,snap:r}}}function wi(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Oi(t){var e,n,r,i,o,a,s,u=(v=t.state).snapOffset,l=(v=v.containerClientRect).overflow,c=v.scrollHeight,d=v.scrollWidth,p=v.clientHeight,h=v.clientWidth,g=v.clientLeft,v=v.clientTop,m=void 0===(m=(s=t.props).snapGap)||m,E=s.verticalGuidelines,_=s.horizontalGuidelines,y=void 0===(y=s.snapThreshold)?5:y,T=void 0===(T=s.snapGridWidth)?0:T,I=void 0===(I=s.snapGridHeight)?0:I,S=void 0===(s=s.maxSnapElementGuidelineDistance)?1/0:s,R=(s=or(Er(t.state))).top,w=s.left,O=s.bottom,C={top:R,left:w,bottom:O,right:s=s.right,center:(w+s)/2,middle:(R+O)/2};w=$e([],function(t){var e=t.state;if(!(i=void 0===(i=t.props.elementGuidelines)?[]:i).length)return e.elementRects=[],[];var n=(e.elementRects||[]).filter((function(t){return!t.refresh})),r=i.map((function(t){return b(t)&&"element"in t?He(He({},t),{element:kr(t.element,!0)}):{element:kr(t,!0)}})).filter((function(t){return t.element})),i=function(t,e){return f(t,e,fe)}(n.map((function(t){return t.element})),r.map((function(t){return t.element}))),o=i.maintained,a=i.added,s=[],u=(o.forEach((function(t){var e=t[0];t=t[1];s[t]=n[e]})),function(t,e){if(!e.length)return[];var n=(t=t.state).containerClientRect,r=(i=t.targetClientRect).top,i=i.left,o=t.rootMatrix,a=t.is3d?4:3,s=(n=function(t,e,n){return t=rr(t,[e.clientLeft,e.clientTop],n),[e.left+t[0],e.top+t[1]]}(o,n,a),n[0]),u=n[1],l=(t=jt([t=(n=ve(Er(t))).minX,n=n.minY],xr(o,[i-s,r-u],a)).map((function(t){return Math.round(t%1==-.5?t-1:t)})))[0],c=t[1];return e.map((function(t){var e=(r=t.element.getBoundingClientRect()).left-s,n=(i=r.top-u)+r.height,r=e+r.width,i=(e=xr(o,[e,i],a))[0];e=e[1],n=(r=xr(o,[r,n],a))[0],r=r[1];return He(He({},t),{rect:{left:i+l,right:n+l,top:e+c,bottom:r+c,center:(i+n)/2+l,middle:(e+r)/2+c}})}))}(t,a.map((function(t){return r[t]}))).map((function(t,e){s[a[e]]=t})),e.elementRects=s,Zr(t.props.elementSnapDirections)),l=[];return s.forEach((function(t){var e=t.element,n=void 0===(n=t.top)?u.top:n,r=void 0===(r=t.left)?u.left:r,i=void 0===(i=t.right)?u.right:i,o=void 0===(o=t.bottom)?u.bottom:o,a=void 0===(a=t.center)?u.center:a,s=void 0===(s=t.middle)?u.middle:s,c=t.className,f=t.rect,d=(i=(n=Qr({top:n,right:i,left:r,bottom:o,center:a,middle:s},f)).horizontal,r=n.vertical,f.top),p=f.left,h=f.right-p,g=f.bottom-d,v=[h,g];r.forEach((function(n){l.push({type:"vertical",element:e,pos:[W(n,.1),d],size:g,sizes:v,className:c,elementRect:t})})),i.forEach((function(n){l.push({type:"horizontal",element:e,pos:[p,W(n,.1)],size:h,sizes:v,className:c,elementRect:t})}))})),l}(t),!0);return m&&w.push.apply(w,(e=C,n=y,R=(s=t.props).maxSnapElementGuidelineDistance,r=void 0===R?1/0:R,R=s.maxSnapElementGapDistance,i=void 0===R?1/0:R,o=t.state.elementRects,a=[],[["vertical",Xr,Hr],["horizontal",Hr,Xr]].forEach((function(t){var s=t[0],u=t[1],l=t[2],c=e[u.start],f=e[u.end],d=e[u.center],p=e[l.start],h=e[l.end];function g(t){return(t=t.rect)[u.end]<c+n?c-t[u.end]:f-n<t[u.start]?t[u.start]-f:-1}var v=o.filter((function(t){var e=t.rect;return!(e[l.start]>h||e[l.end]<p)&&0<g(t)})).sort((function(t,e){return g(t)-g(e)})),m=[];v.forEach((function(t){v.forEach((function(e){var n,r,i,o;t!==e&&(i=t.rect,n=e.rect,r=i[l.start],i=i[l.end],o=n[l.start],n[l.end]<r||i<o||m.push([t,e]))}))})),m.forEach((function(t){var o=t[0],l=(t=t[1],o.rect),p=t.rect,h=l[u.start],g=(l=l[u.end],p[u.start]),v=p[u.end],m=0,E=0,_=!1,b=!1,y=!1;if(l<=c&&f<=g){if(b=!0,E=l+(m=(g-l-(f-c))/2)+(f-c)/2,Math.abs(E-d)>n)return}else if(l<g&&v<c+n){if(_=!0,E=v+(m=g-l),Math.abs(E-c)>n)return}else{if(!(l<g&&f-n<h))return;if(y=!0,E=h-(m=g-l),Math.abs(E-f)>n)return}!m||!Ci(e,p,s,r)||i<m||a.push({type:s,pos:"vertical"===s?[E,0]:[0,E],element:t.element,size:0,className:t.className,isStart:_,isCenter:b,isEnd:y,gap:m,hide:!0,gapRects:[o,t]})}))})),a)),w.push.apply(w,function(t,e,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var a=[];if(e)for(var s=0;s<=r;s+=e)a.push({type:"horizontal",pos:[0,W(s-o,.1)],size:n,hide:!0});if(t)for(s=0;s<=n;s+=t)a.push({type:"vertical",pos:[W(s-i,.1),0],size:r,hide:!0});return a}(T,I,l?d:h,l?c:p,g,v)),w.push.apply(w,Mi(_||!1,E||!1,l?d:h,l?c:p,g,v,u)),w.filter((function(t){var e=t.element,n=t.elementRect;t=t.type;return!e||!n||(e=n.rect,Ci(C,e,t,S))}))}function Ci(t,e,n,r){return"horizontal"===n?Math.abs(t.right-e.left)<=r||Math.abs(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:"vertical"!==n||Math.abs(t.bottom-e.top)<=r||Math.abs(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom}function Mi(t,e,n,r,i,o,a){void 0===i&&(i=0),void 0===o&&(o=0);var s=[],u=(a=void 0===a?{left:0,top:0,right:0,bottom:0}:a).left,l=a.top,c=a.bottom,f=n+a.right-u,d=r+c-l;return t&&t.forEach((function(t){t=b(t)?t:{pos:t},s.push({type:"horizontal",pos:[u,W(t.pos-o+l,.1)],size:f,className:t.className})})),e&&e.forEach((function(t){t=b(t)?t:{pos:t},s.push({type:"vertical",pos:[W(t.pos-i+u,.1),l],size:d,className:t.className})})),s}function Di(t){var e,n,r,i,o=t.state;o.guidelines&&o.guidelines.length||(r=t.state.container,i=t.props.snapContainer||r,e=o.containerClientRect,n={left:0,top:0,bottom:0,right:0},r!==i&&(r=kr(i,!0))&&(r=zr(o,[(i=gr(r)).left-e.left,i.top-e.top]),i=zr(o,[i.right-e.right,i.bottom-e.bottom]),n.left=W(r[0],1e-5),n.top=W(r[1],1e-5),n.right=W(i[0],1e-5),n.bottom=W(i[1],1e-5)),o.snapOffset=n,o.guidelines=Oi(t),o.enableSnap=!0)}function xi(t,e,n,r,i,o){return mr(t=ir(t,e,n,o?4:3),jt(i,xn(t,r)))}function Ai(t,e,n,r,i,o){var a,s,u,l,c=o.fixedDirection;a=n,s=c,l=[],r?(1!==Math.abs(s[0])||1!==Math.abs(s[1])?l.push([s,[-1,-1]],[s,[-1,1]],[s,[1,-1]],[s,[1,1]]):l.push([s,[a[0],-a[1]]],[s,[-a[0],a[1]]]),l.push([s,a])):a[0]&&a[1]||!a[0]&&!a[1]?(u=a[0]?a:[1,1],[1,-1].forEach((function(t){[1,-1].forEach((function(e){e=[t*u[0],e*u[1]],s[0]===e[0]&&s[1]===e[1]||l.push([s,e])}))}))):a[0]?(1===Math.abs(s[0])?[1]:[1,-1]).forEach((function(t){l.push([[s[0],-1],[t*a[0],-1]],[[s[0],0],[t*a[0],0]],[[s[0],1],[t*a[0],1]])})):a[1]&&(1===Math.abs(s[1])?[1]:[1,-1]).forEach((function(t){l.push([[-1,s[1]],[-1,t*a[1]]],[[0,s[1]],[0,t*a[1]]],[[1,s[1]],[1,t*a[1]]])})),c=l,n=fi(t,e,n,r),e=$e($e([],function(t,e,n,r,i,o){return n.map((function(n){var a=n[0],s=(n=n[1],xn(e,a)),u=xn(e,n),l=r?(g=i,p=function(t,e,n){var r,i,o=(t=hi(t)).left,a=t.top,s=t.right,u=(t=t.bottom,n[0]),l=n[1],c=(e=jt(n,e))[0],f=(e=e[1],Math.abs(c)<dn&&(c=0),0<(e=Math.abs(e)<dn?0:e)),d=0<c,p={isBound:!1,offset:0,pos:0},h={isBound:!1,offset:0,pos:0};return 0===c&&0===e||(0===c?f?t<l&&(h.pos=t,h.offset=l-t):l<a&&(h.pos=a,h.offset=l-a):0===e?d?s<u&&(p.pos=s,p.offset=u-s):u<o&&(p.pos=o,p.offset=u-o):(e=n[1]-(n=e/c)*u,r=c=0,i=!1,d&&s<=u?(c=n*s+e,r=s,i=!0):!d&&u<=o&&(c=n*o+e,r=o,i=!0),(i=(!i||!(c<a||t<c))&&i)||(f&&t<=l?(r=((c=t)-e)/n,i=!0):!f&&l<=a&&(r=((c=a)-e)/n,i=!0)),i&&(p.isBound=!0,p.pos=r,p.offset=u-r,h.isBound=!0,h.pos=c,h.offset=l-c))),{vertical:p,horizontal:h}}(c=t,h=s,f=u),l=p.horizontal,p=p.vertical,g=g?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:function(t,e,n){var r=n[0],i=n[1],o=e[0],a=e[1],s=(e=jt(n,e))[0],u=0<(e=e[1]),l=0<s,c=(s=Nr(s),e=Nr(e),{isSnap:!1,offset:0,pos:0}),f={isSnap:!1,offset:0,pos:0};if(0===s&&0===e)return{vertical:c,horizontal:f};var d,p=(t=Kr(t,s?[r]:[],e?[i]:[])).vertical;t=t.horizontal,p.posInfos.filter((function(t){return t=t.pos,l?o<=t:t<=o})),t.posInfos.filter((function(t){return t=t.pos,u?a<=t:t<=a})),p.isSnap=0<p.posInfos.length,t.isSnap=0<t.posInfos.length;var h=(p=ei(p)).isSnap,g=(p=p.guideline,(t=ei(t)).isSnap),v=(t=t.guideline,g?t.pos[1]:0);return p=h?p.pos[0]:0,0===s?g&&(f.isSnap=!0,f.pos=t.pos[1],f.offset=i-f.pos):0===e?h&&(c.isSnap=!0,c.pos=p,c.offset=r-p):(n=n[1]-(t=e/s)*r,s=e=0,d=!1,h?(e=t*(s=p)+n,d=!0):g&&(s=((e=v)-n)/t,d=!0),d&&(c.isSnap=!0,c.pos=s,c.offset=r-s,f.isSnap=!0,f.pos=e,f.offset=i-e)),{vertical:c,horizontal:f}}(c,h,f),c=g.horizontal,h=g.vertical,f=wi(l,c),g=wi(p,h),d=Math.abs(f),v=Math.abs(g),{horizontal:{isBound:l.isBound,isSnap:c.isSnap,offset:f,dist:d},vertical:{isBound:p.isBound,isSnap:h.isSnap,offset:g,dist:v}}):Si(t,i,{vertical:[u[0]],horizontal:[u[1]]}),c=l.horizontal,f=c.offset,d=c.isBound,p=c.isSnap,h=l.vertical,g=h.offset,v=h.isBound,m=h.isSnap,E=jt(n,a);if(!g&&!f)return{isBound:v||d,isSnap:m||p,sign:E,offset:[0,0]};R=l,b=r,_=V(_=s,w=u)/Math.PI*180,O=(w=R.vertical).isBound,y=w.isSnap,w=w.dist,T=(R=R.horizontal).isBound,I=R.isSnap,S=(_%=180)<3||177<_,_=87<_&&_<93;var _,b,y,T,I,S,R=R.dist<w&&(O||y&&!_&&(!b||!S))?"vertical":!T&&(!I||S||b&&_)?"":"horizontal";if(!R)return{sign:E,isBound:!1,isSnap:!1,offset:[0,0]};var w="vertical"==R,O=[0,0];return O=(O=r||1!==Math.abs(n[0])||1!==Math.abs(n[1])||a[0]===n[0]||a[1]===n[1]?yi(s,u,-(w?g:f),w,o).offset:Mn({datas:o,distX:-g,distY:-f})).map((function(t,e){return t*(E[e]?2/E[e]:0)})),{sign:E,isBound:w?v:d,isSnap:w?m:p,offset:O}}))}(t,e,c,r,i,o),!0),ci(t,n,o),!0),c=ii(e,0),r=ii(e,1);return{width:{isBound:c.isBound,offset:c.offset[0]},height:{isBound:r.isBound,offset:r.offset[1]}}}function Pi(t,e,n,r,i,o,a,s){for(var u,l,c,f,d,p,h,g,v,m,E,_,b,y,T,I,S,R,w,O=Er(t.state),C=t.props.keepRatio,M=0,D=0,x=0;x<2;++x){var A=(P=Ai(t,e(M,D),i,C,a,s)).width,P=P.height,L=A.isBound,N=P.isBound,G=A.offset,k=P.offset;if(1===x&&(L||(G=0),N||(k=0)),0===x&&a&&!L&&!N)return[0,0];C&&(A=Math.abs(G)*(n?1/n:1),P=Math.abs(k)*(r?1/r:1),(L&&N?A<P:N||!L&&A<P)?G=n*k/r:k=r*G/n),M+=G,D+=k}return i[0]&&i[1]&&(h=t,g=O,v=o,m=s,T=[-(O=i)[0],-O[1]],I=(o=h.state).width,S=o.height,o=h.props.bounds,w=R=1/0,o&&(h=[[O[0],-O[1]],[-O[0],O[1]]],O=o.left,E=void 0===O?-1/0:O,O=o.top,_=void 0===O?-1/0:O,O=o.right,b=void 0===O?1/0:O,O=o.bottom,y=void 0===O?1/0:O,h.forEach((function(t){var e,n,r=t[0]!==T[0],i=t[1]!==T[1],o=(t=xn(g,t),360*V(v,t)/Math.PI);i&&(e=t.slice(),(Math.abs(o-360)<2||Math.abs(o-180)<2)&&(e[1]=v[1]),n=(i=yi(v,e,(v[1]<t[1]?y:_)-t[1],!1,m)).offset[1],i=i.isOutside,isNaN(n)||(w=S+(i?1:-1)*Math.abs(n))),r&&(e=t.slice(),(Math.abs(o-90)<2||Math.abs(o-270)<2)&&(e[0]=v[0]),n=(i=yi(v,e,(v[0]<t[0]?b:E)-t[0],!0,m)).offset[0],r=i.isOutside,isNaN(n)||(R=I+(r?1:-1)*Math.abs(n)))}))),O=(o={maxWidth:R,maxHeight:w}).maxWidth,h=o.maxHeight,o=t,u=e(M,D).map((function(t){return t.map((function(t){return W(t,1e-4)}))})),l=n+M,c=r+D,p=s,d=(o=Si(o,d=a,{vertical:[(u=xn(u,f=i))[0]],horizontal:[u[1]]})).horizontal.offset,M+=G=(d=(u=o.vertical.offset)||d?(p=(o=Mn({datas:p,distX:-u,distY:-d}))[0],u=o[1],[Math.min(O||1/0,l+f[0]*p)-l,Math.min(h||1/0,c+f[1]*u)-c]):[0,0])[0],D+=k=d[1]),[M,D]}function Li(t){var e=[];return t.forEach((function(t){t.guidelineInfos.forEach((function(t){t=t.guideline,-1<e.indexOf(t)||e.push(t)}))})),e}function Ni(t,e,n,r,i,o){e=(o=pi(hi(t,o),e,n)).vertical,n=o.horizontal,e.forEach((function(t){t.isBound&&r.push({type:"bounds",pos:t.pos})})),n.forEach((function(t){t.isBound&&i.push({type:"bounds",pos:t.pos})})),o=function(t){if(!(f=t.props.innerBounds))return{vertical:[],horizontal:[]};var e=t.getRect(),n=xn(e=[e.pos1,e.pos2,e.pos3,e.pos4],[0,0]),r=f.left,i=f.top,o=f.width,a=f.height,s=[[r,i],[r,i+a]],u=[[r,i],[r+o,i]],l=[[r+o,i],[r+o,i+a]],c=[[r,i+a],[r+o,i+a]],f=fi(t,e,[0,0],!1),d=[],p=[],h={top:!1,bottom:!1,left:!1,right:!1};return f.forEach((function(t){var e=t.line,f=(t=t.lineConstants,(g=oi(n,e)).horizontal),g=g.vertical,v=li(e,t,u,g,1,!0),m=(g=li(e,t,c,g,1,!0),li(e,t,s,f,1,!0));e=li(e,t,l,f,1,!0);v.isBound&&!h.top&&(d.push(i),h.top=!0),g.isBound&&!h.bottom&&(d.push(i+a),h.bottom=!0),m.isBound&&!h.left&&(p.push(r),h.left=!0),e.isBound&&!h.right&&(p.push(r+o),h.right=!0)})),{horizontal:d,vertical:p}}(t),e=o.vertical,n=o.horizontal,e.forEach((function(t){0<=L(r,(function(e){var n=e.type;e=e.pos;return"bounds"===n&&e===t}))||r.push({type:"bounds",pos:t})})),n.forEach((function(t){0<=L(i,(function(e){var n=e.type;e=e.pos;return"bounds"===n&&e===t}))||i.push({type:"bounds",pos:t})}))}var Gi=Gr("",["resizable","scalable"]);xt={name:"snappable",dragRelation:"strong",props:{snappable:[Boolean,Array],snapContainer:Object,snapDirections:[Boolean,Object],elementSnapDirections:[Boolean,Object],snapGap:Boolean,snapGridWidth:Number,snapGridHeight:Number,isDisplaySnapDigit:Boolean,isDisplayInnerSnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object,snapDistFormat:Function,maxSnapElementGuidelineDistance:Number,maxSnapElementGapDistance:Number},events:{onSnap:"snap"},css:[":host {\n    --bounds-color: #d66;\n}\n.guideline {\n    pointer-events: none;\n    z-index: 2;\n}\n.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}\n.guideline-group {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.guideline-group .size-value {\n    position: absolute;\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.guideline-group.horizontal .size-value {\n    transform-origin: 50% 100%;\n    transform: translateX(-50%);\n    left: 50%;\n    bottom: 5px;\n}\n.guideline-group.vertical .size-value {\n    transform-origin: 0% 50%;\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.guideline.gap {\n    background: #f55;\n}\n.size-value.gap {\n    color: #f55;\n}\n"],render:function(t,e){var n=(v=t.state).top,r=v.left,i=v.pos1,o=v.pos2,a=v.pos3,s=v.pos4,u=v.snapRenderInfo;if(!u||!$r(t,""))return[];v.guidelines=Oi(t);var l,c,f,d,p,h,g,v=Math.min(i[0],o[0],a[0],s[0]),m=(i=Math.min(i[1],o[1],a[1],s[1]),o=u.externalPoses||[],a=Er(t.state),[]),E=[],_=[],b=[],y=(s=[],(g=or(a)).width),T=g.height,I=g.top,S=g.left,R=g.bottom,w={left:S,right:g=g.right,top:I,bottom:R,center:(S+g)/2,middle:(I+R)/2},O=0<o.length;o=O?or(o):{},u.request||(u.direction&&s.push(function(t,e,n){var r,i=[];if(n[0]&&n[1])i=[n,[-n[0],n[1]],[n[0],-n[1]]].map((function(t){return xn(e,t)}));else if(n[0]||n[1])t.props.keepRatio?i=[[-1,-1],[-1,1],[1,-1],[1,1],n].map((function(t){return xn(e,t)})):(r=e,1<(i=Dn(n).map((function(t){return r[t]}))).length&&i.push([(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]));else for(var o=[e[0],e[1],e[3],e[2],e[0]],a=0;a<4;++a)i.push(o[a]),i.push([(o[a][0]+o[a+1][0])/2,(o[a][1]+o[a+1][1])/2]);return Kr(t,i.map((function(t){return t[0]})),i.map((function(t){return t[1]})),1)}(t,a,u.direction)),u.snap&&(a=or(a),u.center&&(a.middle=(a.top+a.bottom)/2,a.center=(a.left+a.right)/2),s.push(ti(t,a,1))),O&&(u.center&&(o.middle=(o.top+o.bottom)/2,o.center=(o.left+o.right)/2),s.push(ti(t,o,1))),s.forEach((function(t){var e=t.vertical.posInfos;t=t.horizontal.posInfos;m.push.apply(m,e.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),E.push.apply(E,t.filter((function(t){return t.guidelineInfos.some((function(t){return!t.guideline.hide}))})).map((function(t){return{type:"snap",pos:t.pos}}))),_.push.apply(_,Li(e)),b.push.apply(b,Li(t))}))),Ni(t,[S,g],[I,R],m,E),O&&Ni(t,[o.left,o.right],[o.top,o.bottom],m,E,u.externalBounds),a=$e($e([],_,!0),b,!0),s=a.filter((function(t){return t.element&&!t.gapRects})),S=a.filter((function(t){return t.gapRects})).sort((function(t,e){return t.gap-e.gap}));return Rr(t,"onSnap",{guidelines:a.filter((function(t){return!t.element})),elements:s,gaps:S},!0),$e($e($e($e($e($e([],function(t,e,n,r,i){var o=t.props.isDisplayInnerSnapDigit,a=[];return["vertical","horizontal"].forEach((function(s){var u,l,c,f,d,p,h,g,v,m,E=e.filter((function(t){return t.type===s})),_="vertical"===s?1:0,b=_?0:1,y=(l=o,h="vertical"===(u=s)?1:0,v=r[(g=(p="vertical"===u?0:1)?Xr:Hr).start],m=r[g.end],c=function(t){return t.pos[p]},f=[],d=[],E.forEach((function(t,e){e=c(t);var n=d.indexOf(e),r=f[n]||[];-1===n&&(d.push(e),f.push(r)),r.push(t)})),E=f.map((function(t){var e=[],n=[];return t.forEach((function(t){var r,i,o,a=t.element,s=t.elementRect.rect;s[g.end]<v?e.push(t):m<s[g.start]?n.push(t):s[g.start]<=v&&m<=s[g.end]&&l&&(r=t.pos,i={element:a,rect:He(He({},s),((i={})[g.end]=s[g.start],i))},s={element:a,rect:He(He({},s),((a={})[g.start]=s[g.end],a))},a=[0,0],(o=[0,0])[p]=r[p],o[h]=r[h],a[p]=r[p],a[h]=r[h]+t.size,e.push({type:u,pos:o,size:0,elementRect:i}),n.push({type:u,pos:a,size:0,elementRect:s}))})),e.sort((function(t,e){return e.pos[h]-t.pos[h]})),n.sort((function(t,e){return t.pos[h]-e.pos[h]})),{total:t,start:e,end:n,inner:[]}})),_?Hr:Xr),T=_?Xr:Hr,I=r[y.start],S=r[y.end];E.forEach((function(e){var o=e.total,u=e.start,l=e.end,c=(e=e.inner,n[b]+o[0].pos[b]-r[T.start]),f=r;u.forEach((function(e){var r,o=e.elementRect.rect,u=f[y.start]-o[y.end];0<u&&((r=[0,0])[_]=n[_]+f[y.start]-I-u,r[b]=c,a.push(bi(t,s,"dashed",a.length,u,r,e.className,i))),f=o})),f=r,l.forEach((function(e){var r,o=e.elementRect.rect,u=o[y.start]-f[y.end];0<u&&((r=[0,0])[_]=n[_]+f[y.end]-I,r[b]=c,a.push(bi(t,s,"dashed",a.length,u,r,e.className,i))),f=o})),e.forEach((function(e){var r=e.elementRect.rect,o=I-r[y.start],u=(r=r[y.end]-S,[0,0]),l=[0,0];u[_]=n[_]-o,u[b]=c,l[_]=n[_]+S-I,l[b]=c,a.push(bi(t,s,"dashed",a.length,o,u,e.className,i)),a.push(bi(t,s,"dashed",a.length,r,l,e.className,i))}))}))})),a}(t,s,[v,i],w,e),!0),(l=t,c=S,f=[v,i],d=w,p=e,h=[],["horizontal","vertical"].forEach((function(t){var e=c.filter((function(e){return e.type===t})).slice(0,1),n="vertical"===t?0:1,r=n?0:1,i=n?Hr:Xr,o=n?Xr:Hr,a=d[i.start],s=d[i.end],u=d[o.start],g=d[o.end];e.forEach((function(t){var e=t.gap,c=(t=t.gapRects,Math.max.apply(Math,$e([u],t.map((function(t){return t.rect[o.start]})),!1))),d=Math.min.apply(Math,$e([g],t.map((function(t){return t.rect[o.end]})),!1)),v=(c+d)/2;c!==d&&v!=(u+g)/2&&t.forEach((function(t){var o=t.rect,c=(t=t.className,[f[0],f[1]]);if(o[i.end]<a)c[n]+=o[i.end]-a;else{if(!(s<o[i.start]))return;c[n]+=o[i.start]-a-e}c[r]+=v-u,h.push(bi(l,n?"vertical":"horizontal","gap",h.length,e,c,t,p))}))}))})),h),!0),_i(t,"horizontal",b,[r,n],w,e),!0),_i(t,"vertical",_,[r,n],w,e),!0),Ei(t,"horizontal",E,v,n,y,0,e),!0),Ei(t,"vertical",m,i,r,T,1,e),!0)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Di(t)},drag:function(t){t.state.guidelines=Oi(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){return!(!Gi(t,e)&&!$i(t,e))||(!e.isRequest&&e.inputEvent?H(e.inputEvent.target,Wn("snap-control")):void 0)},dragControlStart:function(t){t.state.snapRenderInfo=null,Di(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Di(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){(t=t.state).enableSnap=!1,t.guidelines=[],t.snapRenderInfo=null,t.elementRects=[]}};function ki(t,e,n,r){var i=(a=t.state).renderPoses,o=a.rotation,a=a.direction,s=dr(t.props,e).zoom,u=0<a?1:-1,l=o/Math.PI*180,c={},f=((a=t.renderState).renderDirectionMap||(a.renderDirectionMap={}),a.renderDirectionMap);return n.forEach((function(t){t=t.dir,c[t]=!0})),n.map((function(t){var n=t.data,a=t.classNames,d=(t=t.dir,En[t]);if(!d||!c[t])return null;f[t]=!0;var p=(W(l,15)+u*_n[t]+720)%180,h={};return B(n).forEach((function(t){h["data-".concat(t)]=n[t]})),r.createElement("div",He({className:Wn.apply(void 0,$e(["control","direction",t,e],a,!1)),"data-rotation":p,"data-direction":t},h,{key:"direction-".concat(t),style:fr.apply(void 0,$e([o,s],d.map((function(t){return i[t]})),!1))}))}))}function Bi(t,e,n,r){var i=dr(t.props,n).renderDirections;return(e=void 0===i?e:i)?ki(t,n,(!0===e?vn:e).map((function(t){return{data:{},classNames:[],dir:t}})),r):[]}function zi(t,e,n,r,i,o){for(var a=[],s=6;s<arguments.length;s++)a[s-6]=arguments[s];var u=V(n,r),l=e?W(u/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(o),className:Wn.apply(void 0,$e(["line","direction",e?"edge":"",e],a,!1)),"data-rotation":l,"data-line-index":o,"data-direction":e,style:cr(n,r,i,u)})}function Fi(t,e,n,r,i){return(!0===n?gn:n).map((function(n,o){var a,s=(a=En[n])[0];if(null!=(a=a[1]))return zi(t,n,r[s],r[a],i,"".concat(e,"Edge").concat(o),e)})).filter(Boolean)}function Ui(t){return function(e,n){var r=dr(e.props,t).edge;return r&&(!0===r||r.length)?$e($e([],Fi(n,t,r,e.state.renderPoses,e.props.zoom),!0),Bi(e,["nw","ne","sw","se"],t,n),!0):qi(e,t,n)}}function qi(t,e,n){return Bi(t,vn,e,n)}var Vi={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number,startDragRotate:Number,edgeDraggable:Boolean},events:{onDragStart:"dragStart",onDrag:"drag",onDragEnd:"dragEnd",onDragGroupStart:"dragGroupStart",onDragGroup:"dragGroup",onDragGroupEnd:"dragGroupEnd"},render:function(t,e){var n=(r=t.props).throttleDragRotate,r=r.zoom,i=(t=t.state).dragInfo;t=t.beforeOrigin;return n&&i&&((n=i.dist)[0]||n[1])?(i=ur(n),n=V(n,[0,0]),[e.createElement("div",{className:Wn("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(i,"px"),transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(r,")")}})]):[]},dragStart:function(t,e){var n,r=e.datas,i=e.parentEvent,o=e.parentGesto,a=(n=t.state).target;return!(n=n.gestos).draggable&&(n.draggable=o||t.targetGesto,o=wr(a),r.datas={},r.left=parseFloat(o.left||"")||0,r.top=parseFloat(o.top||"")||0,r.bottom=parseFloat(o.bottom||"")||0,r.right=parseFloat(o.right||"")||0,r.startValue=[0,0],Sn(t,e),Ln(e,"translate"),r.absolutePoses=Er(t.state),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0],a=Tr(t,e,He({set:function(t){r.startValue=t}},Pn(e))),!1!==(i||Rr(t,"onDragStart",a))?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(n.draggable=null,r.isPinch=!1),!!r.isDrag&&a)},drag:function(t,e){if(e){Rn(e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,o=e.isPinch,a=e.isRequest,s=e.deltaOffset,u=e.distX,l=e.distY,c=n.isDrag,f=n.prevDist,d=n.prevBeforeDist,p=n.startValue;if(c){s&&(u+=s[0],l+=s[1]);var h=(c=t.props).parentMoveable,g=!r&&c.throttleDrag||0,v=!r&&c.throttleDragRotate||0,m=!1,E=0,_=(i=(!r&&0<v&&(u||l)&&(c=W((c=c.startDragRotate||0)+180*V([0,0],[u,l])/Math.PI,v)-c,_=l*Math.abs(Math.cos((c-90)/180*Math.PI)),_=ur([u*Math.abs(Math.cos(c/180*Math.PI)),_]),E=c*Math.PI/180,u=_*Math.cos(E),l=_*Math.sin(E)),o||r||i||v&&!u&&!l||(_=(c=Ii(t,u,l,v,a||s,n))[0],E=c[1],i=_.isSnap,a=_.isBound,s=_.offset,c=E.isSnap,_=E.isBound,m=i||c||a||_,u+=s,l+=E.offset),Yt(Cn({datas:n,distX:u,distY:l}),p)),c=Yt(function(t){var e=t.datas;return Xt(On(e,function(t,e){for(var n=ne(4),r=0;r<3;++r)n[12+r]=t[r]||0;return n}([(t=Cn({datas:e,distX:t.distX,distY:t.distY}))[0],t[1]])),Ft([0,0,0],4),4)}({datas:n,distX:u,distY:l}),p),a=(v||m||(X(c,g),X(i,g)),X(c,dn),X(i,dn),jt(i,p)),jt(c,p));s=jt(_,f),E=jt(a,d),u=(n.prevDist=_,n.prevBeforeDist=a,n.passDelta=s,n.passDist=_,n.left+a[0]),l=n.top+a[1],v=n.right-a[0],m=n.bottom-a[1];if(Gn(e,g=wn(n,"translate(".concat(c[0],"px, ").concat(c[1],"px)"),"translate(".concat(_[0],"px, ").concat(_[1],"px)"))),t.state.dragInfo.dist=r?[0,0]:_,r||h||!s.every((function(t){return!t}))||!E.some((function(t){return!t})))return f=(p=t.state).width,d=p.height,n=Tr(t,e,He({transform:g,dist:_,delta:s,translate:c,beforeDist:a,beforeDelta:E,beforeTranslate:i,left:u,top:l,right:v,bottom:m,width:f,height:d,isPinch:o},br({transform:g},e))),r||Rr(t,"onDrag",n),n}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return!(!r[0]&&!r[1])&&(n.deltaOffset=[0,0],this.drag(t,He(He({},e),{deltaOffset:r})))},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,r.isDrag)return r.isDrag=!1,r=Ir(t,e,{}),n||Rr(t,"onDragEnd",r),r},dragGroupStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=this.dragStart(t,e);return!!o&&(r=Vr(t,this,"dragStart",[r||0,i||0],e,!1,"draggable"),i=Rr(t,"onDragGroupStart",He(He({},o),{targets:t.props.targets,events:r})),n.isDrag=!1!==i,!!n.isDrag&&o)},dragGroup:function(t,e){if(e.datas.isDrag){var n=this.drag(t,e);e=Vr(t,this,"drag",e.datas.passDelta,e,!1,"draggable");if(n)return Rr(t,"onDragGroup",t=He({targets:t.props.targets,events:e},n)),t}},dragGroupEnd:function(t,e){var n,r=e.isDrag;if(e.datas.isDrag)return this.dragEnd(t,e),n=Vr(t,this,"dragEnd",[0,0],e,!1,"draggable"),Rr(t,"onDragGroupEnd",Ir(t,e,{targets:t.props.targets,events:n})),r},request:function(t){var e={},n=t.getRect(),r=0,i=0;return{isControl:!1,requestStart:function(){return{datas:e}},request:function(t){return"x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY),{datas:e,distX:r,distY:i}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}},Yi=(d=Gr("resizable"),{name:"resizable",ableGroup:"size",canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,keepRatio:Boolean,resizeFormat:Function,keepRatioFinally:Boolean,edge:Boolean},events:{onResizeStart:"resizeStart",onBeforeResize:"beforeResize",onResize:"resize",onResizeEnd:"resizeEnd",onResizeGroupStart:"resizeGroupStart",onBeforeResizeGroup:"beforeResizeGroup",onResizeGroup:"resizeGroup",onResizeGroupEnd:"resizeGroupEnd"},render:Ui("resizable"),dragControlCondition:d,dragControlStart:function(t,e){var n=e.inputEvent,r=e.isPinch,i=e.isGroup,o=e.parentDirection,a=e.parentGesto,s=e.datas,u=e.parentFixedDirection,l=e.parentEvent,c=(o=o||(r?[0,0]:vr(n.target)),(n=t.state).target),f=n.width,d=n.height,p=n.gestos;if(!o||!c)return!1;if(p.resizable)return!1;function h(t){s.ratio=t&&isFinite(t)?t:0}function g(t){s.fixedDirection=t,s.fixedPosition=xn(s.startPositions,t)}function v(t){s.minSize=[z("".concat(t[0]),0)||0,z("".concat(t[1]),0)||0]}function m(t){I((t=[t[0]||1/0,t[1]||1/0])[0])&&!isFinite(t[0])||(t[0]=z("".concat(t[0]),0)||1/0),I(t[1])&&!isFinite(t[1])||(t[1]=z("".concat(t[1]),0)||1/0),s.maxSize=t}return p.resizable=a||t.controlGesto,r||Sn(t,e),s.datas={},s.direction=o,s.startOffsetWidth=f,s.startOffsetHeight=d,s.prevWidth=0,s.prevHeight=0,s.minSize=[0,0],s.startWidth=n.cssWidth,s.startHeight=n.cssHeight,s.maxSize=[1/0,1/0],i||(s.minSize=[n.minOffsetWidth,n.minOffsetHeight],s.maxSize=[n.maxOffsetWidth,n.maxOffsetHeight]),c=t.props.transformOrigin||"% %",s.transformOrigin=c&&T(c)?c.split(" "):c,s.startOffsetMatrix=n.offsetMatrix,s.startTransformOrigin=n.transformOrigin,s.isWidth=null!=(p=null==e?void 0:e.parentIsWidth)?p:!o[0]&&!o[1]||o[0]||!o[1],s.startPositions=Er(t.state),h(f/d),g(u||[-o[0],-o[1]]),s.setFixedDirection=g,s.setMin=v,s.setMax=m,a=Tr(t,e,{direction:o,startRatio:s.ratio,set:function(t){var e=t[0];t=t[1];s.startWidth=e,s.startHeight=t},setMin:v,setMax:m,setRatio:h,setFixedDirection:g,setOrigin:function(t){s.transformOrigin=t},dragStart:Vi.dragStart(t,(new Tn).dragStart([0,0],e))}),r=l||Rr(t,"onResizeStart",a),s.startFixedDirection=s.fixedDirection,!1!==r&&(s.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),!!s.isResize&&a},dragControl:function(t,e){var n=e.datas,r=e.parentFlag,i=e.isPinch,o=e.parentKeepRatio,a=e.dragClient,s=e.parentDist,u=e.isRequest,l=e.isGroup,c=e.parentEvent,f=e.resolveMatrix,d=n.isResize,p=n.transformOrigin,h=n.startWidth,g=n.startHeight,v=n.prevWidth,m=n.prevHeight,E=n.minSize,_=n.maxSize,b=n.ratio,y=n.startOffsetWidth,T=n.startOffsetHeight,I=n.isWidth;if(d){f&&(d=t.state.is3d,f=n.startOffsetMatrix,S=n.startTransformOrigin,d=d?4:3,O=ae(Bn(e)),S=ir(f=An(f,O=d!==(f=Math.sqrt(O.length))?Ut(O,f,d):O,S,d),y,T,d),n.startPositions=S,n.nextTargetMatrix=O,n.nextAllMatrix=f);var S,R=(d=dr(t.props,"resizable")).resizeFormat,w=void 0===(S=d.throttleResize)?r?0:1:S,O=d.parentMoveable,C=(f=d.keepRatioFinally,S=n.direction),M=0,D=0,x=(S[0]||S[1]||(C=[1,1]),b&&(null!=o?o:d.keepRatio)||!1),A=(o=L())[0],P=o[1];d=(c||(n.setFixedDirection(n.fixedDirection),Rr(t,"onBeforeResize",Tr(t,e,{startFixedDirection:n.startFixedDirection,setFixedDirection:function(t){return n.setFixedDirection(t),t=L(),A=t[0],P=t[1],[A,P]},boundingWidth:A,boundingHeight:P,setSize:function(t){A=t[0],P=t[1]}},!0))),a),o=(a||(d=!r&&i?jn(t,[0,0]):n.fixedPosition),[0,0]),u=(i||(o=function(t,e,n,r,i,o,a){if(!$r(t,"resizable"))return[0,0];var s=a.fixedDirection,u=a.nextAllMatrix,l=t.state,c=l.allMatrix,f=l.is3d;return Pi(t,(function(t,r){return xi(u||c,e+t,n+r,s,i,f)}),e,n,r,i,o,a)}(t,A,P,S,d,u,n)),s&&(s[0]||(o[0]=0),s[1]||(o[1]=0)),x?(C[0]&&C[1]&&o[0]&&o[1]&&(Math.abs(o[0])>Math.abs(o[1])?o[1]=0:o[0]=0),(a=!o[0]&&!o[1])&&N(),C[0]&&!C[1]||o[0]&&!o[1]||a&&I?(A+=o[0],P=A/b):(!C[0]&&C[1]||!o[0]&&o[1]||a&&!I)&&(P+=o[1],A=P*b)):(A+=o[0],P+=o[1],A=Math.max(0,A),P=Math.max(0,P)),r=function(t,e,n,r){if(!r)return t.map((function(t,r){return F(t,e[r],n[r])}));var i=t[0],o=t[1],a=(s=U(t,e,!1,r=!0===r?i/o:r))[0],s=s[1];r=(t=U(t,n,!0,r))[0],t=t[1];return i<a||o<s?(i=a,o=s):(r<i||t<o)&&(i=r,o=t),[i,o]}([A,P],E,_,!!x&&b),A=r[0],P=r[1],N(),x&&(l||f)&&(I?P=A/b:A=P*b),[(M=A-y)-v,(D=P-T)-m]),s=(n.prevWidth=M,n.prevHeight=D,Yn(t,A,P,d,p,n));if(O||!u.every((function(t){return!t}))||!s.every((function(t){return!t})))return o=(a=Vi.drag(t,yn(e,t.state,s,!!i,!1,"draggable"))).transform,r=Tr(t,e,He({width:E=h+M,height:_=g+D,offsetWidth:Math.round(A),offsetHeight:Math.round(P),startRatio:b,boundingWidth:A,boundingHeight:P,direction:S,dist:[M,D],delta:u,isPinch:!!i,drag:a},yr({style:{width:"".concat(E,"px"),height:"".concat(_,"px")},transform:o},a,e))),c||Rr(t,"onResize",r),r}function L(){var t=n.fixedDirection,r=Ur(C,x,n,e);M=r.distWidth,D=r.distHeight,r=C[0]-t[0]||x?Math.max(y+M,dn):y,t=C[1]-t[1]||x?Math.max(T+D,dn):T;return x&&y&&T&&(I?t=r/b:r=t*b),[r,t]}function N(){var t;R&&(t=R([A,P]),A=t[0],P=t[1]),A=W(A,w),P=W(P,w)}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,o=n.startOffsetHeight,a=n.prevWidth,s=n.prevHeight;if(r)return i=(r=t.state).width-(i+a),a=r.height-(o+s),r=3<Math.abs(i),o=3<Math.abs(a),r&&(n.startWidth+=i,n.startOffsetWidth+=i,n.prevWidth+=i),o&&(n.startHeight+=a,n.startOffsetHeight+=a,n.prevHeight+=a),r||o?this.dragControl(t,e):void 0},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize)return n.isResize=!1,n=Ir(t,e,{}),r||Rr(t,"onResizeEnd",n),n},dragGroupControlCondition:d,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,He(He({},e),{isGroup:!0}));if(!r)return!1;var i=qr(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition;e=xn(r.datas.startPositions||Er(e.state),i),e=(i=Xt(ee(-t.rotation/180*Math.PI,3),[e[0]-o[0],e[1]-o[1],1],3))[0],o=i[1];return r.datas.originalX=e,r.datas.originalY=o,r}var a=n.startOffsetWidth,s=n.startOffsetHeight;function u(){var t=n.minSize;i.forEach((function(e){var n=(e=e.datas).minSize,r=e.startOffsetWidth;e=e.startOffsetHeight,r=a*(r?n[0]/r:0),n=s*(e?n[1]/e:0);t[0]=Math.max(t[0],r),t[1]=Math.max(t[1],n)}))}function l(){var t=n.maxSize;i.forEach((function(e){var n=(e=e.datas).maxSize,r=e.startOffsetWidth;e=e.startOffsetHeight,r=a*(r?n[0]/r:0),n=s*(e?n[1]/e:0);t[0]=Math.min(t[0],r),t[1]=Math.min(t[1],n)}))}function c(t){r.setFixedDirection(t),f.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))}var f=Yr(t,this,"dragControlStart",e,o);u(),l(),n.setFixedDirection=c,e=He(He({},r),{targets:t.props.targets,events:f.map((function(t){return He(He({},t),{setMin:function(e){t.setMin(e),u()},setMax:function(e){t.setMax(e),l()}})})),setFixedDirection:c,setMin:function(t){r.setMin(t),u()},setMax:function(t){r.setMax(t),l()}}),e=Rr(t,"onResizeGroupStart",e);return n.isResize=!1!==e,!!n.isResize&&r},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r,i,o,a,s,u,l=dr(t.props,"resizable"),c=(Sr(t,"onBeforeResize",(function(n){Rr(t,"onBeforeResizeGroup",Tr(t,e,He(He({},n),{targets:l.targets}),!0))})),this.dragControl(t,He(He({},e),{isGroup:!0})));if(c)return s=c.boundingWidth,u=c.boundingHeight,r=c.dist,i=l.keepRatio,o=[s/(s-r[0]),u/(u-r[1])],a=n.fixedPosition,s=Yr(t,this,"dragControl",e,(function(e,n){var r=(s=Xt(ee(t.rotation/180*Math.PI,3),[n.datas.originalX*o[0],n.datas.originalY*o[1],1],3))[0],s=s[1];return He(He({},n),{parentDist:null,parentScale:o,dragClient:Yt(a,[r,s]),parentKeepRatio:i})})),u=He({targets:l.targets,events:s},c),Rr(t,"onResizeGroup",u),u}},dragGroupControlEnd:function(t,e){var n,r=e.isDrag;if(e.datas.isResize)return this.dragControlEnd(t,e),n=Yr(t,this,"dragControlEnd",e),Rr(t,"onResizeGroupEnd",Ir(t,e,{targets:t.props.targets,events:n})),r},request:function(t){var e={},n=0,r=0,i=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:e,parentDirection:t.direction||[1,1],parentIsWidth:null==(t=null==t?void 0:t.horizontal)||t}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?r=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(r+=t.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:t.keepRatio}},requestEnd:function(){return{datas:e,isDrag:!0}}}},unset:function(t){t.state.gestos.resizable=null}});function ji(t,e,n,r,i){var o=t.props.groupable,a=t.state,s=a.is3d?4:3,u=e.origin;t=rr(t.state.rootMatrix,jt([u[0],u[1]],o?[0,0]:[a.left,a.top]),s),u=Yt([i.left,i.top],t);e.startAbsoluteOrigin=u,e.prevDeg=V(u,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=j(u,[n,r])}function Wi(t,e,n){var r=n.defaultDeg,i=(o=n.prevDeg)%360,o=Math.floor(o/360);i<0&&(i+=360),t<i&&270<i&&t<90?++o:i<t&&i<90&&270<t&&--o,i=e*(360*o+t-r);return n.prevDeg=r+i,i}function Xi(t,e,n,r){return Wi(V(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function Hi(t,e,n,r,i,o){var a=void 0===(a=t.props.throttleRotate)?0:a,s=n.prevSnapDeg,u=0,l=!1;o&&(l=(o=function(t,e,n){if(!$r(t,"rotatable"))return{isSnap:!1,rotation:n};var r=e.pos1,i=e.pos2,o=e.pos3,a=e.pos4,s=e.origin,u=n*Math.PI/180;r=(e=[r,i,o,a].map((function(t){return jt(t,s)}))).map((function(t){return Kt(t,u)}));return(i=$e($e([],function(t,e,n,r,i){if(!t.props.bounds)return[];var o=i*Math.PI/180,a=(t=(i=hi(t)).left,i.top),s=i.right,u=(i=i.bottom,t-=r[0],s-=r[0],{left:t,top:a-=r[1],right:s,bottom:i-=r[1]});if(!vi(n,u,0))return[];var l=[];return[[t,0],[s,0],[a,1],[i,1]].forEach((function(t){var r=t[0],i=t[1];n.forEach((function(t){var n,a,s,c=V([0,0],t);l.push.apply(l,(a=r,s=i,t=ur(n=t),[t=Math.sqrt(t*t-a*a)||0,-t].sort((function(t,e){return Math.abs(t-n[s?0:1])-Math.abs(e-n[s?0:1])})).map((function(t){return V([0,0],s?[t,a]:[a,t])})).map((function(t){return o+t-c})).filter((function(t){return!vi(e,u,t)})).map((function(t){return W(180*t/Math.PI,dn)}))))}))})),l}(t,e,r,s,n),!0),function(t,e,n,r,i){t=t.props.innerBounds;var o=i*Math.PI/180;if(!t)return[];i=t.left;var a=t.top,s=t.width,u=(t=t.height,i-r[0]),l=(i=i+s-r[0],[[u,s=a-r[1]],[i,s],[u,a=a+t-r[1]],[i,a]]),c=xn(n,[0,0]);if(!di(n,l,c,0))return[];var f=[],d=l.map((function(t){return[ur(t),V([0,0],t)]}));return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach((function(t){var n,r,i,a=V([0,0],(i=(r=t)[0],n=(r=r[1])[0]-i[0],r=r[1]-i[1],n?r?[-(n=-(r/=n)*i[0]+i[1])/(r+1/r),n/(r*r+1)]:[0,i[1]]:[i[0],0])),s=(r=(n=t)[0],i=(n=n[1])[0]-r[0],n=n[1]-r[1],i?n?(n/=i,Math.abs((-n*r[0]+r[1])/Math.sqrt(Math.pow(n,2)+1))):Math.abs(r[1]):Math.abs(r[0]));f.push.apply(f,d.filter((function(t){return(t=t[0])&&s<=t})).map((function(t){var e=t[0];return t=t[1],e=Math.acos(e?s/e:0),[o+(t+e)-a,o+(t-e)-a]})).reduce((function(t,e){return t.push.apply(t,e),t}),[]).filter((function(t){return!di(e,l,c,t)})).map((function(t){return W(180*t/Math.PI,dn)})))})),f}(t,e,r,s,n),!0)).sort((function(t,e){return Math.abs(t-n)-Math.abs(e-n)})),{isSnap:o=0<i.length,rotation:o?i[0]:n}}(t,e,r)).isSnap,u=i+o.rotation),t=(u=l?u:W(i+r,a))-i;return[(n.prevSnapDeg=t)-s,t,u]}function $i(t,e){if(e.isRequest)return"rotatable"===e.requestAble;var n=e.inputEvent.target;return!!(H(n,Wn("rotation-control"))||H(n,Wn("around-control"))||H(n,Wn("control"))&&H(n,Wn("rotatable")))||!!(e=t.props.rotationTarget)&&Br(e,!0).some((function(t){return!!t&&(n===t||n.contains(t))}))}var Zi=vn.map((function(t){var e="",n="",r="center",i="center";return-1<t.indexOf("n")&&(e="top: -20px;",i="bottom"),-1<t.indexOf("s")&&(e="top: 0px;",i="top"),-1<t.indexOf("w")&&(n="left: -20px;",r="right"),-1<t.indexOf("e")&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,'"] {\n        ').concat(n).concat(e,"\n        transform-origin: ").concat(r," ").concat(i,";\n    }")})).join("\n"),Qi=".rotation {\n    position: absolute;\n    height: 40px;\n    width: 1px;\n    transform-origin: 50% 100%;\n    height: calc(40px * var(--zoom));\n    top: auto;\n    left: 0;\n    bottom: 100%;\n    will-change: transform;\n}\n.rotation .rotation-line {\n    display: block;\n    width: 100%;\n    height: 100%;\n    transform-origin: 50% 50%;\n}\n.rotation .rotation-control {\n    border-color: #4af;\n    border-color: var(--moveable-color);\n    background:#fff;\n    cursor: alias;\n}\n.rotatable.direction.control {\n    cursor: alias;\n}\n.around-control {\n    position: absolute;\n    will-change: transform;\n    width: 20px;\n    height: 20px;\n    left: -10px;\n    top: -10px;\n    box-sizing: border-box;\n    background: transparent;\n    z-index: 8;\n    cursor: alias;\n    transform-origin: center center;\n}\n.rotatable.direction.control.move {\n    cursor: move;\n}\n".concat(Zi,"\n");At={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number,renderDirections:Object,rotationTarget:Object,rotateAroundControls:Boolean,edge:Boolean,resolveAblesWithRotatable:Object},events:{onRotateStart:"rotateStart",onBeforeRotate:"beforeRotate",onRotate:"rotate",onRotateEnd:"rotateEnd",onRotateGroupStart:"rotateGroupStart",onBeforeRotateGroup:"beforeRotateGroup",onRotateGroup:"rotateGroup",onRotateGroupEnd:"rotateGroupEnd"},css:[Qi],render:function(t,e){var n=(l=dr(t.props,"rotatable")).rotatable,r=l.rotationPosition,i=l.zoom,o=l.renderDirections,a=l.rotateAroundControls,s=l.resolveAblesWithRotatable,u=(l=t.state).renderPoses,l=l.direction;if(!n)return null;var c,f,d,p,h,g,v;n=function(t,e,n){var r,i,o=e[0],a=e[1],s=e[2];e=e[3];if("none"!==t)return r=(t=(t||"top").split("-"))[0],t=t[1],i=[o,a],"left"===r?i=[s,o]:"right"===r?i=[a,e]:"bottom"===r&&(i=[e,s]),o=[(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2],a=hr(i,n),t&&(e="bottom"===r||"left"===r,o=i[(s="top"===t||"left"===t)&&!e||!s&&e?0:1]),[o,a]}(r,u,l),r=[];return n&&(u=n[0],l=n[1],r.push(e.createElement("div",{key:"rotation",className:Wn("rotation"),style:{transform:"translate(-50%) translate(".concat(u[0],"px, ").concat(u[1],"px) rotate(").concat(l,"rad)")}},e.createElement("div",{className:Wn("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),e.createElement("div",{className:Wn("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))),o&&(n=B(s||{}),c={},n.forEach((function(t){s[t].forEach((function(e){c[e]=t}))})),u=[],y(o)&&(u=o.map((function(t){var e=c[t];return{data:e?{resolve:e}:{},classNames:e?["move"]:[],dir:t}}))),r.push.apply(r,ki(t,"rotatable",u,e))),a&&r.push.apply(r,(f=e,(i=(l=t).renderState).renderDirectionMap||(i.renderDirectionMap={}),d=(n=l.state).renderPoses,p=n.rotation,n=n.direction,i=i.renderDirectionMap,h=l.props.zoom,g=0<n?1:-1,v=p/Math.PI*180,B(i).map((function(t){var e=En[t];if(!e)return null;var n=(W(v,15)+g*_n[t]+720)%180;return f.createElement("div",{className:Wn("around-control"),"data-rotation":n,"data-direction":t,key:"direction-around-".concat(t),style:fr.apply(void 0,$e([p,h],e.map((function(t){return d[t]})),!1))})})))),r},dragControlCondition:$i,dragControlStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,o=e.parentRotate,a=e.parentFlag,s=e.isPinch,u=e.isRequest,l=t.state,c=l.target,f=l.left,d=l.top,p=l.direction,h=l.beforeDirection,g=l.targetTransform,v=l.moveableClientRect,m=l.offsetMatrix,E=l.targetMatrix,_=l.allMatrix,b=l.width,y=l.height;if(!u&&!c)return!1;c=t.getRect(),n.rect=c,n.transform=g,n.left=f,n.top=d,g=function(e){n.fixedDirection=e,n.fixedPosition=Vn(t,e),M&&M.setFixedDirection(e)};var T,I,S,R,w,O=r,C=i,M=(d=(u||s||a?(n.beforeInfo={origin:c.beforeOrigin,prevDeg:f=o||0,defaultDeg:f,prevSnapDeg:0,startDist:0},n.afterInfo=He(He({},n.beforeInfo),{origin:c.origin}),n.absoluteInfo=He(He({},n.beforeInfo),{origin:c.origin,startValue:f})):((r=null==(d=e.inputEvent)?void 0:d.target)&&(i=r.getAttribute("data-direction")||"",(u=mn[i])&&(n.isControl=!0,n.isAroundControl=H(r,Wn("around-control")),n.controlDirection=u,(s=r.getAttribute("data-resolve"))&&(n.resolveAble=s),I=l.rootMatrix,a=l.renderPoses,o=v,S=16===I.length?4:3,a=a.map((function(t){return rr(I,t,S)})),R=o.left,w=o.top,O=(f=xn(a.map((function(t){return[t[0]+R,t[1]+w]})),u))[0],C=f[1])),n.beforeInfo={origin:c.beforeOrigin},n.afterInfo={origin:c.origin},n.absoluteInfo={origin:c.origin,startValue:c.rotation},T=g,g=function(e){var r=l.is3d?4:3,i=xn([[0,0],[b,0],[0,y],[b,y]],e),o=(a=Yt(zt(E,r),i))[0],a=a[1];o=Xt(m,Ft([o,a],r)),a=Xt(_,Ft([i[0],i[1]],r));T(e),n.beforeInfo.origin=o,n.afterInfo.origin=a,n.absoluteInfo.origin=a,ji(t,n.beforeInfo,O,C,v),ji(t,n.afterInfo,O,C,v),ji(t,n.absoluteInfo,O,C,v)}),n.startClientX=O,n.startClientY=C,n.direction=p,n.beforeDirection=h,n.startValue=0,n.datas={},Ln(e,"rotate"),!1),!1);(M=n.isControl&&n.resolveAble&&"resizable"===n.resolveAble?Yi.dragControlStart(t,He(He({},new Tn("resizable").dragStart([0,0],e)),{parentDirection:n.controlDirection,parentFixedDirection:n.fixedDirection})):M)||(d=Vi.dragStart(t,(new Tn).dragStart([0,0],e))),g((r=(i=(i=t).state).width,s=i.height,[(i=i.transformOrigin)[0]/(r/2)-1,i[1]/(s/2)-1])),o=Tr(t,e,He(He({set:function(t){n.startValue=t*Math.PI/180},setFixedDirection:g},Pn(e)),{dragStart:d,resizeStart:M})),a=Rr(t,"onRotateStart",o);return n.isRotate=!1!==a,l.snapRenderInfo={request:e.isRequest},!!n.isRotate&&o},dragControl:function(t,e){var n=e.datas,r=e.distX,i=e.distY,o=e.parentRotate,a=e.parentFlag,s=e.isPinch,u=e.groupDelta,l=n.beforeDirection,c=n.beforeInfo,f=n.afterInfo,d=n.absoluteInfo,p=n.isRotate,h=n.startValue,g=n.rect,v=n.startClientX,m=n.startClientY;if(p){Rn(e,"rotate");p=l*sr(e.datas.beforeTransform,[50,50],100,100).direction;var E,_,b,y=t.props.parentMoveable,T=180/Math.PI*h,I=(h=d.startValue,!1);v=v+r,r=m+i;if(!a&&"parentDist"in e?(m=e.parentDist,b=_=E=m):s||a?(E=Wi(o,l,c),_=Wi(o,p,f),b=Wi(o,p,d)):(E=Xi(v,r,l,c),_=Xi(v,r,p,f),b=Xi(v,r,p,d),I=!0),Rr(t,"onBeforeRotate",Tr(t,e,{beforeRotation:T+E,rotation:T+_,absoluteRotation:h+b,setRotation:function(t){b=E=_=t-T}},!0)),m=(i=Hi(t,g,c,E,T,I))[0],E=i[1],a=i[2],l=(o=Hi(t,g,f,_,T,I))[0],_=o[1],p=o[2],i=(c=Hi(t,g,d,b,h,I))[0],b=c[1],f=c[2],i||l||m||y)return o=wn(n,"rotate(".concat(p,"deg)"),"rotate(".concat(_,"deg)")),g=_,I=(h=n).fixedDirection,c=h.fixedPosition,u=jt(Yt(u||[0,0],y=qn(t,"rotate(".concat(g,"deg)"),I,c,h)),n.prevInverseDist||[0,0]),n.prevInverseDist=y,n.requestValue=null,I=g=Un(t,o,u,s,e),c=j([v,r],d.startAbsoluteOrigin)-d.startDist,h=void 0,"resizable"===n.resolveAble&&(y=Yi.dragControl(t,He(He({},yn(e,t.state,[e.deltaX,e.deltaY],!!s,!1,"resizable")),{resolveMatrix:!0,parentDistance:c})))&&(I=yr(I,h=y,e)),Rr(t,"onRotate",o=Tr(t,e,He(He({delta:l,dist:_,rotate:p,rotation:p,beforeDist:E,beforeDelta:m,beforeRotate:a,beforeRotation:a,absoluteDist:b,absoluteDelta:i,absoluteRotate:f,absoluteRotation:f,isPinch:!!s,resize:h},g),I))),o}},dragControlAfter:function(t,e){e.datas.requestValue},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate)return n.isRotate=!1,Rr(t,"onRotateEnd",n=Ir(t,e,{})),n},dragGroupControlCondition:$i,dragGroupControlStart:function(t,e){var n,r=e.datas,i=(n=t.state).left,o=n.top,a=n.beforeOrigin;return!!(n=this.dragControlStart(t,e))&&(n.set(r.beforeDirection*t.rotation),e=Yr(t,this,"dragControlStart",e,(function(t,e){var n=(t=t.state).left,r=t.top;t=t.beforeOrigin,n=Yt(jt([n,r],[i,o]),jt(t,a));return e.datas.startGroupClient=n,e.datas.groupClient=n,He(He({},e),{parentRotate:0})})),t=Rr(t,"onRotateGroupStart",He(He({},n),{targets:t.props.targets,events:e})),r.isRotate=!1!==t,!!r.isRotate&&n)},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){Sr(t,"onBeforeRotate",(function(n){Rr(t,"onBeforeRotateGroup",Tr(t,e,He(He({},n),{targets:t.props.targets}),!0))}));var r,i,o,a=this.dragControl(t,e);if(a)return r=n.beforeDirection,i=a.beforeDist,o=i/180*Math.PI,n=Yr(t,this,"dragControl",e,(function(t,e){var n=e.datas.startGroupClient,a=(s=e.datas.groupClient)[0],s=s[1],u=(n=Kt(n,o*r))[0];a=[u-a,(n=n[1])-s];return e.datas.groupClient=[u,n],He(He({},e),{parentRotate:i,groupDelta:a})})),t.rotation=r*a.beforeRotation,n=He({targets:t.props.targets,events:n,set:function(e){t.rotation=e},setGroupRotation:function(e){t.rotation=e}},a),Rr(t,"onRotateGroup",n),n}},dragGroupControlEnd:function(t,e){var n,r=e.isDrag;if(e.datas.isRotate)return this.dragControlEnd(t,e),n=Yr(t,this,"dragControlEnd",e),Rr(t,"onRotateGroupEnd",Ir(t,e,{targets:t.props.targets,events:n})),r},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaRotate"in t?n+=t.deltaRotate:"rotate"in t&&(n=t.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}},Nt=Gr("scalable"),d={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean,edge:Boolean},events:{onScaleStart:"scaleStart",onBeforeScale:"beforeScale",onScale:"scale",onScaleEnd:"scaleEnd",onScaleGroupStart:"scaleGroupStart",onBeforeScaleGroup:"beforeScaleGroup",onScaleGroup:"scaleGroup",onScaleGroupEnd:"scaleGroupEnd"},render:Ui("scalable"),dragControlCondition:Nt,dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,o=(i=e.parentDirection||(r?[0,0]:vr(i.target)),(f=t.state).width),a=f.height,s=f.targetTransform,u=f.target,l=f.pos1,c=f.pos2,f=f.pos4;if(!i||!u)return!1;function d(t){n.ratio=t&&isFinite(t)?t:0}function p(t){n.fixedDirection=t,n.fixedPosition=xn(n.startPositions,t)}return r||Sn(t,e),n.datas={},n.transform=s,n.prevDist=[1,1],n.direction=i,n.startOffsetWidth=o,n.startOffsetHeight=a,n.startValue=[1,1],u=j(l,c),r=j(c,f),s=!i[0]&&!i[1]||i[0]||!i[1],n.scaleWidth=u,n.scaleHeight=r,n.scaleXRatio=u/o,n.scaleYRatio=r/a,Ln(e,"scale"),n.isWidth=s,n.startPositions=Er(t.state),n.setFixedDirection=p,d(j(l,c)/j(c,f)),p([-i[0],-i[1]]),o=Rr(t,"onScaleStart",u=Tr(t,e,He(He({direction:i,set:function(t){n.startValue=t},setRatio:d,setFixedDirection:p},Pn(e)),{dragStart:Vi.dragStart(t,(new Tn).dragStart([0,0],e))}))),n.startFixedDirection=n.fixedDirection,!1!==o&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:i}),!!n.isScale&&u},dragControl:function(t,e){Rn(e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,o=e.isPinch,a=e.dragClient,s=e.isRequest,u=n.prevDist,l=n.direction,c=n.startOffsetWidth,f=n.startOffsetHeight,d=n.isScale,p=n.startValue,h=n.isWidth,g=n.ratio;if(!d)return!1;var v=(d=t.props).throttleScale,m=d.parentMoveable,E=l,_=(l[0]||l[1]||(E=[1,1]),g&&(null!=r?r:d.keepRatio)||!1);r=t.state;function b(){var t=(r=Ur(E,_,n,e)).distWidth,r=r.distHeight;t=(c+t)/c,r=(f+r)/f,t=E[0]||_?t*p[0]:p[0],r=E[1]||_?r*p[1]:p[1];return[t=0===t?1e-9*(0<u[0]?1:-1):t,r=0===r?1e-9*(0<u[1]?1:-1):r]}var T=b(),I=(d=(o||!t.props.groupable||y(d=(r.snapRenderInfo||{}).direction)&&(d[0]||d[1])&&(r.snapRenderInfo={direction:l,request:e.isRequest}),Rr(t,"onBeforeScale",Tr(t,e,{scale:T,setFixedDirection:function(t){return n.setFixedDirection(t),T=b()},startFixedDirection:n.startFixedDirection,setScale:function(t){T=t}},!0)),[T[0]/p[0],T[1]/p[1]]),r=a,[0,0]);a||(r=!i&&o?jn(t,[0,0]):n.fixedPosition),o||(I=function(t,e,n,r,i){if(!$r(t,"scalable"))return[0,0];var o=i.startOffsetWidth,a=i.startOffsetHeight,s=i.fixedPosition,u=i.fixedDirection,l=i.is3d;return t=Pi(t,(function(t,n){return xi((r=i,t=Yt(e,[t/o,n/a]),n=r.transformOrigin,c=r.offsetMatrix,f=r.is3d?4:3,An(c,Vt(r.targetMatrix,re(t,f),f),n,f)),o,a,u,s,l);var r,c,f}),o,a,n,s,r,i),[t[0]/o,t[1]/a]}(t,d,l,s,n)),_?(E[0]&&E[1]&&I[0]&&I[1]&&(Math.abs(I[0]*c)>Math.abs(I[1]*f)?I[1]=0:I[0]=0),(a=!I[0]&&!I[1])&&(h?d[0]=W(d[0]*p[0],v)/p[0]:d[1]=W(d[1]*p[1],v)/p[1]),E[0]&&!E[1]||I[0]&&!I[1]||a&&h?(d[0]+=I[0],i=c*d[0]*p[0]/g,d[1]=i/f/p[1]):(!E[0]&&E[1]||!I[0]&&I[1]||a&&!h)&&(d[1]+=I[1],s=f*d[1]*p[1]*g,d[0]=s/c/p[0])):(d[0]+=I[0],d[1]+=I[1],I[0]||(d[0]=W(d[0]*p[0],v)/p[0]),I[1]||(d[1]=W(d[1]*p[1],v)/p[1])),0===d[0]&&(d[0]=1e-9*(0<u[0]?1:-1)),0===d[1]&&(d[1]=1e-9*(0<u[1]?1:-1)),i=[d[0]/u[0],d[1]/u[1]],I=jt(s=(T=[d[0]*p[0],d[1]*p[1]],a=n.fixedDirection,h=r,g=n,qn(t,"scale(".concat(d.join(", "),")"),a,h,g)),n.prevInverseDist||[0,0]);return n.prevDist=d,n.prevInverseDist=s,!(T[0]===u[0]&&T[1]===u[1]&&I.every((function(t){return!t}))&&!m)&&(v=wn(n,"scale(".concat(T.join(", "),")"),"scale(".concat(d.join(", "),")")),Rr(t,"onScale",r=Tr(t,e,He({offsetWidth:c,offsetHeight:f,direction:l,scale:T,dist:d,delta:i,isPinch:!!o},Un(t,v,I,o,e)))),r)},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isScale&&(n.isScale=!1,Rr(t,"onScaleEnd",Ir(t,e,{})),r)},dragGroupControlCondition:Nt,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=qr(t,"resizable",e);function o(e,r){var i=n.fixedDirection,o=n.fixedPosition;e=xn(r.datas.startPositions||Er(e.state),i),e=(i=Xt(ee(-t.rotation/180*Math.PI,3),[e[0]-o[0],e[1]-o[1],1],3))[0],o=i[1];return r.datas.originalX=e,r.datas.originalY=o,r}function a(t){r.setFixedDirection(t),s.forEach((function(e,n){e.setFixedDirection(t),o(e.moveable,i[n])}))}n.moveableScale=t.scale;var s=Yr(t,this,"dragControlStart",e,o),u=(e=(n.setFixedDirection=a,He(He({},r),{targets:t.props.targets,events:s,setFixedDirection:a})),Rr(t,"onScaleGroupStart",e));return n.isScale=!1!==u,!!n.isScale&&e},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){Sr(t,"onBeforeScale",(function(n){Rr(t,"onBeforeScaleGroup",Tr(t,e,He(He({},n),{targets:t.props.targets}),!0))}));var r,i,o,a,s,u=this.dragControl(t,e);if(u)return s=n.moveableScale,t.scale=[u.scale[0]*s[0],u.scale[1]*s[1]],r=t.props.keepRatio,i=u.dist,o=u.scale,a=n.fixedPosition,s=Yr(t,this,"dragControl",e,(function(e,n){var s=(u=Xt(ee(t.rotation/180*Math.PI,3),[n.datas.originalX*i[0],n.datas.originalY*i[1],1],3))[0],u=u[1];return He(He({},n),{parentDist:null,parentScale:o,parentKeepRatio:r,dragClient:Yt(a,[s,u])})})),n=He({targets:t.props.targets,events:s},u),Rr(t,"onScaleGroup",n),n}},dragGroupControlEnd:function(t,e){var n,r=e.isDrag;if(e.datas.isScale)return this.dragControlEnd(t,e),n=Yr(t,this,"dragControlEnd",e),Rr(t,"onScaleGroupEnd",Ir(t,e,{targets:t.props.targets,events:n})),r},request:function(){var t={},e=0,n=0;return{isControl:!0,requestStart:function(e){return{datas:t,parentDirection:e.direction||[1,1]}},request:function(r){return e+=r.deltaWidth,n+=r.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:r.keepRatio}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function Ki(t,e){return t.map((function(t,n){return E(t,e[n],1,2)}))}function Ji(t,e,n){return e=V(t,e),0<=(t=V(t,n)-e)?t:t+2*Math.PI}Zi={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array,edge:Boolean},events:{onWarpStart:"warpStart",onWarp:"warp",onWarpEnd:"warpEnd"},render:function(t,e){var n=(o=t.props).resizable,r=o.scalable,i=o.warpable,o=o.zoom;if(n||r||!i)return[];r=(n=t.state).pos1,i=n.pos2;var a=n.pos3,s=(n=n.pos4,Ki(r,i)),u=Ki(i,r),l=Ki(r,a),c=(r=Ki(a,r),Ki(a,n)),f=(a=Ki(n,a),Ki(i,n));n=Ki(n,i);return $e([e.createElement("div",{className:Wn("line"),key:"middeLine1",style:cr(s,c,o)}),e.createElement("div",{className:Wn("line"),key:"middeLine2",style:cr(u,a,o)}),e.createElement("div",{className:Wn("line"),key:"middeLine3",style:cr(l,f,o)}),e.createElement("div",{className:Wn("line"),key:"middeLine4",style:cr(r,n,o)})],qi(t,"warpable",e),!0)},dragControlCondition:function(t,e){return!e.isRequest&&(H(e=e.inputEvent.target,Wn("direction"))&&H(e,Wn("warpable")))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target;if(!(r=vr(r.target))||!i)return!1;var o=(i=t.state).transformOrigin,a=i.is3d,s=i.targetTransform,u=i.targetMatrix,l=i.width,c=i.height,f=i.left,d=i.top;return n.datas={},n.targetTransform=s,n.warpTargetMatrix=a?u:Ut(u,3,4),n.targetInverseMatrix=kt(Bt(n.warpTargetMatrix,4),3,4),n.direction=r,n.left=f,n.top=d,n.poses=[[0,0],[l,0],[0,c],[l,c]].map((function(t){return jt(t,o)})),n.nextPoses=n.poses.map((function(t){var e=t[0];t=t[1];return Xt(n.warpTargetMatrix,[e,t,0,1],4)})),n.startValue=ne(4),n.prevMatrix=ne(4),n.absolutePoses=Er(i),n.posIndexes=Dn(r),Sn(t,e),Ln(e,"matrix3d"),!(i.snapRenderInfo={request:e.isRequest,direction:r})!==Rr(t,"onWarpStart",Tr(t,e,He({set:function(t){n.startValue=t}},Pn(e))))&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,o=e.distY,a=n.targetInverseMatrix,s=n.prevMatrix,u=n.isWarp,l=n.startValue,c=n.poses,f=n.posIndexes,d=n.absolutePoses;if(!u)return!1;Rn(e,"matrix3d"),$r(t,"warpable")&&(1<(u=f.map((function(t){return d[t]}))).length&&u.push([(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2]),u=(r=Si(t,r,{horizontal:u.map((function(t){return t[1]+o})),vertical:u.map((function(t){return t[0]+i}))})).horizontal,r=r.vertical,o-=u.offset,i-=r.offset);var p=Mn({datas:n,distX:i,distY:o},!0),h=n.nextPoses.slice();return f.forEach((function(t){h[t]=Yt(h[t],p)})),!!fn.every((function(t){return e=t.map((function(t){return c[t]})),t=t.map((function(t){return h[t]})),e=Ji(e[0],e[1],e[2]),t=Ji(t[0],t[1],t[2]),!((n=Math.PI)<=e&&t<=n||e<=n&&n<=t);var e,n}))&&(!!(u=oe(c[0],c[2],c[1],c[3],h[0],h[2],h[1],h[3])).length&&(r=On(n,Vt(a,u,4),!0),f=Vt(Bt(s,4),r,4),a=Vt(l,n.prevMatrix=r,4),Gn(e,u=wn(n,"matrix3d(".concat(a.join(", "),")"),"matrix3d(".concat(r.join(", "),")"))),Rr(t,"onWarp",Tr(t,e,{delta:f,matrix:a,dist:r,multiply:Vt,transform:u})),!0))},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return!!n.isWarp&&(n.isWarp=!1,Rr(t,"onWarpEnd",Ir(t,e,{})),r)}};var to=Wn("area-pieces"),eo=Wn("area-piece"),no=Wn("avoid");function ro(t){var e,n,r,i=t.areaElement;i&&(e=(t=t.state).width,t=t.height,r=no,(n=i).classList?n.classList.remove(r):(r=new RegExp("(\\s|^)"+r+"(\\s|$)"),n.className=n.className.replace(r," ")),i.style.cssText+="left: 0px; top: 0px; width: ".concat(e,"px; height: ").concat(t,"px"))}function io(t){return t.createElement("div",{key:"area_pieces",className:to},t.createElement("div",{className:eo}),t.createElement("div",{className:eo}),t.createElement("div",{className:eo}),t.createElement("div",{className:eo}))}var oo={name:"dragArea",props:{dragArea:Boolean,passDragArea:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},render:function(t,e){var n=(a=t.props).target,i=a.dragArea,o=a.groupable,a=a.passDragArea,s=(l=t.state).width,u=l.height,l=l.renderPoses;a=a?Wn("area","pass"):Wn("area");return o?[e.createElement("div",{key:"area",ref:r(t,"areaElement"),className:a}),io(e)]:n&&i?(n=(o=oe([0,0],[s,0],[0,u],[s,u],l[0],l[1],l[2],l[3])).length?er(o,!0):"none",[e.createElement("div",{key:"area",ref:r(t,"areaElement"),className:a,style:{top:"0px",left:"0px",width:"".concat(s,"px"),height:"".concat(u,"px"),transformOrigin:"0 0",transform:n}}),io(e)]):[]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY;if(!e.inputEvent)return!1;n.isDragArea=!1;e=t.areaElement,t=(n=t.state).moveableClientRect;var o=n.renderPoses,a=n.rootMatrix,s=n.is3d,u=t.left,l=(t=t.top,(o=or(o)).left),c=o.top,f=o.width,d=(o=o.height,r=(a=xr(a,[r-u,i-t],s?4:3))[0],u=a[1],i=[{left:l,top:c,width:f,height:(u-=c)-10},{left:l,top:c,width:(r-=l)-10,height:o},{left:l,top:c+u+10,width:f,height:o-u-10},{left:l+r+10,top:c,width:f-r-10,height:o}],[].slice.call(e.nextElementSibling.children));i.forEach((function(t,e){d[e].style.cssText="left: ".concat(t.left,"px;top: ").concat(t.top,"px; width: ").concat(t.width,"px; height: ").concat(t.height,"px;")})),t=no,(s=e).classList?s.classList.add(t):s.className+=" "+t,n.disableNativeEvent=!0},drag:function(t,e){var n=e.datas;e=e.inputEvent;if(this.enableNativeEvent(t),!e)return!1;n.isDragArea||(n.isDragArea=!0,ro(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent;e=e.datas;if(!n)return!1;e.isDragArea||ro(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){ro(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&G((function(){e.disableNativeEvent=!1}))}};Qi=Ze("origin",{render:function(t,e){var n=t.props.zoom,r=(t=t.state).beforeOrigin;t=t.rotation;return[e.createElement("div",{className:Wn("control","origin"),style:fr(t,n,r),key:"beforeOrigin"})]}});function ao(t){return[(t=t.scrollContainer).scrollLeft,t.scrollTop]}Nt={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number,getScrollPosition:Function},events:{onScroll:"scroll",onScrollGroup:"scrollGroup"},dragRelation:"strong",dragStart:function(t,e){var n=void 0===(n=t.props.scrollContainer)?t.getContainer():n,r=new Ce,i=(n=kr(n,!0),e.datas.dragScroll=r,e.isControl?"controlGesto":"targetGesto"),o=e.targets;r.on("scroll",(function(n){var r=n.container;n=n.direction,r=Tr(t,e,{scrollContainer:r,direction:n}),n=o?"onScrollGroup":"onScroll";o&&(r.targets=o),Rr(t,n,r)})).on("move",(function(n){var r=n.offsetX;n=n.offsetY;t[i].scrollBy(r,n,e.inputEvent,!1)})),r.dragStart(e,{container:n})},checkScroll:function(t,e){var n,r,i,o=e.datas.dragScroll;if(o)return t=void 0===(n=(r=t.props).scrollContainer)?t.getContainer():n,n=r.scrollThreshold,r=r.getScrollPosition,i=void 0===r?ao:r,o.drag(e,{container:t,threshold:void 0===n?0:n,getScrollPosition:function(t){return i({scrollContainer:t.container,direction:t.direction})}}),!0},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,He(He({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,He(He({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,He(He({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,He(He({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,He(He({},e),{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,e){return this.drag(t,He(He({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,He(He({},e),{targets:t.props.targets}))}};var so={name:"",props:{target:Object,dragTarget:Object,container:Object,portalContainer:Object,rootContainer:Object,useResizeObserver:Boolean,zoom:Number,transformOrigin:Array,edge:Object,ables:Array,className:String,pinchThreshold:Number,pinchOutside:Boolean,triggerAblesSimultaneously:Boolean,checkInput:Boolean,cspNonce:String,translateZ:Number,hideDefaultLines:Boolean,props:Object,flushSync:Function,stopPropagation:Boolean,preventClickEventOnDrag:Boolean,preventClickDefault:Boolean},events:{}},uo=Ze("padding",{render:function(t,e){if((o=t.props).dragArea)return[];var n=(o=o.padding||{}).left,r=void 0===(r=o.top)?0:r,i=void 0===(i=o.right)?0:i,o=void 0===(o=o.bottom)?0:o,a=(t=t.state).renderPoses,s=[t.pos1,t.pos2,t.pos3,t.pos4];t=[];return 0<(void 0===n?0:n)&&t.push([0,2]),0<r&&t.push([0,1]),0<i&&t.push([1,3]),0<o&&t.push([2,3]),t.map((function(t,n){var r=t[0];t=t[1];if((r=oe([0,0],[100,0],[0,100],[100,100],s[r],s[t],a[r],a[t])).length)return e.createElement("div",{key:"padding".concat(n),className:Wn("padding"),style:{transform:er(r,!0)}})}))}}),lo=["nw","ne","se","sw"];function co(t,e){var n=e<(n=t[0]+t[1])?e/n:1;return t[0]*=n,t[1]=e-t[1]*n,t}var fo=[1,2,5,6],po=[0,3,4,7],ho=[1,-1,-1,1],go=[1,1,-1,-1];function vo(t,e,n,r,i,o,a,s,u){void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=r),void 0===u&&(u=i);var l=[],c=!1;t=t.map((function(t,f){var d,p=(f=e[f]).horizontal;return(f=f.vertical)&&!c&&(c=!0,l.push("/")),c?(d=Math.max(0,1===f?t[1]-a:u-t[1]),l.push(Lr(d,i,n))):(d=Math.max(0,1===p?t[0]-o:s-t[0]),l.push(Lr(d,r,n))),d}));return{styles:l,raws:t}}function mo(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var o=t[i];o.sub&&(o.horizontal&&(0===e[1]&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),o.vertical&&(0===n[1]&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function Eo(t,e,n,r,i,o){void 0===o&&(o=[0,0]);var a=(-1<(a=t.indexOf("/"))?t.slice(0,a):t).length,s=t.slice(0,a),u=(t=t.slice(a+1),a=void 0===(a=s[0])?"0px":a,void 0===(u=s[1])?a:u),l=void 0===(l=s[2])?a:l,c=void 0===(c=s[3])?u:c,f=void 0===(f=t[0])?a:f,d=void 0===(d=t[1])?f:d,p=void 0===(p=t[2])?f:p,h=void 0===(h=t[3])?d:h,g=[a,u,l,c].map((function(t){return z(t,e)})),v=[f,d,p,h].map((function(t){return z(t,n)}));a=g.slice(),u=v.slice(),l=co([a[0],a[1]],e),a[0]=l[0],a[1]=l[1],c=co([a[3],a[2]],e),a[3]=c[0],a[2]=c[1],f=co([u[0],u[3]],n),u[0]=f[0],u[3]=f[1],d=co([u[1],u[2]],n),u[1]=d[0],u[2]=d[1],p=a.slice(0,Math.max(o[0],s.length)),h=u.slice(0,Math.max(o[1],t.length));return $e($e([],p.map((function(t,e){var o=lo[e];return{horizontal:ho[e],vertical:0,pos:[r+t,i+(-1===go[e]?n:0)],sub:!0,raw:g[e],direction:o}})),!0),h.map((function(t,n){var o=lo[n];return{horizontal:0,vertical:go[n],pos:[r+(-1===ho[n]?e:0),i+t],sub:!0,raw:v[n],direction:o}})),!0)}function _o(t,e,n,r,i){void 0===i&&(i=e.length);var o=(a=mo(t.slice(r))).horizontalRange,a=a.verticalRange,s=0;if(0==(r=n-r))s=i;else if(0<r&&r<o[1])s=o[1]-r;else{if(!(r>=a[0]))return;s=a[0]+a[1]-r}t.splice(n,s),e.splice(n,s)}function bo(t,e,n,r,i,o,a,s,u,l,c){void 0===l&&(l=0),void 0===c&&(c=0);var f=(d=mo(t.slice(n))).horizontalRange,d=d.verticalRange;if(-1<r)for(var p=1===ho[r]?o-l:s-o,h=f[1];h<=r;++h){var g=1===go[h]?c:u,v=0;if(r===h?v=o:0===h?v=l+p:-1===ho[h]&&(v=s-(e[n][0]-l)),t.splice(n+h,0,{horizontal:ho[h],vertical:0,pos:[v,g]}),e.splice(n+h,0,[v,g]),0===h)break}else if(-1<i){var m=1===go[i]?a-c:u-a,E=(0===f[1]&&0===d[1]&&(t.push({horizontal:ho[0],vertical:0,pos:f=[l+m,c]}),e.push(f)),d[0]);for(h=d[1];h<=i&&(v=1===ho[h]?l:s,g=0,i===h?g=a:0===h?g=c+m:1===go[h]?g=e[n+E][1]:-1===go[h]&&(g=u-(e[n+E][1]-c)),t.push({horizontal:0,vertical:go[h],pos:[v,g]}),e.push([v,g]),0!==h);++h);}}function yo(t,e){return void 0===e&&(e=t.map((function(t){return t.raw}))),{horizontals:t.map((function(t,n){return t.horizontal?e[n]:null})).filter((function(t){return null!=t})),verticals:t.map((function(t,n){return t.vertical?e[n]:null})).filter((function(t){return null!=t}))}}var To=[[0,-1,"n"],[1,0,"e"]],Io=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function So(t,e,n){var r=t.props.clipRelative,i=(t=t.state).width,o=t.height,a=(t=e.type,e=e.poses,"rect"===t),s="circle"===t;if("polygon"===t)return n.map((function(t){return"".concat(Lr(t[0],i,r)," ").concat(Lr(t[1],o,r))}));if(a||"inset"===t){var u=n[1][1],l=n[3][0],c=n[7][0],f=n[5][1];if(a)return[u,l,f,c].map((function(t){return"".concat(t,"px")}));var d,p=[u,i-l,o-f,c].map((function(t,e){return Lr(t,e%2?i:o,r)}));return 8<n.length&&(d=(a=jt(n[4],n[0]))[0],a=a[1],p.push.apply(p,$e(["round"],vo(n.slice(8),e.slice(8),r,d,a,c,u,l,f).styles,!1))),p}return s||"ellipse"===t?(e=n[0],d=Lr(Math.abs(n[1][1]-e[1]),s?Math.sqrt((i*i+o*o)/2):o,r),(p=s?[d]:[Lr(Math.abs(n[2][0]-e[0]),i,r),d]).push("at",Lr(e[0],i,r),Lr(e[1],o,r)),p):void 0}function Ro(t,e,n,r){var i=[r,(r+e)/2,e],o=[t,(t+n)/2,n];return Io.map((function(t){var e=t[0],n=t[1],r=(t=t[2],i[e+1]),a=o[n+1];return{vertical:Math.abs(n),horizontal:Math.abs(e),direction:t,pos:[r,a]}}))}function wo(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach((function(t){t=t.pos,e[0]=Math.min(e[0],t[0]),e[1]=Math.max(e[1],t[0]),n[0]=Math.min(n[0],t[1]),n[1]=Math.max(n[1],t[1])})),[Math.abs(e[1]-e[0]),Math.abs(n[1]-n[0])]}function Oo(t,e,n,r,i){var o,a,s,u,l,c,f,d,p,h,g,v,m,E,_,b;if((i=i||("none"!==(o=(t=wr(t)).clipPath)?o:t.clip))&&"none"!==i&&"auto"!==i||(i=r))return r=void 0===(t=(o=D(i)).prefix)?i:t,o=void 0===(t=o.value)?"":t,t="circle"===r,a=" ","polygon"===r?(a=",",{type:r,clipText:i,poses:b=(h=M(o||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map((function(t){var r=(t=t.split(" "))[0];t=t[1];return{vertical:1,horizontal:1,pos:[z(r,e),z(t,n)]}})),splitter:a}):t||"ellipse"===r?(f=p="",s=0,h=C(o),u=t?(d=h[0],p=void 0===(c=h[2])?"50%":c,f=void 0===(c=h[3])?"50%":c,s=z(void 0===d?"50%":d,Math.sqrt((e*e+n*n)/2))):(c="",d=h[0],c=void 0===(g=h[1])?"50%":g,p=void 0===(g=h[3])?"50%":g,f=void 0===(g=h[4])?"50%":g,s=z(void 0===d?"50%":d,e),z(c,n)),b=$e([{vertical:1,horizontal:1,pos:l=[z(p,e),z(f,n)],direction:"nesw"}],To.slice(0,t?1:2).map((function(t){return{vertical:Math.abs(t[1]),horizontal:t[0],direction:t[2],sub:!0,pos:[l[0]+t[0]*s,l[1]+t[1]*u]}})),!0),{type:r,clipText:i,radiusX:s,radiusY:u,left:l[0]-s,top:l[1]-u,poses:b,splitter:a}):"inset"===r?(d=(-1<(g=(h=C(o||"0 0 0 0")).indexOf("round"))?h.slice(0,g):h).length,c=h.slice(d+1),f=(p=h.slice(0,d))[0],g=void 0===(t=p[1])?f:t,d=p[2],p=void 0===(t=p[3])?g:t,v=(t=[f,void 0===d?f:d].map((function(t){return z(t,n)})))[0],E=t[1],_=(f=[p,g].map((function(t){return z(t,e)})))[0],m=f[1],p=Eo(c,(d=e-m)-_,(t=n-E)-v,_,v),{type:"inset",clipText:i,poses:b=$e($e([],Ro(v,d,t,_),!0),p,!0),top:v,left:_,right:d,bottom:t,radius:c,splitter:a}):"rect"===r?(a=",",{type:"rect",clipText:i,poses:b=Ro(v=(g=(h=M(o||"0px, ".concat(e,"px, ").concat(n,"px, 0px"))).map((function(t){return x(t).value})))[0],m=g[1],E=g[2],_=g[3]),top:v,right:m,bottom:E,left:_,values:h,splitter:a}):void 0}var Co={name:"clippable",props:{clippable:Boolean,defaultClipPath:String,customClipPath:String,keepRatio:Boolean,clipRelative:Boolean,clipArea:Boolean,dragWithClip:Boolean,clipTargetBounds:Boolean,clipVerticalGuidelines:Array,clipHorizontalGuidelines:Array,clipSnapThreshold:Boolean},events:{onClipStart:"clipStart",onClip:"clip",onClipEnd:"clipEnd"},css:[".control.clip-control {\n    background: #6d6;\n    cursor: pointer;\n}\n.control.clip-control.clip-radius {\n    background: #d66;\n}\n.line.clip-line {\n    background: #6e6;\n    cursor: move;\n    z-index: 1;\n}\n.clip-area {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n.clip-ellipse {\n    position: absolute;\n    cursor: move;\n    border: 1px solid #6d6;\n    border: var(--zoompx) solid #6d6;\n    border-radius: 50%;\n    transform-origin: 0px 0px;\n}",":host {\n    --bounds-color: #d66;\n}",".guideline {\n    pointer-events: none;\n    z-index: 2;\n}",".line.guideline.bounds {\n    background: #d66;\n    background: var(--bounds-color);\n}"],render:function(t,e){var n=(C=t.props).customClipPath,r=C.defaultClipPath,i=C.clipArea,o=C.zoom,a=(t=(C=t.state).target,C.width),s=C.height,u=C.allMatrix,l=C.is3d,c=C.left,f=C.top,d=C.pos1,p=C.pos2,h=C.pos3,g=C.pos4,v=C.clipPathState,m=C.snapBoundInfos,E=C.rotation;if(!t)return[];if(!(C=Oo(t,a,s,r||"inset",v||n)))return[];var _,b,y,T=l?4:3,I=(t=C.type,r=C.poses.map((function(t){return[(t=rr(u,t.pos,T))[0]-c,t[1]-f]})),v=[],[]),S=(l="inset"===t,"polygon"===t);if(((n="rect"===t)||l||S)&&(_=l?r.slice(0,8):r,I=_.map((function(t,n){var r=0===n?_[_.length-1]:_[n-1],i=V(r,t);t=lr(r,t);return e.createElement("div",{key:"clipLine".concat(n),className:Wn("line","clip-line","snap-control"),"data-clip-index":n,style:{width:"".concat(t,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(i,"rad) scaleY(").concat(o,")")}})}))),v=r.map((function(t,n){return e.createElement("div",{key:"clipControl".concat(n),className:Wn("control","clip-control","snap-control"),"data-clip-index":n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(E,"rad) scale(").concat(o,")")}})})),l&&v.push.apply(v,r.slice(8).map((function(t,n){return e.createElement("div",{key:"clipRadiusControl".concat(n),className:Wn("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+n,style:{transform:"translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(E,"rad) scale(").concat(o,")")}})}))),"circle"===t||"ellipse"===t){t=C.left;var R=C.top,w=C.radiusX,O=C.radiusY,C=(t=(C=jt(rr(u,[t,R],T),rr(u,[0,0],T)))[0],R=C[1],"none");if(!i){for(var M=Math.max(10,w/5,O/5),D=[],x=0;x<=M;++x){var A=2*Math.PI/M*x;D.push([w+(w-o)*Math.cos(A),O+(O-o)*Math.sin(A)])}D.push([w,-2]),D.push([-2,-2]),D.push([-2,2*O+2]),D.push([2*w+2,2*O+2]),D.push([2*w+2,-2]),D.push([w,-2]),C="polygon(".concat(D.map((function(t){return"".concat(t[0],"px ").concat(t[1],"px")})).join(", "),")")}v.push(e.createElement("div",{key:"clipEllipse",className:Wn("clip-ellipse","snap-control"),style:{width:"".concat(2*w,"px"),height:"".concat(2*O,"px"),clipPath:C,transform:"translate(".concat(-c+t,"px, ").concat(-f+R,"px) ").concat(er(u))}}))}return i&&(t=(C=or($e([d,p,h,g],r,!0))).width,R=C.height,b=C.left,y=C.top,(S||n||l)&&(D=l?r.slice(0,8):r,v.push(e.createElement("div",{key:"clipArea",className:Wn("clip-area","snap-control"),style:{width:"".concat(t,"px"),height:"".concat(R,"px"),transform:"translate(".concat(b,"px, ").concat(y,"px)"),clipPath:"polygon(".concat(D.map((function(t){return"".concat(t[0]-b,"px ").concat(t[1]-y,"px")})).join(", "),")")}})))),m&&["vertical","horizontal"].forEach((function(t){var n=m[t],r="horizontal"===t;n.isSnap&&I.push.apply(I,n.snap.posInfos.map((function(n,i){n=n.pos;var l=jt(rr(u,r?[0,n]:[n,0],T),[c,f]);n=jt(rr(u,r?[a,n]:[n,s],T),[c,f]);return zi(e,"",l,n,o,"clip".concat(t,"snap").concat(i),"guideline")}))),n.isBound&&I.push.apply(I,n.bounds.map((function(n,i){n=n.pos;var l=jt(rr(u,r?[0,n]:[n,0],T),[c,f]);n=jt(rr(u,r?[a,n]:[n,s],T),[c,f]);return zi(e,"",l,n,o,"clip".concat(t,"bounds").concat(i),"guideline","bounds","bold")})))})),$e($e([],v,!0),I,!0)},dragControlCondition:function(t,e){return e.inputEvent&&-1<(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")},dragStart:function(t,e){var n=t.props.dragWithClip;return void 0!==n&&!n&&this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,He(He({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=(i=t.props).defaultClipPath,i=i.customClipPath,o=n.target,a=n.width,s=n.height,u=e.inputEvent?e.inputEvent.target:null,l=u&&u.getAttribute("class")||"",c=e.datas;return!!(o=Oo(o,a,s,r||"inset",i))&&(a=o.clipText,!1===Rr(t,"onClipStart",Tr(t,e,{clipType:o.type,clipStyle:a,poses:o.poses.map((function(t){return t.pos}))}))?c.isClipStart=!1:(c.isControl=l&&-1<l.indexOf("clip-control"),c.isLine=-1<l.indexOf("clip-line"),c.isArea=-1<l.indexOf("clip-area")||-1<l.indexOf("clip-ellipse"),c.clipIndex=u?parseInt(u.getAttribute("data-clip-index"),10):-1,c.clipPath=o,c.isClipStart=!0,n.clipPathState=a,Sn(t,e),!0))},dragControl:function(t,e){var n=e.datas,r=e.originalDatas,i=e.isDragTarget;if(!n.isClipStart)return!1;var o=n.isControl,a=n.isLine,s=n.isArea,u=n.clipIndex;if(!(n=n.clipPath))return!1;var l,c,f,d,p,h,g,v,m,E,_,b,y,T,I,S=dr(t.props,"clippable"),R=S.keepRatio,w=0,O=0,C=(r=r.draggable,Mn(e)),M=(O=i&&r?(M=r.prevBeforeDist,w=M[0],M[1]):(w=C[0],C[1]),[w,O]),D=t.state,x=D.width,A=D.height,P=(s=!s&&!o&&!a,a=n.type,n.poses),L=n.splitter,N=P.map((function(t){return t.pos})),G=(s=(s&&(w=-w,O=-O),!o||"nesw"===P[u].direction),"inset"===a||"rect"===a),k=P.map((function(){return[0,0]})),B=(o&&!s?(g=(U=P[u]).horizontal,U=U.vertical,g=[w*Math.abs(g),O*Math.abs(U)],c=g,U=G,g=R,Y=(j=(l=P)[X=u]).direction,j=j.sub,h=l.map((function(){return[0,0]})),W=Y?Y.split(""):[],U&&X<8?(U=W.filter((function(t){return"w"===t||"e"===t})),q=W.filter((function(t){return"n"===t||"s"===t})),f=U[0],d=q[0],h[X]=c,q=(U=wo(l))[0],U=U[1],(B=q&&U?q/U:0)&&g?(g=l[(X+4)%8].pos,F=[0,0],-1<Y.indexOf("w")?F[0]=-1:-1<Y.indexOf("e")&&(F[0]=1),-1<Y.indexOf("n")?F[1]=-1:-1<Y.indexOf("s")&&(F[1]=1),B=q+(q=Fr([q,U],c,B,F,!0))[0],U+=q[1],q=g[1],v=g[1],V=g[0],g=g[0],-1===F[0]?V=g-B:1===F[0]?g=V+B:(V-=B/2,g+=B/2),-1===F[1]?q=v-U:v=1===F[1]?q+U:(q=v-U/2)+U,p=Ro(q,g,v,V),l.forEach((function(t,e){h[e][0]=p[e].pos[0]-t.pos[0],h[e][1]=p[e].pos[1]-t.pos[1]}))):(l.forEach((function(t,e){(t=t.direction)&&(-1<t.indexOf(f)&&(h[e][0]=c[0]),-1<t.indexOf(d)&&(h[e][1]=c[1]))})),f&&(h[1][0]=c[0]/2,h[5][0]=c[0]/2),d&&(h[3][1]=c[1]/2,h[7][1]=c[1]/2))):Y&&!j?W.forEach((function(t){var e="n"===t||"s"===t;l.forEach((function(n,r){var i=n.direction,o=n.horizontal;n=n.vertical;i&&-1!==i.indexOf(t)&&(h[r]=[e||!o?0:c[0],e&&n?c[1]:0])}))})):h[X]=c,k=h):s&&(k=N.map((function(){return[w,O]}))),N.map((function(t,e){return Yt(t,k[e])}))),F=$e([],B,!0),U=(D.snapBoundInfos=null,"circle"===n.type),q="ellipse"===n.type,V=((U||q)&&(E=or(B),g=Math.abs(E.bottom-E.top),v=Math.abs(q?E.right-E.left:g),_=B[0][1]+g,b=B[0][0]-v,y=B[0][0]+v,U&&(F.push([y,E.bottom]),k.push([1,0])),F.push([E.left,_]),k.push([0,1]),F.push([b,E.bottom]),k.push([1,0])),Mi((S.clipHorizontalGuidelines||[]).map((function(t){return z("".concat(t),A)})),(S.clipVerticalGuidelines||[]).map((function(t){return z("".concat(t),x)})),x,A)),Y=[],j=[],W=(j=U||q?(Y=[F[4][0],F[2][0]],[F[1][1],F[3][1]]):G?(I=[F[0],F[2],F[4],F[6]],m=[k[0],k[2],k[4],k[6]],Y=I.filter((function(t,e){return m[e][0]})).map((function(t){return t[0]})),I.filter((function(t,e){return m[e][1]})).map((function(t){return t[1]}))):(Y=F.filter((function(t,e){return k[e][0]})).map((function(t){return t[0]})),F.filter((function(t,e){return k[e][1]})).map((function(t){return t[1]}))),[0,0]),X=Ri(V,S.clipTargetBounds&&{left:0,top:0,right:x,bottom:A},Y,j,5),H=(s=X.horizontal,N=X.vertical,s.offset),$=N.offset,Z=(s=(s.isBound&&(W[1]+=H),N.isBound&&(W[0]+=$),(q||U)&&0===k[0][0]&&0===k[0][1]?(Z=(E=or(B)).bottom-E.top,E=q?E.right-E.left:Z,E-=N.isBound?Math.abs($):0===N.snapIndex?-$:$,Z-=s.isBound?Math.abs(H):0===s.snapIndex?-H:H,U&&(E=Z=0<ri(N,s)?Z:E),N=F[0],F[1][1]=N[1]-Z,F[2][0]=N[0]+E,F[3][1]=N[1]+Z,F[4][0]=N[0]-E):G&&R&&o?(Z=(s=wo(P))[0],N=s[1],E=Z&&N?Z/N:0,R=P[u].direction||"",o=F[1][1],_=F[5][1],b=F[7][0],y=F[3][0],H<=$?H=$/E:$=H*E,-1<R.indexOf("w")?b-=$:-1<R.indexOf("e")?y-=$:(b+=$/2,y-=$/2),-1<R.indexOf("n")?o-=H:-1<R.indexOf("s")?_-=H:(o+=H/2,_-=H/2),T=Ro(o,y,_,b),F.forEach((function(t,e){e=T[e].pos,t[0]=e[0],t[1]=e[1]}))):F.forEach((function(t,e){(e=k[e])[0]&&(t[0]-=$),e[1]&&(t[1]-=H)})),So(t,n,B)),"".concat(a,"(").concat(s.join(L),")"));return D.clipPathState=Z,j=U||q?(Y=[F[4][0],F[2][0]],[F[1][1],F[3][1]]):G?(Y=(I=[F[0],F[2],F[4],F[6]]).map((function(t){return t[0]})),I.map((function(t){return t[1]}))):(Y=F.map((function(t){return t[0]})),F.map((function(t){return t[1]}))),D.snapBoundInfos=Ri(V,S.clipTargetBounds&&{left:0,top:0,right:x,bottom:A},Y,j,1),r&&(N=D.is3d,P=D.allMatrix,u=W,i&&(u=[M[0]+W[0]-C[0],M[1]+W[1]-C[1]]),r.deltaOffset=Vt(P,[u[0],u[1],0,0],N?4:3)),Rr(t,"onClip",Tr(t,e,{clipEventType:"changed",clipType:a,poses:B,clipStyle:Z,clipStyles:s,distX:w,distY:O})),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,o=r.isLine,a=r.isClipStart;r=r.isControl;return!!a&&(Rr(t,"onClipEnd",Ir(t,e,{})),i&&(r?function(t,e){var n=(r=e.datas).clipPath,r=r.clipIndex,i=n.type,o=n.poses,a=n.splitter,s=o.map((function(t){return t.pos})),u=s.length;if("polygon"===i)o.splice(r,1),s.splice(r,1);else{if("inset"!==i)return;if(r<8)return;if(_o(o,s,r,8,u),u===o.length)return}Rr(t,"onClip",Tr(t,e,{clipEventType:"removed",clipType:i,poses:s,clipStyles:r=So(t,n,s),clipStyle:"".concat(i,"(").concat(r.join(a),")"),distX:0,distY:0}))}(t,e):o&&function(t,e){var n=(r=In(t,e))[0],r=r[1],i=(o=e.datas).clipPath,o=o.clipIndex,a=i.type,s=i.poses,u=i.splitter,l=s.map((function(t){return t.pos}));if("polygon"===a)l.splice(o,0,[n,r]);else{if("inset"!==a)return;var c=fo.indexOf(o),f=(o=po.indexOf(o),s.length);if(bo(s,l,8,c,o,n,r,l[4][0],l[4][1],l[0][0],l[0][1]),f===s.length)return}Rr(t,"onClip",Tr(t,e,{clipEventType:"added",clipType:a,poses:l,clipStyles:c=So(t,i,l),clipStyle:"".concat(a,"(").concat(c.join(u),")"),distX:0,distY:0}))}(t,e)),i||n)},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Mo={name:"originDraggable",props:{originDraggable:Boolean,originRelative:Boolean},events:{onDragOriginStart:"dragOriginStart",onDragOrigin:"dragOrigin",onDragOriginEnd:"dragOriginEnd"},css:[":host[data-able-origindraggable] .control.origin {\n    pointer-events: auto;\n}"],dragControlCondition:function(t,e){return e.isRequest?"originDraggable"===e.requestAble:H(e.inputEvent.target,Wn("origin"))},dragControlStart:function(t,e){var n=e.datas,r=Rr(t,"onDragOriginStart",e=(Sn(t,e),Tr(t,e,{dragStart:Vi.dragStart(t,(new Tn).dragStart([0,0],e))})));return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],!(n.isDragOrigin=!0)===r?n.isDragOrigin=!1:e},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var o=(a=Mn(e))[0],a=a[1],s=(f=t.state).width,u=f.height,l=f.offsetMatrix,c=f.targetMatrix,f=f.is3d,d=void 0===(d=t.props.originRelative)||d,p=(f=f?4:3,o=[o,a],i=(!i||((a=e.distOrigin)[0]||a[1])&&(o=a),Yt(n.startOrigin,o)),a=Yt(n.startTargetOrigin,o),jt(o,n.prevOrigin));l=An(l,c,i,f),c=t.getRect(),l=or(ir(l,s,u,f)),f=[c.left-l.left,c.top-l.top];return Rr(t,"onDragOrigin",c=Tr(t,e,{width:s,height:u,origin:i,dist:n.prevOrigin=o,delta:p,transformOrigin:[Lr(a[0],s,d),Lr(a[1],u,d)].join(" "),drag:Vi.drag(t,yn(e,t.state,f,!!r,!1))})),c},dragControlEnd:function(t,e){return!!e.datas.isDragOrigin&&(Rr(t,"onDragOriginEnd",Ir(t,e,{})),!0)},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){return!!this.dragControlStart(t,e)},dragGroupControl:function(t,e){return!!(e=this.dragControl(t,e))&&(t.transformOrigin=e.transformOrigin,!0)},request:function(t){var e={},n=t.getRect(),r=0,i=0,o=n.transformOrigin,a=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(t){return"deltaOrigin"in t?(a[0]+=t.deltaOrigin[0],a[1]+=t.deltaOrigin[1]):"origin"in t?(a[0]=t.origin[0]-o[0],a[1]=t.origin[1]-o[1]):("x"in t?r=t.x-n.left:"deltaX"in t&&(r+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY)),{datas:e,distX:r,distY:i,distOrigin:a}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Do(t,e,n,r,i){return void 0===r&&(r=[0,0]),Eo(!(t=i||(t=wr(t))&&t.borderRadius||"")||!i&&"0px"===t?[]:C(t),e,n,0,0,r)}function xo(t,e,n,r,i,o){var a=t.state,s=a.width,u=a.height,l=(o=vo(o,i,t.props.roundRelative,s,u)).raws;o=o.styles,l=(i=yo(i,l)).horizontals,i=i.verticals,o=o.join(" ");Rr(t,"onRound",Tr(t,e,{horizontals:l,verticals:i,borderRadius:a.borderRadiusState=o,width:s,height:u,delta:r,dist:n}))}var Ao={name:"roundable",props:{roundable:Boolean,roundRelative:Boolean,minRoundControls:Array,maxRoundControls:Array,roundClickable:Boolean},events:{onRoundStart:"roundStart",onRound:"round",onRoundEnd:"roundEnd"},css:[".control.border-radius {\n    background: #d66;\n    cursor: pointer;\n}",":host[data-able-roundable] .line.direction {\n    cursor: pointer;\n}"],render:function(t,e){var n=(l=t.state).target,r=l.width,i=l.height,o=l.allMatrix,a=l.is3d,s=l.left,u=l.top,l=l.borderRadiusState,c=(t=t.props).minRoundControls,f=void 0===(p=t.maxRoundControls)?[4,4]:p,d=t.zoom;if(!n)return null;var p,h=a?4:3;if(!(p=Do(n,r,i,void 0===c?[0,0]:c,l)))return null;var g=0,v=0;return p.map((function(t,n){v+=Math.abs(t.horizontal),g+=Math.abs(t.vertical);var r=jt(rr(o,t.pos,h),[s,u]);t=t.vertical?g<=f[1]:v<=f[0];return e.createElement("div",{key:"borderRadiusControl".concat(n),className:Wn("control","border-radius"),"data-radius-index":n,style:{display:t?"block":"none",transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) scale(").concat(d,")")}})}))},dragControlCondition:function(t,e){return!(!e.inputEvent||e.isRequest)&&(-1<(e=e.inputEvent.target.getAttribute("class")||"").indexOf("border-radius")||-1<e.indexOf("moveable-line")&&-1<e.indexOf("moveable-direction"))},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=-1<(o=(n=n.target).getAttribute("class")||"").indexOf("border-radius"),o=-1<o.indexOf("moveable-line")&&-1<o.indexOf("moveable-direction"),a=i?parseInt(n.getAttribute("data-radius-index"),10):-1;n=o?parseInt(n.getAttribute("data-line-index"),10):-1;return!(!i&&!o)&&(!1!==Rr(t,"onRoundStart",Tr(t,e,{}))&&(r.lineIndex=n,r.controlIndex=a,r.isControl=i,r.isLine=o,Sn(t,e),a=(n=t.props).roundRelative,o=void 0===(i=n.minRoundControls)?[0,0]:i,n=(e=t.state).target,i=e.width,t=e.height,r.isRound=!0,r.prevDist=[0,0],n=Do(n,i,t,o)||[],r.controlPoses=n,e.borderRadiusState=vo(n.map((function(t){return t.pos})),n,a,i,t).styles.join(" "),!0))},dragControl:function(t,e){var n=e.datas;if(!n.isRound||!n.isControl||!n.controlPoses.length)return!1;var r,i=n.controlIndex,o=n.controlPoses,a=(r=Mn(e))[0],s=[a,r=r[1]],u=jt(s,n.prevDist),l=void 0===(g=t.props.maxRoundControls)?[4,4]:g,c=(g=t.state).width,f=g.height,d=(g=o[i]).vertical,p=g.horizontal,h=o.map((function(t){var e=t.horizontal,n=(t=t.vertical,[e*p*s[0],t*d*s[1]]);if(e){if(1===l[0])return n;if(l[0]<4&&e!==p)return n}else{if(0===l[1])return n[1]=t*p*s[0]/c*f,n;if(d){if(1===l[1])return n;if(l[1]<4&&t!==d)return n}}return[0,0]})),g=(h[i]=s,o.map((function(t,e){return Yt(t.pos,h[e])})));return n.prevDist=[a,r],xo(t,e,s,u,o,g),!0},dragControlEnd:function(t,e){var n=t.state,r=(n.borderRadiusState="",e.datas),i=e.isDouble;if(!r.isRound)return!1;var o,a,s,u=n.width,l=n.height,c=r.isControl,f=r.controlIndex,d=r.isLine,p=r.lineIndex,h=(r=r.controlPoses).map((function(t){return t.pos})),g=h.length,v=t.props.roundClickable;return i&&(void 0===v||v)&&(c?_o(r,h,f,0):d&&(v=(i=In(t,e))[0],c=i[1],f=h,d=p,i=v,p=c,v=u,c=l,o=(l=yo(u=r)).horizontals,l=l.verticals,o=o.length,l=l.length,s=a=-1,0===d?0===o?a=0:1===o&&(a=1):3===d&&(o<=2?a=2:o<=3&&(a=3)),2===d?0===l?s=0:l<4&&(s=3):1===d&&(l<=1?s=1:l<=2&&(s=2)),bo(u,f,0,a,s,i,p,v,c)),g!==r.length&&xo(t,e,[0,0],[0,0],r,h)),Rr(t,"onRoundEnd",Ir(t,e,{})),!(n.borderRadiusState="")},unset:function(t){t.state.borderRadiusState=""}},Po={isPinch:!0,name:"beforeRenderable",props:{},events:{onBeforeRenderStart:"beforeRenderStart",onBeforeRender:"beforeRender",onBeforeRenderEnd:"beforeRenderEnd",onBeforeRenderGroupStart:"beforeRenderGroupStart",onBeforeRenderGroup:"beforeRenderGroup",onBeforeRenderGroupEnd:"beforeRenderGroupEnd"},dragRelation:"weak",setTransform:function(t,e){var n=(t=t.state).is3d,r=t.target;t=t.targetMatrix,r=null==r?void 0:r.style.transform,t=n?"matrix3d(".concat(t.join(","),")"):"matrix(".concat(Wt(t,!0),")"),r=r&&"none"!==r?r:t;e.datas.startTransforms=(t=r,n=ne((e=n)?4:3),t==="matrix".concat(e?"3d":"","(").concat(n.join(","),")")||"matrix(1,0,0,1,0,0)"===t?[]:C(r))},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return Tr(t,e,{setTransform:function(t){e.datas.startTransforms=y(t)?t:C(t)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return Tr(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),Rr(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){this.resetStyle(e),e.datas.nextStyle={},Rr(t,"onBeforeRender",Tr(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){Rr(t,"onBeforeRenderEnd",Tr(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this,r=(this.dragStart(t,e),qr(t,"beforeRenderable",e)),i=t.moveables;r=r.map((function(t,e){return e=i[e],n.setTransform(e,t),n.fillDragStartParams(e,t)}));Rr(t,"onBeforeRenderGroupStart",Tr(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:r}))},dragGroup:function(t,e){var n=this,r=(this.drag(t,e),qr(t,"beforeRenderable",e)),i=t.moveables;r=r.map((function(t,r){return r=i[r],n.resetStyle(t),e.datas.nextStyle={},n.fillDragParams(r,t)}));Rr(t,"onBeforeRenderGroup",Tr(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:r}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),Rr(t,"onBeforeRenderGroupEnd",Tr(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},Lo={name:"renderable",props:{},events:{onRenderStart:"renderStart",onRender:"render",onRenderEnd:"renderEnd",onRenderGroupStart:"renderGroupStart",onRenderGroup:"renderGroup",onRenderGroupEnd:"renderGroupEnd"},dragRelation:"weak",dragStart:function(t,e){Rr(t,"onRenderStart",Tr(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){Rr(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){if(e.resultCount)return this.drag(t,e)},dragEnd:function(t,e){Rr(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){Rr(t,"onRenderGroupStart",Tr(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=qr(t,"beforeRenderable",e),i=t.moveables;r=r.map((function(t,e){return e=i[e],n.fillDragParams(e,t)}));Rr(t,"onRenderGroup",Tr(t,e,He(He({isPinch:!!e.isPinch,targets:t.props.targets,transform:zn(e)},br(Fn(e))),{events:r})))},dragGroupEnd:function(t,e){var n=this,r=qr(t,"beforeRenderable",e),i=t.moveables;r=r.map((function(t,e){return e=i[e],n.fillDragEndParams(e,t)}));Rr(t,"onRenderGroupEnd",Tr(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:r}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){return Tr(t,e,He({isPinch:!!e.isPinch,transform:zn(e)},br(Fn(e))))},fillDragEndParams:function(t,e){return Tr(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag})}};function No(t,e,n,r,i,o,a){var s="Start"===i,u=t.state.target,l=o.isRequest;if(!u||s&&-1<r.indexOf("Control")&&!l&&t.areaElement===o.inputEvent.target)return!1;var c,f="".concat(n).concat(r).concat(i),d="".concat(n).concat(r,"Condition"),p="End"===i,h=(u="After"===i,!(!s||t.targetGesto&&t.controlGesto&&t.targetGesto.isFlag()&&t.controlGesto.isFlag())),g=(h&&t.updateRect(i,!0,!1),""!==i||l||Ar(t.state,o),$e([],t[e],!0));if(l&&(c=o.requestAble,g.some((function(t){return t.name===c}))||g.push.apply(g,t.props.ables.filter((function(t){return t.name===c})))),!g.length||g.every((function(t){return t.dragRelation})))return!1;function v(){var t;y=!0,null!=(t=o.stop)&&t.call(o)}g=$e($e([Po],g,!0),[Lo],!1).filter((function(t){return t[f]}));var m,E=o.datas,_=(h&&g.forEach((function(e){e.unset&&e.unset(t)})),o.inputEvent),b=(p&&_&&(m=document.elementFromPoint(o.clientX,o.clientY)||_.target),0),y=!1,T=(_=g.filter((function(e){var n=e.name;n=E[n]||(E[n]={});return s&&(n.isEventStart=!e[d]||e[d](t,o)),!!n.isEventStart&&(e=e[f](t,He(He({},o),{stop:v,resultCount:b,datas:n,originalDatas:E,inputTarget:m})),t._emitter.off(),s&&!1===e&&(n.isEventStart=!1),b+=e?1:0,e)})).length,!1);return s&&(y||g.length&&!_)&&(T=y||g.filter((function(t){var e=t.name;return!!E[e].isEventStart&&"strong"!==t.dragRelation})).length),(p||T)&&(t.state.gestos={},t.moveables&&t.moveables.forEach((function(t){t.state.gestos={}}))),h&&T&&g.forEach((function(e){e.unset&&e.unset(t)})),s&&!T&&!l&&_&&null!=o&&o.preventDefault(),!t.isUnmounted&&!T&&((!s&&_&&!a||p)&&(t.props.flushSync||Xn)((function(){t.updateRect(p?i:"",!0,!1),t.forceUpdate()})),s||p||u||!_||a||No(t,e,n,r,i+"After",o),!0)}function Go(t,e,n){function r(e){e=e.inputEvent.target;var n=t.areaElement;return a&&(e===a||a.contains(e))||e===n||!t.isMoveableElement(e)&&!t.controlBox.getElement().contains(e)||H(e,"moveable-area")||H(e,"moveable-padding")}var i=t.controlBox.getElement(),o=[],a=t.props.dragTarget;return o.push(i),t.props.dragArea&&!a||o.push(e),ko(t,o,"targetAbles",n,{dragStart:r,pinchStart:r})}function ko(t,e,n,r,i){void 0===i&&(i={});var o="targetAbles"===n,a=(c=t.props).pinchOutside,s=c.pinchThreshold,u=c.preventClickEventOnDrag,l=c.preventClickDefault,c=c.checkInput,f=(s={preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:s,pinchOutside:a,preventClickEventOnDrag:o&&u,preventClickEventOnDragStart:o&&l,preventClickEventByCondition:o?null:function(e){return t.controlBox.getElement().contains(e.target)},checkInput:o&&c},new ze(e,s)),d="Control"===r;return["drag","pinch"].forEach((function(e){["Start","","End"].forEach((function(o){f.on("".concat(e).concat(o),(function(a){var s=a.eventType;i[s]&&!i[s](a)||!No(t,n,e,r,o,a)?a.stop():(t.props.stopPropagation||"Start"===o&&d)&&null!=(s=null==a?void 0:a.inputEvent)&&s.stopPropagation()}))}))})),f}var Bo=function(){function t(t,e,n){var r=this;this.target=t,this.moveable=e,this.eventName=n,this.ables=[],this._onEvent=function(t){var e=r.eventName,n=r.moveable;n.state.disableNativeEvent||r.ables.forEach((function(r){r[e](n,{inputEvent:t})}))},t.addEventListener(n.toLowerCase(),this._onEvent)}var e=t.prototype;return e.setAbles=function(t){this.ables=t},e.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function zo(t,e,n){for(var r,i,o,a,s=t,u=[],l=!n&&t===e||t===document.body,c=l,f=!1,d=3,p=!1,h=Qn(e,e,!0).offsetParent;s&&!c;){c=l;var g,v=getComputedStyle(s),m=v.position,E=(g=(g=Zn(s,v))&&"none"!==g?b(g)?g:ae(g):[1,0,0,1,0,0],(E=(E=void 0)===E?6===g.length:E)?[g[0],g[1],0,g[2],g[3],0,g[4],g[5],1]:g),_={hasTransform:!1,fixedContainer:null},y=((g="fixed"===m)&&(p=!0,h=(_=function(t){for(var e=t.parentElement,n=!1;e;){var r=wr(e).transform;if(r&&"none"!==r){n=!0;break}if(e===document.body)break;e=e.parentElement}return{fixedContainer:e||document.body,hasTransform:n}}(s)).fixedContainer),E.length),T=(y=(f||16!==y||(f=!0,d=4,tr(u),o=o&&Ut(o,3,4)),f&&9===y&&(E=Ut(E,3,4)),Kn(s,t,v))).tagName,I=y.hasOffset,S=y.isSVG,R=y.origin,w=y.targetOrigin,O=(y=y.offset)[0],C=(y=y[1],void("svg"===T&&o&&(u.push({type:"target",target:s,matrix:(T=d,G=N=a=U=C=k=z=D=F=x=B=void 0,x=(z=nr(M=s)).width,F=z.height,D=z.clientWidth,z=z.clientHeight,k=D/x,C=z/F,U=(M=M.preserveAspectRatio.baseVal).align,M=M.meetOrSlice,a=[0,0],N=[k,C],G=[0,0],1!==U&&(B=(U-2)%3,U=Math.floor((U-2)/3),a[0]=x*B/2,a[1]=F*U/2,M=2===M?Math.max(C,k):Math.min(k,C),N[0]=M,N[1]=M,G[0]=(D-x)/2*B,G[1]=(z-F)/2*U),(k=re(N,T))[T*(T-1)]=G[0],k[T*(T-1)+1]=G[1],Hn(k,T,a))}),u.push({type:"offset",target:s,matrix:ne(d)})))),M=!1,D=!1;if(g)C=_.fixedContainer,M=!0;else{var x=Qn(s,e);C=x.offsetParent,M=x.isEnd,D=x.isStatic;if(sn&&x.parentSlotElement){for(var A=C,P=0,L=0;A&&function(t){if(t&&t.getRootNode&&11===(t=t.getRootNode()).nodeType)return t}(A);)P+=A.offsetLeft,L+=A.offsetTop,A=A.offsetParent;O-=P,y-=L}}!on||un||!I||S||!D||"relative"!==m&&"static"!==m||(O-=C.offsetLeft,y-=C.offsetTop,l=l||M);var N,G,k,B=0,z=0,F=0,U=0;if(g?I&&_.hasTransform&&(F=C.clientLeft,U=C.clientTop):(I&&h!==C&&(B=C.clientLeft,z=C.clientTop),I&&C===document.body&&(O+=(N=Jn(s,!1,v))[0],y+=N[1])),u.push({type:"target",target:s,matrix:Hn(E,d,R)}),I?(k=(G=s===t)?0:s.scrollLeft,T=G?0:s.scrollTop,u.push({type:"offset",target:s,matrix:ie([O-k+B-F,y-T+z-U],d)})):u.push({type:"offset",target:s,origin:R}),o=o||E,r=r||R,i=i||w,c||g)break;s=C,l=M,n&&s!==document.body||(c=l)}return{offsetContainer:h,matrixes:u,targetMatrix:o=o||ne(d),transformOrigin:r=r||[0,0],targetOrigin:i=i||[0,0],is3d:f,hasFixed:p}}function Fo(t,e,n,r){void 0===n&&(n=e);var i=0,o=0,a=0,s={},u=pr(t);t&&(i=u.offsetWidth,o=u.offsetHeight),t&&(e=sr((t=function(t,e,n,r){void 0===n&&(n=e);var i=(e=zo(t,e)).matrixes,o=e.is3d,a=e.targetMatrix,s=e.transformOrigin,u=e.targetOrigin,l=e.offsetContainer,c=(e=e.hasFixed,(d=zo(l,n,!0)).matrixes),f=d.is3d,d=d.offsetContainer,p=(r=r||f||o)?4:3,h=(t="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,ne(p)),g=ne(p),v=ne(p),m=ne(p),E=i.length,_=(c.reverse(),i.reverse(),!o&&r&&(a=Ut(a,3,4),tr(i)),!f&&r&&tr(c),c.forEach((function(t){g=Vt(g,t.matrix,p)})),f=n||document.body,(null==(n=c[0])?void 0:n.target)||Qn(f,f,!0).offsetParent),b=c.slice(1).reduce((function(t,e){return Vt(t,e.matrix,p)}),ne(p));return i.forEach((function(t,e){E-2===e&&(v=h.slice()),E-1===e&&(m=h.slice()),t.matrix||(e=function(t,e,n,r,i){var o=t.target,a=(t=t.origin,e.matrix),s=(e=pr(o)).offsetWidth,u=e.offsetHeight,l=(e=n.getBoundingClientRect(),[0,0]);n===document.body&&(l=Jn(o,!0));for(var c=(o=o.getBoundingClientRect()).left-e.left+n.scrollLeft-(n.clientLeft||0)+l[0],f=o.top-e.top+n.scrollTop-(n.clientTop||0)+l[1],d=(e=o.width,n=o.height,(o=ar(l=qt(r,i,a),s,u,r)).left),p=o.top,h=o.width,g=(o=o.height,rr(l,t,r)),v=[c+(l=jt(g,[d,p]))[0]*e/h,f+l[1]*n/o],m=[0,0],E=0;++E<10;){var _=jt(rr(_=Bt(i,r),v,r),rr(_,g,r));m[0]=_[0],m[1]=_[1];var b=(_=ar(qt(r,i,ie(m,r),a),s,u,r)).left-c;if(_=_.top-f,Math.abs(b)<2&&Math.abs(_)<2)break;v[0]-=b,v[1]-=_}return m.map((function(t){return Math.round(t)}))}(t,i[e+1],_,p,Vt(b,h,p)),t.matrix=ie(e,p)),h=Vt(h,t.matrix,p)})),n=!t&&o,a=a||ne(n?4:3),f=er(t&&16===a.length?Ut(a,4,3):a,n),{hasFixed:e,rootMatrix:g=kt(g,p,p),beforeMatrix:v,offsetMatrix:m,allMatrix:h,targetMatrix:a,targetTransform:f,transformOrigin:s,targetOrigin:u,is3d:r,offsetContainer:l,offsetRootContainer:d}}(t,e,n,r)).allMatrix,t.transformOrigin,i,o),s=He(He({},t),e),a=hr([(n=sr(t.allMatrix,[50,50],100,100)).pos1,n.pos2],n.direction)),e=r?4:3;return He(He(He({width:i,height:o,rotation:a},u),{rootMatrix:ne(e),beforeMatrix:ne(e),offsetMatrix:ne(e),allMatrix:ne(e),targetMatrix:ne(e),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),s)}function Uo(t,e,n,r,i){var o=1,a=[0,0],s={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},u={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},l={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},c={left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0};n=Fo(e,n,i,!0);return e&&(i=n.is3d?4:3,o=(i=sr(n.offsetMatrix,Yt(n.transformOrigin,zt(n.targetMatrix,i)),n.width,n.height)).direction,a=Yt(i.origin,[i.left-n.left,i.top-n.top]),s=gr(e),l=gr(Qn(r,r,!0).offsetParent||n.offsetRootContainer,!0),c=gr(n.offsetRootContainer),t&&(u=gr(t))),He({targetClientRect:s,containerClientRect:l,moveableClientRect:u,rootContainerClientRect:c,beforeDirection:o,beforeOrigin:a,originalBeforeOrigin:a,target:e},n)}var qo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=He({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1},Uo(null)),e.renderState={},e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e._emitter=new Ie,e._prevTarget=null,e._prevDragArea=!1,e._isPropTargetChanged=!1,e._observer=null,e._observerId=0,e.checkUpdateRect=function(){var t;e.isDragging()||((t=e.props.parentMoveable)?t.checkUpdateRect():(k(e._observerId),e._observerId=G((function(){e.isDragging()||e.updateRect()}))))},e._onPreventClick=function(t){t.stopPropagation(),t.preventDefault()},e}Xe(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=this.state,n=t.parentPosition,i=t.className,o=t.target,a=t.zoom,s=t.cspNonce,u=t.translateZ,l=t.cssStyled,c=t.portalContainer,f=(n=(this.checkUpdate(),this.updateRenderPoses(),n||[0,0]))[0],d=(n=n[1],e.left),p=e.top,h=e.target,g=e.direction,v=(e=e.hasFixed,t=((t=t.targets)&&t.length||o)&&h,o=this.isDragging(),{});return this.getEnabledAbles().forEach((function(t){v["data-able-".concat(t.name.toLowerCase())]=!0})),ut(l,He({cspNonce:s,ref:r(this,"controlBox"),className:"".concat(Wn("control-box",-1===g?"reverse":"",o?"dragging":"")," ").concat(i)},v,{onClick:this._onPreventClick,portalContainer:c,style:{position:e?"fixed":"absolute",display:t?"block":"none",transform:"translate3d(".concat(d-f,"px, ").concat(p-n,"px, ").concat(u,")"),"--zoom":a,"--zoompx":"".concat(a,"px")}}),this.renderAbles(),this._renderLines())},n.componentDidMount=function(){this.isUnmounted=!1,this.controlBox.getElement();var t=(n=this.props).parentMoveable,e=n.container,n=n.wrapperMoveable;this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),e||t||n||this.updateRect("",!1,!0),this.updateCheckInput(),this._updateObserver(this.props)},n.componentDidUpdate=function(t){this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(t)},n.componentWillUnmount=function(){this.isUnmounted=!0,this._emitter.off(),_r(this,"targetGesto"),_r(this,"controlGesto");var t,e=this.events;for(t in e){var n=e[t];n&&n.destroy()}},n.getAble=function(t){return N(this.props.ables||[],(function(e){return e.name===t}))},n.getContainer=function(){var t=this.props,e=t.parentMoveable,n=t.wrapperMoveable;return t.container||n&&n.getContainer()||e&&e.getContainer()||this.controlBox.getElement().parentElement},n.isMoveableElement=function(t){var e;return t&&-1<((null==(e=t.getAttribute)?void 0:e.call(t,"class"))||"").indexOf(ln)},n.dragStart=function(t){var e=this.targetGesto;return e&&!e.isFlag()&&e.triggerDragStart(t),this},n.hitTest=function(t){var e=(a=this.state).target,n=a.pos1,r=a.pos2,i=a.pos3,o=a.pos4,a=a.targetClientRect;if(!e)return 0;t=(e=t instanceof Element?{left:(e=t.getBoundingClientRect()).left,top:e.top,width:e.width,height:e.height}:He({width:0,height:0},t)).left;var s=e.top,u=e.width;e=e.height,r=he(function(t,e){var n,r,i,o,a,s,u;return n=t.slice(),r=e.slice(),-1===Y(n)&&n.reverse(),-1===Y(r)&&r.reverse(),i=ye(n),o=ye(r),t=i.map((function(t){return Ee(t[0],t[1])})),a=o.map((function(t){return Ee(t[0],t[1])})),s=[],t.forEach((function(t,e){var n=i[e],u=[];a.forEach((function(r,i){r=be(_e(t,r),[n,o[i]]),u.push.apply(u,r.map((function(t){return{index1:e,index2:i,pos:t,type:"intersection"}})))})),u.sort((function(t,e){return j(n[0],t.pos)-j(n[0],e.pos)})),s.push.apply(s,u),me(n[1],r)&&s.push({index1:e,index2:-1,pos:n[1],type:"inside"})})),o.forEach((function(t,e){var r,i;me(t[1],n)&&(r=!1,-1===(i=L(s,(function(t){if(t.index2!==e)return!!r;r=!0})))&&(r=!1,i=L(s,(function(t){var n=t.index1;if(t=t.index2,-1!==n||t+1!==e)return!!r;r=!0}))),-1===i?s.push({index1:-1,index2:e,pos:t[1],type:"inside"}):s.splice(i,0,{index1:-1,index2:e,pos:t[1],type:"inside"}))})),u={},s.filter((function(t){return t=(t=t.pos)[0]+"x"+t[1],!u[t]&&(u[t]=!0)})).map((function(t){return t.pos}))}(n=ge([n,r,o,i],a),[[t,s],[t+u,s],[t+u,s+e],[t,s+e]])),o=he(n);return r&&o?Math.min(100,r/o*100):0},n.isInside=function(t,e){var n=(s=this.state).target,r=s.pos1,i=s.pos2,o=s.pos3,a=s.pos4,s=s.targetClientRect;return!!n&&me([t,e],ge([r,i,a,o],s))},n.updateRect=function(t,e,n){void 0===n&&(n=!0);var r=(a=this.props).parentMoveable,i=this.state.target||this.props.target,o=this.getContainer(),a=(r?r.props:a).rootContainer;this.updateState(Uo(this.controlBox&&this.controlBox.getElement(),i,o,o,a||o),!r&&n)},n.isDragging=function(){return!!this.targetGesto&&this.targetGesto.isFlag()||!!this.controlGesto&&this.controlGesto.isFlag()},n.updateTarget=function(t){this.updateRect(t,!0)},n.getRect=function(){var t=this.state,e=(o=Er(this.state))[0],n=o[1],r=o[2],i=o[3],o=or(o),a=t.width,s=t.height,u=o.width,l=o.height,c=o.left,f=(o=o.top,[t.left,t.top]),d=Yt(f,t.origin);return{width:u,height:l,left:c,top:o,pos1:e,pos2:n,pos3:r,pos4:i,offsetWidth:a,offsetHeight:s,beforeOrigin:Yt(f,t.beforeOrigin),origin:d,transformOrigin:t.transformOrigin,rotation:this.getRotation()}},n.getManager=function(){return this},n.getRotation=function(){var t=(n=this.state).pos1,e=n.pos2,n=n.direction;return t=V(t,e)/Math.PI*180,0<=(t=0<=n?t:180-t)?t:360+t},n.request=function(t,e,n){void 0===e&&(e={});var r=(i=this.props).ables,i=i.groupable;r=r.filter((function(e){return e.name===t}))[0];if(this.isDragging()||!r||!r.request)return{request:function(){return this},requestEnd:function(){return this}};var o=this,a=r.request(this),s=n||e.isInstant,u=a.isControl?"controlAbles":"targetAbles",l="".concat(i?"Group":"").concat(a.isControl?"Control":"");r={request:function(e){return No(o,u,"drag",l,"",He(He({},a.request(e)),{requestAble:t,isRequest:!0}),s),this},requestEnd:function(){return No(o,u,"drag",l,"End",He(He({},a.requestEnd()),{requestAble:t,isRequest:!0}),s),this}};return No(o,u,"drag",l,"Start",He(He({},a.requestStart(e)),{requestAble:t,isRequest:!0}),s),s?r.request(e).requestEnd():r},n.destroy=function(){this.componentWillUnmount()},n.updateRenderPoses=function(){var t=this.state,e=this.props,n=t.originalBeforeOrigin,r=t.transformOrigin,i=t.allMatrix,o=t.is3d,a=t.pos1,s=t.pos2,u=t.pos3,l=t.pos4,c=t.left,f=t.top,d=void 0===(d=(g=e.padding||{}).left)?0:d,p=void 0===(p=g.top)?0:p,h=void 0===(h=g.bottom)?0:h,g=void 0===(g=g.right)?0:g;o=o?4:3,e=e.groupable?n:Yt(n,[c,f]);t.renderPoses=[Yt(a,Pr(i,[-d,-p],r,e,o)),Yt(s,Pr(i,[g,-p],r,e,o)),Yt(u,Pr(i,[-d,h],r,e,o)),Yt(l,Pr(i,[g,h],r,e,o))]},n.checkUpdate=function(){this._isPropTargetChanged=!1;var t=(n=this.props).target,e=n.container,n=n.parentMoveable,r=(i=this.state).target,i=i.container;(r||t)&&(this.updateAbles(),!(r=!Cr(r,t))&&Cr(i,e)||((i=e||this.controlBox)&&this.unsetAbles(),this.updateState({target:t,container:e}),!n&&i&&this.updateRect("End",!1,!1),this._isPropTargetChanged=r))},n.waitToChangeTarget=function(){return new Promise((function(){}))},n.triggerEvent=function(t,e){return this._emitter.trigger(t,e),(t=this.props[t])&&t(e)},n.useCSS=function(t,e){var n=this.props.customStyledMap,r=t+e;return n[r]||(n[r]=je(t,e)),n[r]},n.updateSelectors=function(){},n.unsetAbles=function(){var t=this;this.targetAbles.forEach((function(e){e.unset&&e.unset(t)}))},n.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var n=this.props,r=n.triggerAblesSimultaneously,i=(t=t.filter((function(t){return t&&(t.always&&!1!==n[t.name]||n[t.name])})),"drag".concat(e,"Start")),o="pinch".concat(e,"Start");e="drag".concat(e,"ControlStart"),i=Or(t,[i,o],r),o=Or(t,[e],r);this.enabledAbles=t,this.targetAbles=i,this.controlAbles=o},n.updateState=function(t,e){if(e)this.isUnmounted||this.setState(t);else{var n,r=this.state;for(n in t)r[n]=t[n]}},n.getEnabledAbles=function(){var t=this.props;return t.ables.filter((function(e){return e&&t[e.name]}))},n.renderAbles=function(){var t,e,n,r,i=this,o=this.props.triggerAblesSimultaneously,a={createElement:ut};return this.renderState={},t=Mr(Or(this.getEnabledAbles(),["render"],o).map((function(t){return(0,t.render)(i,a)||[]}))).filter((function(t){return t})),e=function(t){return t.key},n=[],r={},t.forEach((function(t,i){i=e(t);var o=r[i];o||(r[i]=o=[],n.push(o)),o.push(t)})),n.map((function(t){return t[0]}))},n.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},n._updateObserver=function(t){var e=this.props,n=e.target;window.ResizeObserver&&n&&e.useResizeObserver?t.target===n&&this._observer||((e=new ResizeObserver(this.checkUpdateRect)).observe(n,{box:"border-box"}),this._observer=e):null!=(t=this._observer)&&t.disconnect()},n._updateEvents=function(){var t=this.controlBox.getElement(),e=this.targetAbles.length,n=this.controlAbles.length,r=(r=this.props).dragTarget||r.target;(!e&&this.targetGesto||this._isTargetChanged(!0))&&(_r(this,"targetGesto"),this.updateState({gesto:null})),n||_r(this,"controlGesto"),r&&e&&!this.targetGesto&&(this.targetGesto=Go(this,r,"")),!this.controlGesto&&n&&(this.controlGesto=ko(this,t,"controlAbles","Control"))},n._updateTargets=function(){var t=this.props;this._prevTarget=t.dragTarget||t.target,this._prevDragArea=t.dragArea},n._renderLines=function(){var t=(r=this.props).zoom,e=r.hideDefaultLines,n=r.hideChildMoveableDefaultLines,r=r.parentMoveable;if(e||r&&n)return[];var i=this.state.renderPoses,o={createElement:ut};return[[0,1],[1,3],[3,2],[2,0]].map((function(e,n){var r=e[0];e=e[1];return zi(o,"",i[r],i[e],t,"render-line-".concat(n))}))},n._isTargetChanged=function(t){var e,n=(e=this.props).dragTarget||e.target,r=this._prevTarget,i=this._prevDragArea;return!(e=e.dragArea)&&r!==n||(t||e)&&i!==e},n._updateNativeEvents=function(){var t,e=this,n=this.props.dragArea?this.areaElement:this.state.target,r=this.events,i=B(r);if(this._isTargetChanged())for(var o in r){var a=r[o];a&&a.destroy(),r[o]=null}n&&(t=this.enabledAbles,i.forEach((function(i){var o=Or(t,[i]),a=0<o.length,s=r[i];a?(s||(s=new Bo(n,e,i),r[i]=s),s.setAbles(o)):s&&(s.destroy(),r[i]=null)})))},e.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,parentPosition:null,portalContainer:null,useResizeObserver:!1,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Xn},e}(Et),Vo={name:"groupable",props:{defaultGroupRotate:Number,defaultGroupOrigin:String,groupable:Boolean,targetGroups:Object,hideChildMoveableDefaultLines:Boolean},events:{},render:function(t,e){var n=t.props.targets||[],r=[(s=(t.moveables=[],t.state)).left,s.top],o=t.props,a=o.zoom||1,s=t.renderGroupRects;return $e($e([],n.map((function(n,s){return e.createElement(qo,{key:"moveable"+s,ref:i(t,"moveables",s),target:n,origin:!1,cssStyled:o.cssStyled,customStyledMap:o.customStyledMap,useResizeObserver:o.useResizeObserver,hideChildMoveableDefaultLines:o.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:r,zoom:a})})),!0),Mr(s.map((function(t,n){var i=[t.pos1,t.pos2,t.pos3,t.pos4];return[[0,1],[1,3],[3,2],[2,0]].map((function(t,o){var s=t[0];t=t[1];return zi(e,"",jt(i[s],r),jt(i[t],r),a,"group-rect-".concat(n,"-").concat(o))}))}))),!0)}},Yo=Ze("clickable",{props:{clickable:Boolean},events:{onClick:"click",onClickGroup:"clickGroup"},always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,o=!t.isMoveableElement(i)&&t.controlBox.getElement().contains(i);!r||!i||e.isDrag||t.isMoveableElement(i)||o||(r=n.contains(i),Rr(t,"onClick",Tr(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:r})))},dragGroupEnd:function(t,e){var n,r,i,o=e.inputEvent,a=e.inputTarget;o&&a&&!e.isDrag&&!t.isMoveableElement(a)&&e.datas.inputTarget!==a&&(r=-1<(n=(o=t.props.targets).indexOf(a)),i=!1,-1===n&&(i=-1<(n=L(o,(function(t){return t.contains(a)})))),Rr(t,"onClickGroup",Tr(t,e,{isDouble:e.isDouble,targets:o,inputTarget:a,targetIndex:n,isTarget:r,containsTarget:i,moveableTarget:o[n]})))},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function jo(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),He(He({},t),{datas:e})}var Wo=Ze("edgeDraggable",{css:[".edge.edgeDraggable.line {\n    cursor: move;\n}"],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?Fi(e,"edgeDraggable",r,t.state.renderPoses,n.zoom):[]},dragControlCondition:function(t,e){return!(!t.props.edgeDraggable||!e.inputEvent)&&(H(t=e.inputEvent.target,Wn("direction"))&&H(t,Wn("edge"))&&H(t,Wn("edgeDraggable")))},dragControlStart:function(t,e){return t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Vi.dragStart(t,jo(e))},dragControl:function(t,e){return Vi.drag(t,jo(e))},dragControlEnd:function(t,e){return Vi.dragEnd(t,jo(e))},dragGroupControlCondition:function(t,e){return!(!t.props.edgeDraggable||!e.inputEvent)&&(H(t=e.inputEvent.target,Wn("direction"))&&H(t,Wn("line")))},dragGroupControlStart:function(t,e){return Vi.dragGroupStart(t,jo(e))},dragGroupControl:function(t,e){return Vi.dragGroup(t,jo(e))},dragGroupControlEnd:function(t,e){return Vi.dragGroupEnd(t,jo(e))},unset:function(t){return Vi.unset(t)}}),Xo={name:"individualGroupable",props:{individualGroupable:Boolean},events:{}},Ho=[Po,so,xt,Pt,Vi,Wo,Yi,d,Zi,At,Nt,uo,Qi,Mo,Co,Ao,Vo,Xo,Yo,oo,Lo];xt=Ho.reduce((function(t,e){return He(He({},t),"events"in e?e.events:{})}),{}),Pt=Ho.reduce((function(t,e){return He(He({},t),e.props)}),{}),Wo=Object.keys(function(t){var e,n={};for(e in t)n[t[e]]=e;return n}(xt)),d=Object.keys(Pt);function $o(t,e){var n=t[0],r=t[1];t=t[2];return(n*e[0]+r*e[1]+t)/Math.sqrt(n*n+r*r)}function Zo(t,e){var n=t[0];t=t[1];return-n*e[0]-t*e[1]}function Qo(t,e){return Math.max.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2];t=t[3];return Math.max(n[e],r[e],i[e],t[e])})))}function Ko(t,e){return Math.min.apply(Math,t.map((function(t){var n=t[0],r=t[1],i=t[2];t=t[3];return Math.min(n[e],r[e],i[e],t[e])})))}var Jo,ta=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.differ=new de,e.moveables=[],e.transformOrigin="50% 50%",e.renderGroupRects=[],e}Xe(e,t);var n=e.prototype;return n.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},n.updateRect=function(t,e,n){var r,i,o,a,s,u,l,c,f,d,p,h,g,v,m;void 0===n&&(n=!0),this.controlBox&&(this.moveables.forEach((function(e){e.updateRect(t,!1,!1)})),r=this.state,i=this.props,c=this.moveables,o=r.target||i.target,(u=function t(e,n){return n=n.map((function(n){var r,i;return y(n)?1<(i=(r=t(e,n)).length)?r:1===i?r[0]:null:(i=N(e,(function(t){return t.manager.props.target===n})))?(i.finded=!0,i.manager):null})).filter(Boolean),1===n.length&&y(n[0])?n[0]:n}(c=c.map((function(t){return{finded:!1,manager:t}})),this.props.targetGroups||[])).push.apply(u,c.filter((function(t){return!t.finded})).map((function(t){return t.manager}))),a=[],s=!e||""!==t&&i.updateGroup,c=function t(e,n,r){e=e.map((function(e){var r,i;return y(e)?(i=[(r=t(e,n)).pos1,r.pos2,r.pos3,r.pos4],a.push(r),{poses:i,rotation:r.rotation}):{poses:Er(e.state),rotation:e.getRotation()}}));var o=0,u=(l=e.map((function(t){return t.rotation})))[0],l=l.every((function(t){return Math.abs(u-t)<.1})),c=(o=s?l?u:i.defaultGroupRotate||0:!r&&l?u:n,r=e.map((function(t){return t.poses})),l=o,e=[0,0],o=[0,0],[0,0]),f=[0,0],d=0,p=0;if(!r.length)return{pos1:e,pos2:o,pos3:c,pos4:f,minX:0,minY:0,width:d,height:p,rotation:l};var h,g,v,m,E,_,b,T,I,S,R,w=W(l,dn);w%90?(I=w/180*Math.PI,h=Math.tan(I),g=-1/h,v=[pn,hn],m=[[0,0],[0,0]],E=[pn,hn],_=[[0,0],[0,0]],r.forEach((function(t){t.forEach((function(t){var e=$o([-h,1,0],t),n=$o([-g,1,0],t);v[0]>e&&(m[0]=t,v[0]=e),v[1]<e&&(m[1]=t,v[1]=e),E[0]>n&&(_[0]=t,E[0]=n),E[1]<n&&(_[1]=t,E[1]=n)}))})),I=m[0],T=m[1],b=_[0],S=_[1],I=[-h,1,Zo([-h,1],I)],T=[-h,1,Zo([-h,1],T)],e=(S=[[I,b=[-g,1,Zo([-g,1],b)]],[I,I=[-g,1,Zo([-g,1],S)]],[T,b],[T,I]].map((function(t){return _e(t[0],t[1])[0]})))[0],o=S[1],c=S[2],f=S[3],d=E[1]-E[0],p=v[1]-v[0]):(e=[b=Ko(r,0),T=Ko(r,1)],o=[I=Qo(r,0),T],c=[b,S=Qo(r,1)],f=[I,S],d=I-b,p=S-T,w%180&&(e=(R=[c,e,f,o])[0],o=R[1],c=R[2],f=R[3],d=S-T,p=I-b)),180<w%360&&(e=(R=[f,c,o,e])[0],o=R[1],c=R[2],f=R[3]),r=ve([e,o,c,f]);return{pos1:e,pos2:o,pos3:c,pos4:f,width:d,height:p,minX:r.minX,minY:r.minY,rotation:l}}(u,this.rotation,!0),s&&(this.rotation=c.rotation,this.transformOrigin=i.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this.renderGroupRects=a,e=this.rotation,u=this.scale,d=c.width,f=c.height,l=c.minX,c=c.minY,e="rotate(".concat(e,"deg) scale(").concat(0<=u[0]?1:-1,", ").concat(0<=u[1]?1:-1,")"),o.style.cssText+="left:0px;top:0px; transform-origin: ".concat(this.transformOrigin,"; width:").concat(d,"px; height:").concat(f,"px;")+"transform:".concat(e),r.width=d,r.height=f,d=this.getContainer(),d=[(f=Uo(this.controlBox.getElement(),o,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||d)).left,f.top],g=[(g=ve([v=(h=Er(f))[0],m=h[1],p=h[2],h=h[3]])).minX,g.minY],f.pos1=jt(v,g),f.pos2=jt(m,g),f.pos3=jt(p,g),f.pos4=jt(h,g),f.left=l-f.left+g[0],f.top=c-f.top+g[1],f.origin=jt(Yt(d,f.origin),g),f.beforeOrigin=jt(Yt(d,f.beforeOrigin),g),f.originalBeforeOrigin=Yt(d,f.originalBeforeOrigin),v=f.targetClientRect,m=0<u[0]*u[1]?1:-1,v.top+=f.top-r.top,v.left+=f.left-r.left,o.style.transform="translate(".concat(-g[0],"px, ").concat(-g[1],"px) ").concat(e),this.updateState(He(He({},f),{direction:m,beforeDirection:m}),n))},n.getRect=function(){return He(He({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.triggerEvent=function(e,n,r){if(r||-1<e.indexOf("Group"))return t.prototype.triggerEvent.call(this,e,n);this._emitter.trigger(e,n)},n.updateAbles=function(){t.prototype.updateAbles.call(this,$e($e([],this.props.ables,!0),[Vo],!1),"Group")},n._updateTargets=function(){t.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},n._updateEvents=function(){var t,e=this.state,n=this.props,r=(e=(r=((t=((t=this._prevTarget)!==(r=n.dragTarget||this.areaElement)&&(_r(this,"targetGesto"),_r(this,"controlGesto"),e.target=null),e.target||(e.target=this.areaElement,this.controlBox.getElement().style.display="block"),e.target&&(this.targetGesto||(this.targetGesto=Go(this,r,"Group")),this.controlGesto||(this.controlGesto=ko(this,this.controlBox.getElement(),"controlAbles","GroupControl"))),!Cr(e.container,n.container)))&&(e.container=n.container),this.differ.update(n.targets))).added,n=r.changed,r.removed);e=e.length||r.length;(t||e||n.length)&&this.updateRect(),this._isPropTargetChanged=!!e},n._updateObserver=function(){},e.defaultProps=He(He({},qo.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(qo),ea=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}Xe(e,t);var n=e.prototype;return n.render=function(){var t=this,e=(o=this.props).cspNonce,n=o.cssStyled,o=o.targets;return ut(n,{cspNonce:e,ref:r(this,"controlBox"),className:Wn("control-box")},o.map((function(e,n){return ut(qo,He({key:"moveable"+n,ref:i(t,"moveables",n)},t.props,{target:e,wrapperMoveable:t}))})))},n.componentDidUpdate=function(){},n.updateRect=function(t,e,n){void 0===n&&(n=!0),this.moveables.forEach((function(r){r.updateRect(t,e,n)}))},n.getRect=function(){return He(He({},t.prototype.getRect.call(this)),{children:this.moveables.map((function(t){return t.getRect()}))})},n.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},n.dragStart=function(){return this},n.hitTest=function(){return 0},n.isInside=function(){return!1},n.isDragging=function(){return!1},n.updateRenderPoses=function(){},n.checkUpdate=function(){},n.triggerEvent=function(){},n.updateAbles=function(){},n._updateEvents=function(){},n._updateObserver=function(){},e}(qo),na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Xe(e,t),e.defaultAbles=Ho,e}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e._differ=new de,e._elementTargets=[],e._onChangetarget=null,e}Xe(e,t);var n,i,o=e.prototype;return e.makeStyled=function(){var t={},e=(this.getTotalAbles().forEach((function(e){(e=e.css)&&e.forEach((function(e){t[e]=!0}))})),B(t).join("\n"));this.defaultStyled=je("div",(ln,(cn+e).replace(/([^}{]*){/gm,(function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,".moveable-$1")+"{"}))))},e.getTotalAbles=function(){return $e([so,Vo,Xo,oo],this.defaultAbles,!0)},o.render=function(){var t=this.constructor,e=(i=(t.defaultStyled||t.makeStyled(),this.props)).ables,n=i.props,i=function(t,e){var n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}(i,["ables","props"]),o=this._updateRefs(!0),a=function t(e,n){var r=[];return e.forEach((function(e){e&&(T(e)?n[e]&&r.push.apply(r,n[e]):y(e)?r.push.apply(r,t(e,n)):r.push(e))})),r}(o,this.selectorMap),s=1<a.length;e=$e($e([],t.getTotalAbles(),!0),e||[],!0),n=He(He(He({},i),n||{}),{ables:e,cssStyled:t.defaultStyled,customStyledMap:t.customStyledMap});return this._elementTargets=a,s?i.individualGroupable?ut(ea,He({key:"individual-group",ref:r(this,"moveable")},n,{target:null,targets:a})):(e=function t(e,n){var r=[];return e.forEach((function(e){e&&(T(e)?n[e]&&r.push.apply(r,n[e]):y(e)?r.push(t(e,n)):r.push(e))})),r}(o,this.selectorMap),ut(ta,He({key:"group",ref:r(this,"moveable")},n,{target:null,targets:a,targetGroups:e}))):ut(qo,He({key:"single",ref:r(this,"moveable")},n,{target:a[0]}))},o.componentDidMount=function(){this._updateRefs()},o.componentDidUpdate=function(){var t=(e=this._differ.update(this._elementTargets)).added,e=e.removed;(t.length||e.length)&&this._onChangetarget&&this._onChangetarget(),this._updateRefs()},o.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},o.updateSelectors=function(){this.selectorMap={},this.refTargets=[],this.forceUpdate()},o.waitToChangeTarget=function(){var t,e=this;return this._onChangetarget=function(){e._onChangetarget=null,t()},new Promise((function(e){t=e}))},o.getManager=function(){return this.moveable},o._updateRefs=function(t){var e=this.refTargets,n=Br(this.props.target||this.props.targets),r="undefined"!=typeof document,i=function t(e,n){return e.length!==n.length||e.some((function(e,r){return r=n[r],!(!e&&!r)&&e!=r&&(!y(e)||!y(r)||t(e,r))}))}(e,n),o=this.selectorMap,a={};return this.refTargets.forEach((function t(e){T(e)?o[e]?a[e]=o[e]:r&&(i=!0,a[e]=[].slice.call(document.querySelectorAll(e))):y(e)&&e.forEach(t)})),this.refTargets=n,this.selectorMap=a,!t&&i&&this.forceUpdate(),n},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(a=(o<3?i(a):3<o?i(e,n,a):i(e,n))||a);3<o&&a&&Object.defineProperty(e,n,a)}([(n=bn,void 0===i&&(i={}),function(t,e){n.forEach((function(n){var r=i[n]||n;r in t||(t[r]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=(i=this[e])[n].apply(i,t);return i===this[e]?this:i})}))})],e.prototype,"moveable",void 0),e}(Et)),ra=function(t){function i(e){return(e=t.call(this,e)||this).state={},e.state=e.props,e}return e(i,t),i.prototype.render=function(){return t=ut(na,n({ref:r(this,"moveable")},this.state)),e=this.state.parentElement,ut(_t,{element:t,container:e});var t,e},i}(lt),ia=d,oa=bn,aa=Wo,sa=(Zi=Pt,function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n}(function(t){function i(e,i){void 0===i&&(i={});var o=t.call(this)||this,a=(i=(o.tempElement=document.createElement("div"),n({},i)),{});aa.forEach((function(t){a["on ".concat(t).replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()}))]=function(e){return o.trigger(t,e)}})),Tt(ut(ra,n({ref:r(o,"innerMoveable"),parentElement:e},i,a)),o.tempElement),e=i.target;return y(e)&&1<e.length&&o.updateRect(),o}e(i,t);var a=i.prototype;return a.setState=function(t,e){this.innerMoveable.setState(t,e)},a.forceUpdate=function(t){this.innerMoveable.forceUpdate(t)},a.dragStart=function(t){this.innerMoveable.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(t)},a.destroy=function(){Tt(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},a.getMoveable=function(){return this.innerMoveable.moveable},function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(a=(o<3?i(a):3<o?i(e,n,a):i(e,n))||a);return 3<o&&a&&Object.defineProperty(e,n,a),a}([o(oa,(function(t,e){t[e]||(t[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.getMoveable();if(r&&r[e])return r[e].apply(r,t)})})),o(ia,(function(t,e){Object.defineProperty(t,e,{get:function(){return this.getMoveable().props[e]},set:function(t){var n;this.setState(((n={})[e]=t,n))},enumerable:!0,configurable:!0})}))],i)}(Ie))),ua={__proto__:null,default:sa,PROPERTIES:ia,METHODS:oa,EVENTS:aa,PROPS_MAP:Zi,getElementInfo:function(t,e,n){return Fo(t,t=e,e=void 0===(e=n)?t:e,!0)},makeAble:Ze};for(Jo in ua)sa[Jo]=ua[Jo];return sa})),function(t){var e=27,n=37,r=38,i=39,o=40,a=13;function s(e,n){this.options=n,n.search&&this.getLabelList(),this.CLASS=s.CLASS,this.$el=t(e),this.$el_=this.$el.clone(),this.init()}s.CLASS={wrap:"zd-cascader-wrap",inputwrap:"zd-input zd-input--suffix",input:"zd-input__inner",iconWrap:"zd-input__suffix",iconInnerWrap:"zd-input__suffix-inner",icon:"icon zd-input__icon zd-icon-arrow-down",dropdownWrap:"zd-cascader__dropdown",dropdownPanel:"zd-cascader-panel",menuWrap:"zd-cascader-menu",menuList:"zd-cascader-menu__list",menuNode:"zd-cascader-node",menuNodeLabel:"zd-cascader-node__label",menuNodePostfix:"zd-cascader-node__postfix",checkClass:{wrapFocus:"is-focus",menuNodeSelected:"in-active-path",nodeSelectedIcon:"is-selected-icon",nodeAnchor:"is-prepare"}},s.DEFAULTS={data:null,range:" / ",onChange:function(t){}},s.METHODS=["reload","destroy"],s.prototype.init=function(){this._construct(),this._event()},s.prototype._construct=function(){this.$container=this.$el.wrap(`<div class="${this.CLASS.wrap}"></div>`).wrap(`<div class="${this.CLASS.inputwrap}"></div>`).addClass(this.CLASS.input).prop("readonly",!this.options.search).closest("."+this.CLASS.wrap),this.$arrow=t('<span class="zd-input__suffix">\n                                    <span class="zd-input__suffix-inner">\n                                        <svg t="1600158452164" class="icon zd-input__icon zd-icon-arrow-down" viewBox="0 0 1024 1024"\n                                            version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1181" width="200" height="200">\n                                            <path\n                                                d="M538.434046 617.504916c0 3.687996-1.403976 7.356548-4.211928 10.1645-5.615904 5.615904-14.713097 5.615904-20.329001 0L364.187513 476.931297c-5.615904-5.615904-5.615904-14.713097 0-20.329001 5.615904-5.615904 14.713097-5.615904 20.329001 0l149.705604 150.739143C537.03007 610.148367 538.434046 613.817943 538.434046 617.504916z"\n                                                p-id="1182" fill="#515151"></path>\n                                            <path\n                                                d="M689.172165 466.767819c0 3.687996-1.403976 7.356548-4.211928 10.1645L534.222117 627.670439c-5.615904 5.615904-14.713097 5.615904-20.329001 0-5.615904-5.615904-5.615904-14.713097 0-20.329001L664.631236 456.603319c5.615904-5.615904 14.713097-5.615904 20.329001 0C687.768189 459.411271 689.172165 463.079824 689.172165 466.767819z"\n                                                p-id="1183" fill="#515151"></path>\n                                        </svg>\n                                    </span>\n                                </span>').insertAfter(this.$el),this.$dropdownWrap=t(`<div class="${this.CLASS.dropdownPanel}"></div>`).appendTo(this.$container).wrap(`<div class="${this.CLASS.dropdownWrap}"></div>`),this.reload()},s.prototype._event=function(){this.$container.on("click.wrap",t.proxy(this._wrapClick,this)),this.$container.on("mousedown",t.proxy((function(t){this.$el.focus(),t.stopPropagation()}),this)),t(document).on("mousedown.cascader",t.proxy((function(){this.$container.removeClass(this.CLASS.checkClass.wrapFocus)}),this)),this.$container.on("blur.wrap",t.proxy((function(){this.$container.removeClass(this.CLASS.checkClass.wrapFocus)}),this)),this.$container.on("click.item","."+this.CLASS.menuNode,t.proxy(this._nodeClick,this)),this.$el.on("keyup.wrap",t.proxy(this._keyup,this)),this.$el.on("input",t.proxy((function(t){this.search(this.$el.val())}),this))},s.prototype._wrapClick=function(){event.stopPropagation(),this.$el.focus(),this.$container.hasClass(this.CLASS.checkClass.wrapFocus)||this.$container.addClass(this.CLASS.checkClass.wrapFocus),this.$dropdownWrap.find("li."+this.CLASS.checkClass.nodeAnchor).removeClass(this.CLASS.checkClass.nodeAnchor),this.$dropdownWrap.find(this.CLASS.menuList).eq(0).find("li."+this.CLASS.checkClass.menuNodeSelected).addClass(this.CLASS.checkClass.nodeAnchor)},s.prototype._nodeClick=function(e){var n=e.currentTarget?t(e.currentTarget):t(e),r=n.closest("."+this.CLASS.menuWrap);n.addClass(this.CLASS.checkClass.menuNodeSelected).siblings().removeClass(this.CLASS.checkClass.menuNodeSelected);var i=n.data("bindData");if(i.children)this._loadChildren(n);else{r.nextAll().remove();var o=r.prevAll(),a=i.label,s=[i];t.each(o,((e,n)=>{var r=t(n).find("li."+this.CLASS.checkClass.menuNodeSelected).data("bindData");a=r.label+this.options.range+a,s.push(r)})),this.$el.val(a).focus(),this.$container.removeClass(this.CLASS.checkClass.wrapFocus),this.$dropdownWrap.find("."+this.CLASS.checkClass.nodeSelectedIcon).remove(),this.$el.data("bindData",i),this.$el.data("bindPathData",s),this.options.onChange&&"function"==typeof this.options.onChange&&this.options.onChange(this,i,s),e.stopPropagation()}},s.prototype._loadChildren=function(e){this.$el.focus(),e.addClass(this.CLASS.checkClass.menuNodeSelected).siblings().removeClass(this.CLASS.checkClass.menuNodeSelected);var n=e.closest("."+this.CLASS.menuWrap),r=e.data("bindData");if(this.$dropdownWrap.find("li."+this.CLASS.checkClass.nodeAnchor).removeClass(this.CLASS.checkClass.nodeAnchor),e.addClass(this.CLASS.checkClass.nodeAnchor),r.children){var i=[],o=this.$el.data("bindPathData");o&&o.length>0&&(i=t.map(o,(t=>t.value)));var a=n.next();a&&0!==a.length||(a=(a=t(`<div class="zd-scrollbar ${this.CLASS.menuWrap}">\n                                        <div class="zd-cascader-menu__wrap zd-scrollbar__wrap" id="scrollbar">\n                                            <ul class="${this.CLASS.menuList}">\n                                            </ul>\n                                        </div>\n                                    </div>`)).appendTo(this.$dropdownWrap)),a.nextAll().remove();var s=a.find("."+this.CLASS.menuList).empty();t.each(r.children,((e,n)=>{var r=t(`<li class="${this.CLASS.menuNode} ${n.active&&"in-active-path"}"></li>`),o=t(`<span class="${this.CLASS.menuNodeLabel}">${n.label}</span>`),a=t(`<svg t="1600158452164"\n                                        class="icon zd-input__icon zd-icon-arrow-right ${this.CLASS.menuNodePostfix}"\n                                        viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1181"\n                                        width="200" height="200">\n                                        <path\n                                            d="M538.434046 617.504916c0 3.687996-1.403976 7.356548-4.211928 10.1645-5.615904 5.615904-14.713097 5.615904-20.329001 0L364.187513 476.931297c-5.615904-5.615904-5.615904-14.713097 0-20.329001 5.615904-5.615904 14.713097-5.615904 20.329001 0l149.705604 150.739143C537.03007 610.148367 538.434046 613.817943 538.434046 617.504916z"\n                                            p-id="1182" fill="#515151"></path>\n                                        <path\n                                            d="M689.172165 466.767819c0 3.687996-1.403976 7.356548-4.211928 10.1645L534.222117 627.670439c-5.615904 5.615904-14.713097 5.615904-20.329001 0-5.615904-5.615904-5.615904-14.713097 0-20.329001L664.631236 456.603319c5.615904-5.615904 14.713097-5.615904 20.329001 0C687.768189 459.411271 689.172165 463.079824 689.172165 466.767819z"\n                                            p-id="1183" fill="#515151"></path>\n                                    </svg>`);r.append(o).data("bindData",n),n.children&&n.children.length>0?r.append(a):i.indexOf(n.value)>=0&&(this.$dropdownWrap.find("."+this.CLASS.checkClass.nodeSelectedIcon).remove(),r.addClass(this.CLASS.checkClass.menuNodeSelected).prepend(t(`<span class="${this.CLASS.checkClass.nodeSelectedIcon}"></span>`))),r.appendTo(s)})),new PerfectScrollbar("#scrollbar",{wheelSpeed:1,wheelPropagation:!1})}else n.nextAll().remove()},s.prototype.destroy=function(){t(this.$el).insertAfter(this.$el_),this.$el.remove()},s.prototype.getLabelList=function(){var t=[];this.options.data.forEach((function(e){e.children?e.children.forEach((function(n){n.children?n.children.forEach((function(r){t.push({label:`${e.label} / ${n.label} / ${r.label}`,labels:[e.label,n.label,r.label],value:[e.value,n.value,r.value]})})):t.push({label:`${e.label} / ${n.label}`,labels:[e.label,n.label],value:[e.value,n.value]})})):t.push({label:e.label,labels:[e.label],value:e.value})})),this.labelList=t},s.prototype.search=function(t){if(t&&(t=t.trim()),!t)return this.options.keyword=t,void this.reload(null,!0);var e=t.replace(" ","").replace("/","").split(""),n=this.labelList.filter((function(n){return n.num=0,e.forEach((function(t){n.label.includes(t)&&n.num++})),n.label.includes(t)&&(n.num+=2),n.num>(1==e.length?0:1)})).sort((function(t,e){return e.num-t.num})).slice(0,10);this.reload(n,!0)},s.prototype.searchData=function(t){var e=[];this.options.data.forEach((function(n){if(n.label.indexOf(t)>=0)e.push(n);else if(n.children){var r=[];n.children.forEach((function(e){if(e.label.indexOf(t)>=0)r.push(e);else if(e.children){var n=[];e.children.forEach((function(e){e.label.indexOf(t)>=0&&n.push(e)})),n.length>0&&r.push({value:e.value,label:e.label,children:n})}})),r.length>0&&e.push({label:n.label,value:n.value,children:r})}}))},s.prototype.reload=function(e,n){e=e||this.options.data,this.$el.removeData("bindData").removeData("bindPathData"),n||this.$el.val(""),this.$dropdownWrap.empty();var r=this.$el.data("bindData"),i=t(`<div class="zd-scrollbar ${this.CLASS.menuWrap}">\n                                            <div class="zd-cascader-menu__wrap zd-scrollbar__wrap">\n                                                <ul class="${this.CLASS.menuList}">\n                                                </ul>\n                                            </div>\n                                        </div>`),o=i.find("."+this.CLASS.menuList);t.each(e,((e,n)=>{var i=t(`<li class="${this.CLASS.menuNode} ${n.active&&"in-active-path"}"></li>`),a=t(`<span class="${this.CLASS.menuNodeLabel}">${n.label}</span>`),s=t(`<svg t="1600158452164"\n                                        class="icon zd-input__icon zd-icon-arrow-right ${this.CLASS.menuNodePostfix}"\n                                        viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1181"\n                                        width="200" height="200">\n                                        <path\n                                            d="M538.434046 617.504916c0 3.687996-1.403976 7.356548-4.211928 10.1645-5.615904 5.615904-14.713097 5.615904-20.329001 0L364.187513 476.931297c-5.615904-5.615904-5.615904-14.713097 0-20.329001 5.615904-5.615904 14.713097-5.615904 20.329001 0l149.705604 150.739143C537.03007 610.148367 538.434046 613.817943 538.434046 617.504916z"\n                                            p-id="1182" fill="#515151"></path>\n                                        <path\n                                            d="M689.172165 466.767819c0 3.687996-1.403976 7.356548-4.211928 10.1645L534.222117 627.670439c-5.615904 5.615904-14.713097 5.615904-20.329001 0-5.615904-5.615904-5.615904-14.713097 0-20.329001L664.631236 456.603319c5.615904-5.615904 14.713097-5.615904 20.329001 0C687.768189 459.411271 689.172165 463.079824 689.172165 466.767819z"\n                                            p-id="1183" fill="#515151"></path>\n                                    </svg>`);i.append(a).data("bindData",n),n.children&&n.children.length>0?i.append(s):r&&n.value==r.value&&(this.$dropdownWrap.find("."+this.CLASS.checkClass.nodeSelectedIcon).remove(),i.prepend(t(`<span class="${this.CLASS.checkClass.nodeSelectedIcon}"></span>`))),o.append(i)})),this.$dropdownWrap.find("li."+this.CLASS.checkClass.nodeAnchor).removeClass(this.CLASS.checkClass.nodeAnchor),this.$dropdownWrap.append(i).find(this.CLASS.menuNode).eq(0).focus().addClass(this.CLASS.checkClass.nodeAnchor)},s.prototype._keyup=function(t){switch(t.which){case o:this._movedown();break;case r:this._moveup();break;case n:this._moveleft();break;case i:this._moveright();break;case a:this._keyenter();break;case e:this._keyesc()}},s.prototype._movedown=function(){var t;this.$container.hasClass(this.CLASS.checkClass.wrapFocus)?(0===(t=this.$dropdownWrap.find("."+this.CLASS.menuNode+"."+this.CLASS.checkClass.nodeAnchor)).length?t=this.$dropdownWrap.find("."+this.CLASS.menuWrap).eq(0).find("."+this.CLASS.menuNode).eq(0).addClass(this.CLASS.checkClass.nodeAnchor):t.next().length>0&&(t=t.removeClass(this.CLASS.checkClass.nodeAnchor).next().addClass(this.CLASS.checkClass.nodeAnchor)),this._loadChildren(t)):this.$container.trigger("click")},s.prototype._moveup=function(){if(this.$container.hasClass(this.CLASS.checkClass.wrapFocus)){var t=this.$dropdownWrap.find("."+this.CLASS.menuNode+"."+this.CLASS.checkClass.nodeAnchor);0!==t.length&&(t.prev().length>0&&(t=t.removeClass(this.CLASS.checkClass.nodeAnchor).prev().addClass(this.CLASS.checkClass.nodeAnchor)),this._loadChildren(t))}},s.prototype._moveleft=function(){if(this.$container.hasClass(this.CLASS.checkClass.wrapFocus)){var t=this.$dropdownWrap.find("."+this.CLASS.menuNode+"."+this.CLASS.checkClass.nodeAnchor);if(0!==t.length){var e=t.closest("."+this.CLASS.menuWrap).prev();0!==e.length&&(t.removeClass(this.CLASS.checkClass.nodeAnchor),(t=e.find("li."+this.CLASS.checkClass.menuNodeSelected).length>0?e.find("li."+this.CLASS.checkClass.menuNodeSelected).eq(0):e.find("li"+this.CLASS.menuNode).eq(0)).addClass(this.CLASS.checkClass.nodeAnchor),this._loadChildren(t))}}},s.prototype._moveright=function(){if(this.$container.hasClass(this.CLASS.checkClass.wrapFocus)){var t=this.$dropdownWrap.find("."+this.CLASS.menuNode+"."+this.CLASS.checkClass.nodeAnchor);if(0!==t.length){var e=t.closest("."+this.CLASS.menuWrap).next();0!==e.length&&(t.removeClass(this.CLASS.checkClass.nodeAnchor),t=e.find("li."+this.CLASS.menuNode).eq(0).addClass(this.CLASS.checkClass.nodeAnchor),this._loadChildren(t))}}},s.prototype._keyenter=function(){if(this.$container.hasClass(this.CLASS.checkClass.wrapFocus)){var t=this.$dropdownWrap.find("."+this.CLASS.menuNode+"."+this.CLASS.checkClass.nodeAnchor);if(0!==t.length)0===t.closest("."+this.CLASS.menuWrap).next().length&&t.trigger("click")}},s.prototype._keyesc=function(){this.$container.hasClass(this.CLASS.checkClass.wrapFocus)&&(this.$container.removeClass(this.CLASS.checkClass.wrapFocus),this.$el.focus())},t.fn.zdCascader=function(e){var n,r=Array.prototype.slice.call(arguments,1);return this.each((function(){var i=t(this),o=i.data("zdCascader"),a=t.extend({},s.DEFAULTS,i.data(),"object"==typeof e&&e);if("string"==typeof e){if(t.inArray(e,s.METHODS)<0)throw new Error("Unknown method: "+e);if(!o)return;n=o[e].apply(o,r),"destroy"===e&&i.removeData("zdCascader")}o||i.data("zdCascader",o=new s(this,a))})),void 0===n?this:n}}(jQuery);
